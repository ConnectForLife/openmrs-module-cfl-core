INSERT INTO cfl_callflows (name,description,status,raw,uuid,creator,changed_by,date_changed,date_created,date_voided,void_reason,voided,voided_by) VALUES
('IncomingFlow',NULL,'DRAFT','{"nodes":[{"nodeType":"user","templates":{"ccxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<ccxml version=\\"1.0\\" xmlns:voxeo=\\"http://community.voxeo.com/xmlns/ccxml\\">\\n\\n\\t#set($d = \\"$\\")\\n  <var name=\\"callTimeout\\" expr=\\"''60s''\\" />\\n  <var name=\\"state\\" expr=\\"''init''\\"/>\\n\\n  <!-- OUTGOING, INCOMING -->\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"statusURL\\" expr=\\"''${internal.baseURL}/callflows/status/${internal.callId}''\\" />\\n  <var name=\\"connectionId\\" expr=\\"''outboundID''\\" />\\n  <var name=\\"callId\\" expr=\\"''${internal.callId}''\\" />\\n  <var name=\\"jumpTo\\" expr=\\"''${internal.jumpTo}''\\" />\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"callStatus\\" />\\n\\n  <log expr=\\"''startupmode = '' + session.startupmode\\"/>\\n \\n  <eventprocessor>\\n\\n    <!-- CCXML Loaded -->\\n    <transition event=\\"ccxml.loaded\\">\\n      <log expr=\\"''ccxml loaded''\\" />\\n      <if cond=\\"session.startupmode === ''external''\\">\\n        <!-- tel:xxxx, sip:xxx@h:p sip:user@127.0.0.1:5070  -->\\n        <createcall dest=\\"''tel:+'' + ''${phone}''\\" callerid=\\"''${phone}''\\" connectionid=\\"connectionId\\" timeout=\\"callTimeout\\"/>\\n      </if>\\n    </transition>\\n   \\n    <!-- Process the incoming call --> \\n    <transition event=\\"connection.alerting\\">\\n      <log expr=\\"''connection.alerting''\\" />\\n      <accept/>     \\n    </transition>\\n      \\n    <transition event=\\"connection.failed\\">\\n      <var name=\\"eventReason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>      \\n\\n    </transition>\\n\\n    <!-- Call has been answered.--> \\n    <transition event=\\"connection.connected\\">\\n      <log expr=\\"''connection.connected -> ${internal.callId}''\\" />\\n\\t\\t\\t\\t<dialogstart src=\\"''${internal.baseURL}/callflows/in/voxeo/flows/MainFlow.vxml''\\" namelist=\\"session.id application.callerId callId  #if($internal.callDirection == ''OUTGOING'') jumpTo #end\\" />\\n      <var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''connected''\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <var name=\\"externalId\\" expr=\\"session.id\\" />\\n      <var name=\\"externalType\\" expr=\\"''voxeoSessionId''\\" />\\n      <send data=\\"''callMaxTimeReached''\\" target=\\"session.id\\" delay=\\"''600s''\\" />\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason externalId externalType timestamp\\"/>      \\n    </transition>\\n    \\n    <transition event=\\"callMaxTimeReached\\">\\n      <if cond=\\"callStatus == ''IN_PROGRESS''\\">\\n        <log expr=\\"''-- Max Call Time Reached / Disconnecting Call --''\\" />\\n        <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n        <var name=\\"reason\\" expr=\\"''Max time reached''\\" />\\n        <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n        <log expr=\\"''status='' + status + ''; reason = '' + reason\\" />   \\n        <send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>  \\n        <disconnect/>  \\n      </if>\\n\\t\\t</transition>  \\n\\n    <!-- Caller hung up.  -->\\n    <transition event=\\"connection.disconnected\\">\\n      <log expr=\\"''connection.disconnected -> ${internal.callId}''\\" />\\n      <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''COMPLETED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.trigger\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n    </transition>\\n    \\n    <transition event=\\"dialog.started\\">\\n      <log expr=\\"''dialog.started -> ${internal.callId}''\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''dialog start''\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n\\n    </transition>\\n     \\n    <!-- Dialog exit -->\\n    <transition event=\\"dialog.exit\\">\\n      <log expr=\\"''dialog.exit -> ${internal.callId}''\\" />\\n      <disconnect />\\n    </transition>\\n\\n    <!-- ERROR!! -->\\n    <transition event=\\"error.*\\" >\\n      <log expr=\\"''Error[CFL]: ('' + event${d}.reason + '')''\\"/>\\n      <exit/>\\n    </transition>\\n\\n  </eventprocessor>\\n\\n</ccxml>"},"vxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<vxml version=\\"2.1\\">\\n\\n  ## Note: All over-rides below must be over-ridden in your flow, preferably your entry flow\\n\\n  ## Over-ride for a different timeout between user prompts\\n  #if (! $timeout) #set($timeout = 10) #end\\n\\n  ## Mandatorily over-ride this with the current caller''s locale based on how your application stores it\\n\\t#if (! $locale) #set($locale = \\"en\\") #end\\n\\n  ## over-ride this if you want to use a different skip character\\n  #if (! $skipChars) #set($skipChars = \\"*\\") #end\\n  \\n  #set($ext = \\".mp3\\")\\n\\n  ## Mandatorily over-ride this with the new flow name that you want to skip to if the skipChars is pressed\\n  #if ($internal.callDirection == \\"OUTGOING\\" && $skipFlow && $skipFlow != \\"\\")\\n\\t<link event=\\"SkipEvent\\">\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"skipRule\\" mode=\\"dtmf\\">\\n\\t\\t\\t<rule id=\\"skipRule\\" scope=\\"public\\">\\n\\t\\t\\t\\t<item>${skipChars}</item>\\n\\t\\t\\t</rule>\\n\\t\\t</grammar>\\n\\t</link>\\n\\n\\t<catch event=\\"SkipEvent\\">\\n\\t\\t<submit next=\\"${internal.nextURL}?jumpTo=${skipFlow}\\" />\\n\\t</catch>\\n  #end\\n\\n\\n<form>\\n\\t<var name=\\"gNoInputEventCount\\" expr=\\"0\\" />\\n\\t<var name=\\"gNoMatchEventCount\\" expr=\\"0\\" />\\n\\t<block>\\n\\t</block>\\n\\t<field name=\\"finishedHearing\\"><property name=\\"timeout\\" value=\\"0.1s\\" />\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"finishedRule\\" mode=\\"dtmf\\"><rule id=\\"finishedRule\\" scope=\\"public\\"><item>@</item></rule></grammar>\\n\\t\\t<nomatch />\\n\\t\\t<noinput count=\\"1\\"><goto nextitem=\\"submit\\" /></noinput>\\n\\t</field>\\n\\t<block name=\\"submit\\">\\n\\t\\t<goto next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t</block>\\n</form>\\n</vxml>"}},"blocks":[{"name":"Form","type":"form","elements":[{"name":"Txt","type":"txt","txt":""}]}],"step":"entry","continueNode":true},{"nodeType":"system","templates":{"velocity":{"content":"#if ($isPatient == true)\\n\\t|main-menu|\\n#else\\n\\t|no-access|\\n#end\\n","dirty":false}},"step":"entry-handler"},{"nodeType":"user","templates":{"ccxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<ccxml version=\\"1.0\\" xmlns:voxeo=\\"http://community.voxeo.com/xmlns/ccxml\\">\\n\\n\\t#set($d = \\"$\\")\\n  <var name=\\"callTimeout\\" expr=\\"''60s''\\" />\\n  <var name=\\"state\\" expr=\\"''init''\\"/>\\n\\n  <!-- OUTGOING, INCOMING -->\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"statusURL\\" expr=\\"''${internal.baseURL}/callflows/status/${internal.callId}''\\" />\\n  <var name=\\"connectionId\\" expr=\\"''outboundID''\\" />\\n  <var name=\\"callId\\" expr=\\"''${internal.callId}''\\" />\\n  <var name=\\"jumpTo\\" expr=\\"''${internal.jumpTo}''\\" />\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"callStatus\\" />\\n\\n  <log expr=\\"''startupmode = '' + session.startupmode\\"/>\\n \\n  <eventprocessor>\\n\\n    <!-- CCXML Loaded -->\\n    <transition event=\\"ccxml.loaded\\">\\n      <log expr=\\"''ccxml loaded''\\" />\\n      <if cond=\\"session.startupmode === ''external''\\">\\n        <!-- tel:xxxx, sip:xxx@h:p sip:user@127.0.0.1:5070  -->\\n        <createcall dest=\\"''tel:+'' + ''${phone}''\\" callerid=\\"''${phone}''\\" connectionid=\\"connectionId\\" timeout=\\"callTimeout\\"/>\\n      </if>\\n    </transition>\\n   \\n    <!-- Process the incoming call --> \\n    <transition event=\\"connection.alerting\\">\\n      <log expr=\\"''connection.alerting''\\" />\\n      <accept/>     \\n    </transition>\\n      \\n    <transition event=\\"connection.failed\\">\\n      <var name=\\"eventReason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>      \\n\\n    </transition>\\n\\n    <!-- Call has been answered.--> \\n    <transition event=\\"connection.connected\\">\\n      <log expr=\\"''connection.connected -> ${internal.callId}''\\" />\\n\\t\\t\\t\\t<dialogstart src=\\"''${internal.baseURL}/callflows/in/voxeo/flows/MainFlow.vxml''\\" namelist=\\"session.id application.callerId callId  #if($internal.callDirection == ''OUTGOING'') jumpTo #end\\" />\\n      <var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''connected''\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <var name=\\"externalId\\" expr=\\"session.id\\" />\\n      <var name=\\"externalType\\" expr=\\"''voxeoSessionId''\\" />\\n      <send data=\\"''callMaxTimeReached''\\" target=\\"session.id\\" delay=\\"''600s''\\" />\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason externalId externalType timestamp\\"/>      \\n    </transition>\\n    \\n    <transition event=\\"callMaxTimeReached\\">\\n      <if cond=\\"callStatus == ''IN_PROGRESS''\\">\\n        <log expr=\\"''-- Max Call Time Reached / Disconnecting Call --''\\" />\\n        <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n        <var name=\\"reason\\" expr=\\"''Max time reached''\\" />\\n        <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n        <log expr=\\"''status='' + status + ''; reason = '' + reason\\" />   \\n        <send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>  \\n        <disconnect/>  \\n      </if>\\n\\t\\t</transition>  \\n\\n    <!-- Caller hung up.  -->\\n    <transition event=\\"connection.disconnected\\">\\n      <log expr=\\"''connection.disconnected -> ${internal.callId}''\\" />\\n      <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''COMPLETED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.trigger\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n    </transition>\\n    \\n    <transition event=\\"dialog.started\\">\\n      <log expr=\\"''dialog.started -> ${internal.callId}''\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''dialog start''\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n\\n    </transition>\\n     \\n    <!-- Dialog exit -->\\n    <transition event=\\"dialog.exit\\">\\n      <log expr=\\"''dialog.exit -> ${internal.callId}''\\" />\\n      <disconnect />\\n    </transition>\\n\\n    <!-- ERROR!! -->\\n    <transition event=\\"error.*\\" >\\n      <log expr=\\"''Error[CFL]: ('' + event${d}.reason + '')''\\"/>\\n      <exit/>\\n    </transition>\\n\\n  </eventprocessor>\\n\\n</ccxml>"},"vxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<vxml version=\\"2.1\\">\\n\\n  ## Note: All over-rides below must be over-ridden in your flow, preferably your entry flow\\n\\n  ## Over-ride for a different timeout between user prompts\\n  #if (! $timeout) #set($timeout = 10) #end\\n\\n  ## Mandatorily over-ride this with the current caller''s locale based on how your application stores it\\n\\t#if (! $locale) #set($locale = \\"en\\") #end\\n\\n  ## over-ride this if you want to use a different skip character\\n  #if (! $skipChars) #set($skipChars = \\"*\\") #end\\n  \\n  #set($ext = \\".mp3\\")\\n\\n  ## Mandatorily over-ride this with the new flow name that you want to skip to if the skipChars is pressed\\n  #if ($internal.callDirection == \\"OUTGOING\\" && $skipFlow && $skipFlow != \\"\\")\\n\\t<link event=\\"SkipEvent\\">\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"skipRule\\" mode=\\"dtmf\\">\\n\\t\\t\\t<rule id=\\"skipRule\\" scope=\\"public\\">\\n\\t\\t\\t\\t<item>${skipChars}</item>\\n\\t\\t\\t</rule>\\n\\t\\t</grammar>\\n\\t</link>\\n\\n\\t<catch event=\\"SkipEvent\\">\\n\\t\\t<submit next=\\"${internal.nextURL}?jumpTo=${skipFlow}\\" />\\n\\t</catch>\\n  #end\\n\\n\\n<form>\\n\\t<var name=\\"gNoInputEventCount\\" expr=\\"0\\" />\\n\\t<var name=\\"gNoMatchEventCount\\" expr=\\"0\\" />\\n\\t<block>\\n\\t\\t<prompt bargein=\\"true\\" bargeintype=\\"hotword\\">We do not have any record with your phone number.</prompt>\\n\\t</block>\\n</form>\\n</vxml>"}},"blocks":[{"name":"Form","type":"form","elements":[{"name":"Txt","type":"txt","txt":"We do not have any record with your phone number."}]}],"step":"person-not-exist"},{"nodeType":"system","templates":{"velocity":{"content":"","dirty":false}},"step":""},{"nodeType":"user","templates":{"ccxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<ccxml version=\\"1.0\\" xmlns:voxeo=\\"http://community.voxeo.com/xmlns/ccxml\\">\\n\\n\\t#set($d = \\"$\\")\\n  <var name=\\"callTimeout\\" expr=\\"''60s''\\" />\\n  <var name=\\"state\\" expr=\\"''init''\\"/>\\n\\n  <!-- OUTGOING, INCOMING -->\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"statusURL\\" expr=\\"''${internal.baseURL}/callflows/status/${internal.callId}''\\" />\\n  <var name=\\"connectionId\\" expr=\\"''outboundID''\\" />\\n  <var name=\\"callId\\" expr=\\"''${internal.callId}''\\" />\\n  <var name=\\"jumpTo\\" expr=\\"''${internal.jumpTo}''\\" />\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"callStatus\\" />\\n\\n  <log expr=\\"''startupmode = '' + session.startupmode\\"/>\\n \\n  <eventprocessor>\\n\\n    <!-- CCXML Loaded -->\\n    <transition event=\\"ccxml.loaded\\">\\n      <log expr=\\"''ccxml loaded''\\" />\\n      <if cond=\\"session.startupmode === ''external''\\">\\n        <!-- tel:xxxx, sip:xxx@h:p sip:user@127.0.0.1:5070  -->\\n        <createcall dest=\\"''tel:+'' + ''${phone}''\\" callerid=\\"''${phone}''\\" connectionid=\\"connectionId\\" timeout=\\"callTimeout\\"/>\\n      </if>\\n    </transition>\\n   \\n    <!-- Process the incoming call --> \\n    <transition event=\\"connection.alerting\\">\\n      <log expr=\\"''connection.alerting''\\" />\\n      <accept/>     \\n    </transition>\\n      \\n    <transition event=\\"connection.failed\\">\\n      <var name=\\"eventReason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>      \\n\\n    </transition>\\n\\n    <!-- Call has been answered.--> \\n    <transition event=\\"connection.connected\\">\\n      <log expr=\\"''connection.connected -> ${internal.callId}''\\" />\\n\\t\\t\\t\\t<dialogstart src=\\"''${internal.baseURL}/callflows/in/voxeo/flows/MainFlow.vxml''\\" namelist=\\"session.id application.callerId callId  #if($internal.callDirection == ''OUTGOING'') jumpTo #end\\" />\\n      <var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''connected''\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <var name=\\"externalId\\" expr=\\"session.id\\" />\\n      <var name=\\"externalType\\" expr=\\"''voxeoSessionId''\\" />\\n      <send data=\\"''callMaxTimeReached''\\" target=\\"session.id\\" delay=\\"''600s''\\" />\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason externalId externalType timestamp\\"/>      \\n    </transition>\\n    \\n    <transition event=\\"callMaxTimeReached\\">\\n      <if cond=\\"callStatus == ''IN_PROGRESS''\\">\\n        <log expr=\\"''-- Max Call Time Reached / Disconnecting Call --''\\" />\\n        <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n        <var name=\\"reason\\" expr=\\"''Max time reached''\\" />\\n        <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n        <log expr=\\"''status='' + status + ''; reason = '' + reason\\" />   \\n        <send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>  \\n        <disconnect/>  \\n      </if>\\n\\t\\t</transition>  \\n\\n    <!-- Caller hung up.  -->\\n    <transition event=\\"connection.disconnected\\">\\n      <log expr=\\"''connection.disconnected -> ${internal.callId}''\\" />\\n      <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''COMPLETED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.trigger\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n    </transition>\\n    \\n    <transition event=\\"dialog.started\\">\\n      <log expr=\\"''dialog.started -> ${internal.callId}''\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''dialog start''\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n\\n    </transition>\\n     \\n    <!-- Dialog exit -->\\n    <transition event=\\"dialog.exit\\">\\n      <log expr=\\"''dialog.exit -> ${internal.callId}''\\" />\\n      <disconnect />\\n    </transition>\\n\\n    <!-- ERROR!! -->\\n    <transition event=\\"error.*\\" >\\n      <log expr=\\"''Error[CFL]: ('' + event${d}.reason + '')''\\"/>\\n      <exit/>\\n    </transition>\\n\\n  </eventprocessor>\\n\\n</ccxml>"},"vxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<vxml version=\\"2.1\\">\\n\\n  ## Note: All over-rides below must be over-ridden in your flow, preferably your entry flow\\n\\n  ## Over-ride for a different timeout between user prompts\\n  #if (! $timeout) #set($timeout = 10) #end\\n\\n  ## Mandatorily over-ride this with the current caller''s locale based on how your application stores it\\n\\t#if (! $locale) #set($locale = \\"en\\") #end\\n\\n  ## over-ride this if you want to use a different skip character\\n  #if (! $skipChars) #set($skipChars = \\"*\\") #end\\n  \\n  #set($ext = \\".mp3\\")\\n\\n  ## Mandatorily over-ride this with the new flow name that you want to skip to if the skipChars is pressed\\n  #if ($internal.callDirection == \\"OUTGOING\\" && $skipFlow && $skipFlow != \\"\\")\\n\\t<link event=\\"SkipEvent\\">\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"skipRule\\" mode=\\"dtmf\\">\\n\\t\\t\\t<rule id=\\"skipRule\\" scope=\\"public\\">\\n\\t\\t\\t\\t<item>${skipChars}</item>\\n\\t\\t\\t</rule>\\n\\t\\t</grammar>\\n\\t</link>\\n\\n\\t<catch event=\\"SkipEvent\\">\\n\\t\\t<submit next=\\"${internal.nextURL}?jumpTo=${skipFlow}\\" />\\n\\t</catch>\\n  #end\\n\\n\\n<form>\\n\\t<var name=\\"gNoInputEventCount\\" expr=\\"0\\" />\\n\\t<var name=\\"gNoMatchEventCount\\" expr=\\"0\\" />\\n\\t<block>\\n\\t\\t<prompt bargein=\\"true\\" bargeintype=\\"hotword\\">As a caregiver you can''t dial in to Connect for Life.</prompt>\\n\\t</block>\\n</form>\\n</vxml>"}},"blocks":[{"name":"Form","type":"form","elements":[{"name":"Txt","type":"txt","txt":"As a caregiver you can''t dial in to Connect for Life."}]}],"step":"no-access"},{"nodeType":"system","templates":{"velocity":{"content":"","dirty":false}},"step":""},{"nodeType":"user","templates":{"ccxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<ccxml version=\\"1.0\\" xmlns:voxeo=\\"http://community.voxeo.com/xmlns/ccxml\\">\\n\\n\\t#set($d = \\"$\\")\\n  <var name=\\"callTimeout\\" expr=\\"''60s''\\" />\\n  <var name=\\"state\\" expr=\\"''init''\\"/>\\n\\n  <!-- OUTGOING, INCOMING -->\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"statusURL\\" expr=\\"''${internal.baseURL}/callflows/status/${internal.callId}''\\" />\\n  <var name=\\"connectionId\\" expr=\\"''outboundID''\\" />\\n  <var name=\\"callId\\" expr=\\"''${internal.callId}''\\" />\\n  <var name=\\"jumpTo\\" expr=\\"''${internal.jumpTo}''\\" />\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"callStatus\\" />\\n\\n  <log expr=\\"''startupmode = '' + session.startupmode\\"/>\\n \\n  <eventprocessor>\\n\\n    <!-- CCXML Loaded -->\\n    <transition event=\\"ccxml.loaded\\">\\n      <log expr=\\"''ccxml loaded''\\" />\\n      <if cond=\\"session.startupmode === ''external''\\">\\n        <!-- tel:xxxx, sip:xxx@h:p sip:user@127.0.0.1:5070  -->\\n        <createcall dest=\\"''tel:+'' + ''${phone}''\\" callerid=\\"''${phone}''\\" connectionid=\\"connectionId\\" timeout=\\"callTimeout\\"/>\\n      </if>\\n    </transition>\\n   \\n    <!-- Process the incoming call --> \\n    <transition event=\\"connection.alerting\\">\\n      <log expr=\\"''connection.alerting''\\" />\\n      <accept/>     \\n    </transition>\\n      \\n    <transition event=\\"connection.failed\\">\\n      <var name=\\"eventReason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>      \\n\\n    </transition>\\n\\n    <!-- Call has been answered.--> \\n    <transition event=\\"connection.connected\\">\\n      <log expr=\\"''connection.connected -> ${internal.callId}''\\" />\\n\\t\\t\\t\\t<dialogstart src=\\"''${internal.baseURL}/callflows/in/voxeo/flows/MainFlow.vxml''\\" namelist=\\"session.id application.callerId callId  #if($internal.callDirection == ''OUTGOING'') jumpTo #end\\" />\\n      <var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''connected''\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <var name=\\"externalId\\" expr=\\"session.id\\" />\\n      <var name=\\"externalType\\" expr=\\"''voxeoSessionId''\\" />\\n      <send data=\\"''callMaxTimeReached''\\" target=\\"session.id\\" delay=\\"''600s''\\" />\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason externalId externalType timestamp\\"/>      \\n    </transition>\\n    \\n    <transition event=\\"callMaxTimeReached\\">\\n      <if cond=\\"callStatus == ''IN_PROGRESS''\\">\\n        <log expr=\\"''-- Max Call Time Reached / Disconnecting Call --''\\" />\\n        <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n        <var name=\\"reason\\" expr=\\"''Max time reached''\\" />\\n        <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n        <log expr=\\"''status='' + status + ''; reason = '' + reason\\" />   \\n        <send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>  \\n        <disconnect/>  \\n      </if>\\n\\t\\t</transition>  \\n\\n    <!-- Caller hung up.  -->\\n    <transition event=\\"connection.disconnected\\">\\n      <log expr=\\"''connection.disconnected -> ${internal.callId}''\\" />\\n      <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''COMPLETED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.trigger\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n    </transition>\\n    \\n    <transition event=\\"dialog.started\\">\\n      <log expr=\\"''dialog.started -> ${internal.callId}''\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''dialog start''\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n\\n    </transition>\\n     \\n    <!-- Dialog exit -->\\n    <transition event=\\"dialog.exit\\">\\n      <log expr=\\"''dialog.exit -> ${internal.callId}''\\" />\\n      <disconnect />\\n    </transition>\\n\\n    <!-- ERROR!! -->\\n    <transition event=\\"error.*\\" >\\n      <log expr=\\"''Error[CFL]: ('' + event${d}.reason + '')''\\"/>\\n      <exit/>\\n    </transition>\\n\\n  </eventprocessor>\\n\\n</ccxml>"},"vxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<vxml version=\\"2.1\\">\\n\\n  ## Note: All over-rides below must be over-ridden in your flow, preferably your entry flow\\n\\n  ## Over-ride for a different timeout between user prompts\\n  #if (! $timeout) #set($timeout = 10) #end\\n\\n  ## Mandatorily over-ride this with the current caller''s locale based on how your application stores it\\n\\t#if (! $locale) #set($locale = \\"en\\") #end\\n\\n  ## over-ride this if you want to use a different skip character\\n  #if (! $skipChars) #set($skipChars = \\"*\\") #end\\n  \\n  #set($ext = \\".mp3\\")\\n\\n  ## Mandatorily over-ride this with the new flow name that you want to skip to if the skipChars is pressed\\n  #if ($internal.callDirection == \\"OUTGOING\\" && $skipFlow && $skipFlow != \\"\\")\\n\\t<link event=\\"SkipEvent\\">\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"skipRule\\" mode=\\"dtmf\\">\\n\\t\\t\\t<rule id=\\"skipRule\\" scope=\\"public\\">\\n\\t\\t\\t\\t<item>${skipChars}</item>\\n\\t\\t\\t</rule>\\n\\t\\t</grammar>\\n\\t</link>\\n\\n\\t<catch event=\\"SkipEvent\\">\\n\\t\\t<submit next=\\"${internal.nextURL}?jumpTo=${skipFlow}\\" />\\n\\t</catch>\\n  #end\\n\\n\\n<form>\\n\\t<var name=\\"gNoInputEventCount\\" expr=\\"0\\" />\\n\\t<var name=\\"gNoMatchEventCount\\" expr=\\"0\\" />\\n\\t<block>\\n\\t\\t<prompt bargein=\\"true\\" bargeintype=\\"hotword\\">Hello! This is Connect for Life calling. </prompt>\\n\\t</block>\\n\\t<field name=\\"userInput\\" type=\\"digits?length=1\\">\\n\\t\\t<property name=\\"inputmodes\\" value=\\"dtmf\\" />\\n\\t\\t<prompt bargein=\\"true\\" timeout=\\"${timeout}s\\">If you want to listen to your health tip, press 1. If you want to exit, press 5.</prompt>\\n\\t\\t<noinput count=\\"1\\">\\n\\t\\t<var name=\\"gNoInputEventCount\\" expr=\\"gNoInputEventCount+1\\" />\\n\\t\\t<submit namelist=\\"gNoInputEventCount gNoMatchEventCount\\" next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t\\t</noinput>\\n\\t\\t<nomatch count=\\"1\\">\\n\\t\\t<var name=\\"gNoMatchEventCount\\" expr=\\"gNoMatchEventCount+1\\" />\\n\\t\\t<submit namelist=\\"gNoInputEventCount gNoMatchEventCount\\" next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t\\t</nomatch>\\n\\t\\t<noinput><reprompt />\\n\\t\\t</noinput>\\n\\t\\t<nomatch><reprompt />\\n\\t\\t</nomatch>\\n\\t</field>\\n\\t<filled mode=\\"all\\">\\n\\t\\t<submit namelist=\\"userInput\\" next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t</filled>\\n</form>\\n</vxml>"}},"blocks":[{"name":"Form","type":"form","elements":[{"name":"Txt","type":"txt","txt":"Hello! This is Connect for Life calling. "},{"name":"userInput","type":"field","txt":"If you want to listen to your health tip, press 1. If you want to exit, press 5.","fieldType":"digits","noInput":"","noMatch":"","goodBye":"","bargeIn":true,"dtmf":true,"voice":false,"fieldMeta":"1","reprompt":"1","dtmfGrammar":""}]}],"step":"main-menu"},{"nodeType":"system","templates":{"velocity":{"content":"#if($params.userInput)\\n  #if ($params.userInput == 1)\\n    |init-health-tip-param|\\n  #elseif($params.userInput == 5)\\n    |MainFlow.goodbye|\\n  #else\\n      #set($returnNode = \\"IncomingFlow.main-menu\\")\\n      |MainFlow.invalid-input|\\n  #end  \\n#else\\n  |MainFlow.no-input|\\n#end","dirty":false}},"step":"main-menu-handler"},{"nodeType":"user","templates":{"ccxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<ccxml version=\\"1.0\\" xmlns:voxeo=\\"http://community.voxeo.com/xmlns/ccxml\\">\\n\\n\\t#set($d = \\"$\\")\\n  <var name=\\"callTimeout\\" expr=\\"''60s''\\" />\\n  <var name=\\"state\\" expr=\\"''init''\\"/>\\n\\n  <!-- OUTGOING, INCOMING -->\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"statusURL\\" expr=\\"''${internal.baseURL}/callflows/status/${internal.callId}''\\" />\\n  <var name=\\"connectionId\\" expr=\\"''outboundID''\\" />\\n  <var name=\\"callId\\" expr=\\"''${internal.callId}''\\" />\\n  <var name=\\"jumpTo\\" expr=\\"''${internal.jumpTo}''\\" />\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"callStatus\\" />\\n\\n  <log expr=\\"''startupmode = '' + session.startupmode\\"/>\\n \\n  <eventprocessor>\\n\\n    <!-- CCXML Loaded -->\\n    <transition event=\\"ccxml.loaded\\">\\n      <log expr=\\"''ccxml loaded''\\" />\\n      <if cond=\\"session.startupmode === ''external''\\">\\n        <!-- tel:xxxx, sip:xxx@h:p sip:user@127.0.0.1:5070  -->\\n        <createcall dest=\\"''tel:+'' + ''${phone}''\\" callerid=\\"''${phone}''\\" connectionid=\\"connectionId\\" timeout=\\"callTimeout\\"/>\\n      </if>\\n    </transition>\\n   \\n    <!-- Process the incoming call --> \\n    <transition event=\\"connection.alerting\\">\\n      <log expr=\\"''connection.alerting''\\" />\\n      <accept/>     \\n    </transition>\\n      \\n    <transition event=\\"connection.failed\\">\\n      <var name=\\"eventReason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>      \\n\\n    </transition>\\n\\n    <!-- Call has been answered.--> \\n    <transition event=\\"connection.connected\\">\\n      <log expr=\\"''connection.connected -> ${internal.callId}''\\" />\\n\\t\\t\\t\\t<dialogstart src=\\"''${internal.baseURL}/callflows/in/voxeo/flows/MainFlow.vxml''\\" namelist=\\"session.id application.callerId callId  #if($internal.callDirection == ''OUTGOING'') jumpTo #end\\" />\\n      <var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''connected''\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <var name=\\"externalId\\" expr=\\"session.id\\" />\\n      <var name=\\"externalType\\" expr=\\"''voxeoSessionId''\\" />\\n      <send data=\\"''callMaxTimeReached''\\" target=\\"session.id\\" delay=\\"''600s''\\" />\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason externalId externalType timestamp\\"/>      \\n    </transition>\\n    \\n    <transition event=\\"callMaxTimeReached\\">\\n      <if cond=\\"callStatus == ''IN_PROGRESS''\\">\\n        <log expr=\\"''-- Max Call Time Reached / Disconnecting Call --''\\" />\\n        <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n        <var name=\\"reason\\" expr=\\"''Max time reached''\\" />\\n        <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n        <log expr=\\"''status='' + status + ''; reason = '' + reason\\" />   \\n        <send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>  \\n        <disconnect/>  \\n      </if>\\n\\t\\t</transition>  \\n\\n    <!-- Caller hung up.  -->\\n    <transition event=\\"connection.disconnected\\">\\n      <log expr=\\"''connection.disconnected -> ${internal.callId}''\\" />\\n      <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''COMPLETED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.trigger\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n    </transition>\\n    \\n    <transition event=\\"dialog.started\\">\\n      <log expr=\\"''dialog.started -> ${internal.callId}''\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''dialog start''\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n\\n    </transition>\\n     \\n    <!-- Dialog exit -->\\n    <transition event=\\"dialog.exit\\">\\n      <log expr=\\"''dialog.exit -> ${internal.callId}''\\" />\\n      <disconnect />\\n    </transition>\\n\\n    <!-- ERROR!! -->\\n    <transition event=\\"error.*\\" >\\n      <log expr=\\"''Error[CFL]: ('' + event${d}.reason + '')''\\"/>\\n      <exit/>\\n    </transition>\\n\\n  </eventprocessor>\\n\\n</ccxml>"},"vxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<vxml version=\\"2.1\\">\\n\\n  ## Note: All over-rides below must be over-ridden in your flow, preferably your entry flow\\n\\n  ## Over-ride for a different timeout between user prompts\\n  #if (! $timeout) #set($timeout = 10) #end\\n\\n  ## Mandatorily over-ride this with the current caller''s locale based on how your application stores it\\n\\t#if (! $locale) #set($locale = \\"en\\") #end\\n\\n  ## over-ride this if you want to use a different skip character\\n  #if (! $skipChars) #set($skipChars = \\"*\\") #end\\n  \\n  #set($ext = \\".mp3\\")\\n\\n  ## Mandatorily over-ride this with the new flow name that you want to skip to if the skipChars is pressed\\n  #if ($internal.callDirection == \\"OUTGOING\\" && $skipFlow && $skipFlow != \\"\\")\\n\\t<link event=\\"SkipEvent\\">\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"skipRule\\" mode=\\"dtmf\\">\\n\\t\\t\\t<rule id=\\"skipRule\\" scope=\\"public\\">\\n\\t\\t\\t\\t<item>${skipChars}</item>\\n\\t\\t\\t</rule>\\n\\t\\t</grammar>\\n\\t</link>\\n\\n\\t<catch event=\\"SkipEvent\\">\\n\\t\\t<submit next=\\"${internal.nextURL}?jumpTo=${skipFlow}\\" />\\n\\t</catch>\\n  #end\\n\\n\\n<form>\\n\\t<var name=\\"gNoInputEventCount\\" expr=\\"0\\" />\\n\\t<var name=\\"gNoMatchEventCount\\" expr=\\"0\\" />\\n\\t<block>\\n\\t</block>\\n\\t<field name=\\"finishedHearing\\"><property name=\\"timeout\\" value=\\"0.1s\\" />\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"finishedRule\\" mode=\\"dtmf\\"><rule id=\\"finishedRule\\" scope=\\"public\\"><item>@</item></rule></grammar>\\n\\t\\t<nomatch />\\n\\t\\t<noinput count=\\"1\\"><goto nextitem=\\"submit\\" /></noinput>\\n\\t</field>\\n\\t<block name=\\"submit\\">\\n\\t\\t<goto next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t</block>\\n</form>\\n</vxml>"}},"blocks":[{"name":"Form","type":"form","elements":[{"name":"Txt","type":"txt","txt":""}]}],"step":"init-health-tip-param","continueNode":true},{"nodeType":"system","templates":{"velocity":{"content":"## initialize some required class and methods used below\\n#set ($patientClazz = $openmrsContext.loadClass(''org.openmrs.Patient''))\\n#set ($patientTemplateCriteriaClazz = $openmrsContext.loadClass(''org.openmrs.module.messages.domain.criteria.PatientTemplateCriteria''))\\n#set ($ListClazz = $openmrsContext.loadClass(\\"java.util.List\\"))\\n#set ($CollectionsClazz = $openmrsContext.loadClass(\\"java.util.Collections\\"))\\n#set ($collectionsSortMethod = $CollectionsClazz.getMethod(\\"sort\\", $ListClazz))\\n\\n#set ($patientId = $personId) \\n## fetching patient object based on provided Id\\n#if ($patientId)\\n\\t#set ($patient = $patientService.getPatient($patientId))\\n#end\\n## fetching information about patient template if exists\\n#if ($patient)\\n\\t## creating new search criteria based on patient object\\n\\t#set ($patientTemplateCriteria = $patientTemplateCriteriaClazz.getDeclaredConstructor($patientClazz).newInstance($patient))\\n  #set ($patientTemplates = $patientTemplateService.findAllByCriteria($patientTemplateCriteria, null))\\n  #foreach ($item in $patientTemplates)\\n    #if ($item.template.name == \\"Health tip\\")\\n      #set ($patientTemplate = $item)\\n      #break\\n    #end\\n\\t#end\\n#end\\n\\n## fetching list of possible healthtip categories\\n#if ($patientTemplate)\\n\\t#foreach ($item in $patientTemplate.templateFieldValues)\\n  \\t#if ($item.templateField.name == \\"Categories of the message\\")\\n    \\t#set ($healthTipCategories = $item.value)\\n\\t\\t\\t#break\\n    #end\\n  #end\\n  #if ($healthTipCategories)\\n  \\t#set ($healthTipCategories = $healthTipCategories.split('',''))\\n  #end\\n#end\\n::::::::::: Health Tip Categories ::::::::: $healthTipCategories\\n\\n## fetching all Health Tip Categories members\\n#set ($healtTipCategoriesMembers = [])\\n#foreach ($category in $healthTipCategories)\\n\\t#set ($concept = $openmrsContext.getConceptService().getConceptByName($category))\\n  #if ($concept)\\n\\t\\t#set ($dummy = $healtTipCategoriesMembers.addAll($concept.conceptSets))\\n  #end\\n#end\\n\\n## sorting based on ConceptSet comparator\\n#set ($dummy = $collectionsSortMethod.invoke(null, $healtTipCategoriesMembers))\\n\\n## extracting all possible Health Tip concepts\\n#set ($possibleHealthTipConcepts = [])\\n#foreach ($conceptSet in $healtTipCategoriesMembers)\\n\\t#if ($conceptSet.concept)\\n\\t\\t#set($dummy = $possibleHealthTipConcepts.add($conceptSet.concept.conceptId))\\n\\t#end\\n#end\\n:::::: Possible health tip concepts ::::::::::: $possibleHealthTipConcepts\\n\\n#set ($responseCount = 0)\\n#if ($possibleHealthTipConcepts.size() > 0)\\n\\t#set ($responseCount = $possibleHealthTipConcepts.size() - 1)\\n#end\\n#set ($actualResponse = [])\\n#foreach ($actorResponse in $messagesService.getLastActorResponsesForConceptQuestion($patient.patientId, $patient.patientId, 165350, $responseCount))\\n\\t#set($dummy = $actualResponse.add($actorResponse.response.conceptId))\\n#end:::::: already heard health tips ::::::::::: $actualResponse\\n\\n#foreach ($conceptId in $possibleHealthTipConcepts)\\n\\t#if (!$actualResponse.contains($conceptId))\\n\\t\\t#set ($targetConceptId = $conceptId)\\n  \\t#break\\n  #end\\n#end\\n\\n## init Health Tip configuration and call the HealthTipFlow\\n#if ($targetConceptId)\\n  #set($healthTipConf = {})\\n  #set($healthTipConf.params = {})\\n  #set($healthTipConf.params.HEALTH_TIP_ID = $targetConceptId.toString())\\n  #set($messages = [$healthTipConf])\\n  :::::::: $messages\\n  #set($healthTipParam = $messages.get(0).params)\\n  #set($healthTipId = $healthTipParam.HEALTH_TIP_ID.split('','').get(0))\\n#set ($healthTipId = $Integer.parseInt($healthTipId)) \\n  |HealthTipFlow.|\\n#end\\n|MainFlow.exit|\\n","dirty":false}},"step":"init-health-tip-param-handler"}],"name":"IncomingFlow"}','b8ecdcf9-6c11-4dd4-bd0b-3143c4567206',1,1,'2020-06-16 12:57:25','2019-12-10 17:17:20',NULL,NULL,0,NULL)
,('OutgoingFlow',NULL,'DRAFT','{"nodes":[{"nodeType":"user","templates":{"ccxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<ccxml version=\\"1.0\\" xmlns:voxeo=\\"http://community.voxeo.com/xmlns/ccxml\\">\\n\\n\\t#set($d = \\"$\\")\\n  <var name=\\"callTimeout\\" expr=\\"''60s''\\" />\\n  <var name=\\"state\\" expr=\\"''init''\\"/>\\n\\n  <!-- OUTGOING, INCOMING -->\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"statusURL\\" expr=\\"''${internal.baseURL}/callflows/status/${internal.callId}''\\" />\\n  <var name=\\"connectionId\\" expr=\\"''outboundID''\\" />\\n  <var name=\\"callId\\" expr=\\"''${internal.callId}''\\" />\\n  <var name=\\"jumpTo\\" expr=\\"''${internal.jumpTo}''\\" />\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"callStatus\\" />\\n\\n  <log expr=\\"''startupmode = '' + session.startupmode\\"/>\\n \\n  <eventprocessor>\\n\\n    <!-- CCXML Loaded -->\\n    <transition event=\\"ccxml.loaded\\">\\n      <log expr=\\"''ccxml loaded''\\" />\\n      <if cond=\\"session.startupmode === ''external''\\">\\n        <!-- tel:xxxx, sip:xxx@h:p sip:user@127.0.0.1:5070  -->\\n        <createcall dest=\\"''tel:+'' + ''${phone}''\\" callerid=\\"''${phone}''\\" connectionid=\\"connectionId\\" timeout=\\"callTimeout\\"/>\\n      </if>\\n    </transition>\\n   \\n    <!-- Process the incoming call --> \\n    <transition event=\\"connection.alerting\\">\\n      <log expr=\\"''connection.alerting''\\" />\\n      <accept/>     \\n    </transition>\\n      \\n    <transition event=\\"connection.failed\\">\\n      <var name=\\"eventReason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>      \\n\\n    </transition>\\n\\n    <!-- Call has been answered.--> \\n    <transition event=\\"connection.connected\\">\\n      <log expr=\\"''connection.connected -> ${internal.callId}''\\" />\\n\\t\\t\\t\\t<dialogstart src=\\"''${internal.baseURL}/callflows/in/voxeo/flows/MainFlow.vxml''\\" namelist=\\"session.id application.callerId callId  #if($internal.callDirection == ''OUTGOING'') jumpTo #end\\" />\\n      <var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''connected''\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <var name=\\"externalId\\" expr=\\"session.id\\" />\\n      <var name=\\"externalType\\" expr=\\"''voxeoSessionId''\\" />\\n      <send data=\\"''callMaxTimeReached''\\" target=\\"session.id\\" delay=\\"''600s''\\" />\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason externalId externalType timestamp\\"/>      \\n    </transition>\\n    \\n    <transition event=\\"callMaxTimeReached\\">\\n      <if cond=\\"callStatus == ''IN_PROGRESS''\\">\\n        <log expr=\\"''-- Max Call Time Reached / Disconnecting Call --''\\" />\\n        <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n        <var name=\\"reason\\" expr=\\"''Max time reached''\\" />\\n        <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n        <log expr=\\"''status='' + status + ''; reason = '' + reason\\" />   \\n        <send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>  \\n        <disconnect/>  \\n      </if>\\n\\t\\t</transition>  \\n\\n    <!-- Caller hung up.  -->\\n    <transition event=\\"connection.disconnected\\">\\n      <log expr=\\"''connection.disconnected -> ${internal.callId}''\\" />\\n      <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''COMPLETED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.trigger\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n    </transition>\\n    \\n    <transition event=\\"dialog.started\\">\\n      <log expr=\\"''dialog.started -> ${internal.callId}''\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''dialog start''\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n\\n    </transition>\\n     \\n    <!-- Dialog exit -->\\n    <transition event=\\"dialog.exit\\">\\n      <log expr=\\"''dialog.exit -> ${internal.callId}''\\" />\\n      <disconnect />\\n    </transition>\\n\\n    <!-- ERROR!! -->\\n    <transition event=\\"error.*\\" >\\n      <log expr=\\"''Error[CFL]: ('' + event${d}.reason + '')''\\"/>\\n      <exit/>\\n    </transition>\\n\\n  </eventprocessor>\\n\\n</ccxml>"},"vxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<vxml version=\\"2.1\\">\\n\\n  ## Note: All over-rides below must be over-ridden in your flow, preferably your entry flow\\n\\n  ## Over-ride for a different timeout between user prompts\\n  #if (! $timeout) #set($timeout = 10) #end\\n\\n  ## Mandatorily over-ride this with the current caller''s locale based on how your application stores it\\n\\t#if (! $locale) #set($locale = \\"en\\") #end\\n\\n  ## over-ride this if you want to use a different skip character\\n  #if (! $skipChars) #set($skipChars = \\"*\\") #end\\n  \\n  #set($ext = \\".mp3\\")\\n\\n  ## Mandatorily over-ride this with the new flow name that you want to skip to if the skipChars is pressed\\n  #if ($internal.callDirection == \\"OUTGOING\\" && $skipFlow && $skipFlow != \\"\\")\\n\\t<link event=\\"SkipEvent\\">\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"skipRule\\" mode=\\"dtmf\\">\\n\\t\\t\\t<rule id=\\"skipRule\\" scope=\\"public\\">\\n\\t\\t\\t\\t<item>${skipChars}</item>\\n\\t\\t\\t</rule>\\n\\t\\t</grammar>\\n\\t</link>\\n\\n\\t<catch event=\\"SkipEvent\\">\\n\\t\\t<submit next=\\"${internal.nextURL}?jumpTo=${skipFlow}\\" />\\n\\t</catch>\\n  #end\\n\\n\\n<form>\\n\\t<var name=\\"gNoInputEventCount\\" expr=\\"0\\" />\\n\\t<var name=\\"gNoMatchEventCount\\" expr=\\"0\\" />\\n\\t<block>\\n\\t</block>\\n\\t<field name=\\"finishedHearing\\"><property name=\\"timeout\\" value=\\"0.1s\\" />\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"finishedRule\\" mode=\\"dtmf\\"><rule id=\\"finishedRule\\" scope=\\"public\\"><item>@</item></rule></grammar>\\n\\t\\t<nomatch />\\n\\t\\t<noinput count=\\"1\\"><goto nextitem=\\"submit\\" /></noinput>\\n\\t</field>\\n\\t<block name=\\"submit\\">\\n\\t\\t<goto next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t</block>\\n</form>\\n</vxml>"}},"blocks":[{"name":"Form","type":"form","elements":[{"name":"Txt","type":"txt","txt":""}]}],"step":"entry","continueNode":true},{"nodeType":"system","templates":{"velocity":{"content":"messages::::::::: $messages\\n#if($messages.size() > 0)\\n  messages::::::::: $messages.get(0)\\n\\n  #set($message = $messages.get(0))\\n #if($message.name == ''Adherence report daily'')\\n    |AdherenceReportDailyFlow.|\\n  #elseif($message.name == ''Health tip'')\\n    |HealthTipFlow.|\\n  #elseif($message.name == ''Adherence report weekly'')\\n    |AdherenceReportWeeklyFlow.|\\n  #elseif($message.name == ''Visit reminder'')\\n    |VisitReminderFlow.|\\n  #elseif($message.name == ''Adherence feedback'')\\n    |AdherenceFeedbackFlow.|\\n  #elseif($message.name == ''Adherence report daily 2'')\\n    |AdherenceReportDailyFlow.|\\n  #end\\n  after removal messages::::::::: $messages\\n  #*for($message in $messages)\\n    #if($message.name  = ''Adherence report daily'')\\n      #set(adherenceMessageId = '''')\\n    #elseif($message.name = ''Health tip'')\\n    #end\\n  #end *#\\n#else\\n\\t##|play-outbound|\\n  |MainFlow.goodbye|\\n#end","dirty":false}},"step":"entry-handler"},{"nodeType":"user","templates":{"ccxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<ccxml version=\\"1.0\\" xmlns:voxeo=\\"http://community.voxeo.com/xmlns/ccxml\\">\\n\\n\\t#set($d = \\"$\\")\\n  <var name=\\"callTimeout\\" expr=\\"''60s''\\" />\\n  <var name=\\"state\\" expr=\\"''init''\\"/>\\n\\n  <!-- OUTGOING, INCOMING -->\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"statusURL\\" expr=\\"''${internal.baseURL}/callflows/status/${internal.callId}''\\" />\\n  <var name=\\"connectionId\\" expr=\\"''outboundID''\\" />\\n  <var name=\\"callId\\" expr=\\"''${internal.callId}''\\" />\\n  <var name=\\"jumpTo\\" expr=\\"''${internal.jumpTo}''\\" />\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"callStatus\\" />\\n\\n  <log expr=\\"''startupmode = '' + session.startupmode\\"/>\\n \\n  <eventprocessor>\\n\\n    <!-- CCXML Loaded -->\\n    <transition event=\\"ccxml.loaded\\">\\n      <log expr=\\"''ccxml loaded''\\" />\\n      <if cond=\\"session.startupmode === ''external''\\">\\n        <!-- tel:xxxx, sip:xxx@h:p sip:user@127.0.0.1:5070  -->\\n        <createcall dest=\\"''tel:+'' + ''${phone}''\\" callerid=\\"''${phone}''\\" connectionid=\\"connectionId\\" timeout=\\"callTimeout\\"/>\\n      </if>\\n    </transition>\\n   \\n    <!-- Process the incoming call --> \\n    <transition event=\\"connection.alerting\\">\\n      <log expr=\\"''connection.alerting''\\" />\\n      <accept/>     \\n    </transition>\\n      \\n    <transition event=\\"connection.failed\\">\\n      <var name=\\"eventReason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>      \\n\\n    </transition>\\n\\n    <!-- Call has been answered.--> \\n    <transition event=\\"connection.connected\\">\\n      <log expr=\\"''connection.connected -> ${internal.callId}''\\" />\\n\\t\\t\\t\\t<dialogstart src=\\"''${internal.baseURL}/callflows/in/voxeo/flows/MainFlow.vxml''\\" namelist=\\"session.id application.callerId callId  #if($internal.callDirection == ''OUTGOING'') jumpTo #end\\" />\\n      <var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''connected''\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <var name=\\"externalId\\" expr=\\"session.id\\" />\\n      <var name=\\"externalType\\" expr=\\"''voxeoSessionId''\\" />\\n      <send data=\\"''callMaxTimeReached''\\" target=\\"session.id\\" delay=\\"''600s''\\" />\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason externalId externalType timestamp\\"/>      \\n    </transition>\\n    \\n    <transition event=\\"callMaxTimeReached\\">\\n      <if cond=\\"callStatus == ''IN_PROGRESS''\\">\\n        <log expr=\\"''-- Max Call Time Reached / Disconnecting Call --''\\" />\\n        <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n        <var name=\\"reason\\" expr=\\"''Max time reached''\\" />\\n        <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n        <log expr=\\"''status='' + status + ''; reason = '' + reason\\" />   \\n        <send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>  \\n        <disconnect/>  \\n      </if>\\n\\t\\t</transition>  \\n\\n    <!-- Caller hung up.  -->\\n    <transition event=\\"connection.disconnected\\">\\n      <log expr=\\"''connection.disconnected -> ${internal.callId}''\\" />\\n      <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''COMPLETED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.trigger\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n    </transition>\\n    \\n    <transition event=\\"dialog.started\\">\\n      <log expr=\\"''dialog.started -> ${internal.callId}''\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''dialog start''\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n\\n    </transition>\\n     \\n    <!-- Dialog exit -->\\n    <transition event=\\"dialog.exit\\">\\n      <log expr=\\"''dialog.exit -> ${internal.callId}''\\" />\\n      <disconnect />\\n    </transition>\\n\\n    <!-- ERROR!! -->\\n    <transition event=\\"error.*\\" >\\n      <log expr=\\"''Error[CFL]: ('' + event${d}.reason + '')''\\"/>\\n      <exit/>\\n    </transition>\\n\\n  </eventprocessor>\\n\\n</ccxml>"},"vxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<vxml version=\\"2.1\\">\\n\\n  ## Note: All over-rides below must be over-ridden in your flow, preferably your entry flow\\n\\n  ## Over-ride for a different timeout between user prompts\\n  #if (! $timeout) #set($timeout = 10) #end\\n\\n  ## Mandatorily over-ride this with the current caller''s locale based on how your application stores it\\n\\t#if (! $locale) #set($locale = \\"en\\") #end\\n\\n  ## over-ride this if you want to use a different skip character\\n  #if (! $skipChars) #set($skipChars = \\"*\\") #end\\n  \\n  #set($ext = \\".mp3\\")\\n\\n  ## Mandatorily over-ride this with the new flow name that you want to skip to if the skipChars is pressed\\n  #if ($internal.callDirection == \\"OUTGOING\\" && $skipFlow && $skipFlow != \\"\\")\\n\\t<link event=\\"SkipEvent\\">\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"skipRule\\" mode=\\"dtmf\\">\\n\\t\\t\\t<rule id=\\"skipRule\\" scope=\\"public\\">\\n\\t\\t\\t\\t<item>${skipChars}</item>\\n\\t\\t\\t</rule>\\n\\t\\t</grammar>\\n\\t</link>\\n\\n\\t<catch event=\\"SkipEvent\\">\\n\\t\\t<submit next=\\"${internal.nextURL}?jumpTo=${skipFlow}\\" />\\n\\t</catch>\\n  #end\\n\\n\\n<form>\\n\\t<var name=\\"gNoInputEventCount\\" expr=\\"0\\" />\\n\\t<var name=\\"gNoMatchEventCount\\" expr=\\"0\\" />\\n\\t<block>\\n\\t\\t<prompt bargein=\\"true\\" bargeintype=\\"hotword\\">#set($voiceFileName = \\"testVoiceSuccess\\")\\n</prompt>\\n\\t\\t<prompt bargein=\\"false\\">\\n\\t\\t\\t<audio src=\\"http://cflinstalltest.cloudapp.net/audio/openmrs/$locale/$voiceFileName$ext\\" />\\n\\t\\t</prompt>\\n\\t</block>\\n\\t<field name=\\"finishedHearing\\"><property name=\\"timeout\\" value=\\"0.1s\\" />\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"finishedRule\\" mode=\\"dtmf\\"><rule id=\\"finishedRule\\" scope=\\"public\\"><item>@</item></rule></grammar>\\n\\t\\t<nomatch />\\n\\t\\t<noinput count=\\"1\\"><goto nextitem=\\"submit\\" /></noinput>\\n\\t</field>\\n\\t<block name=\\"submit\\">\\n\\t\\t<goto next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t</block>\\n</form>\\n</vxml>"}},"blocks":[{"name":"Form","type":"form","elements":[{"name":"Txt","type":"txt","txt":"#set($voiceFileName = \\"testVoiceSuccess\\")\\n`$voiceFileName`"}]}],"step":"play-outbound","continueNode":true},{"nodeType":"system","templates":{"velocity":{"content":"|MainFlow.goodbye|","dirty":false}},"step":"play-outbound-handler"},{"nodeType":"user","templates":{"ccxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<ccxml version=\\"1.0\\" xmlns:voxeo=\\"http://community.voxeo.com/xmlns/ccxml\\">\\n\\n\\t#set($d = \\"$\\")\\n  <var name=\\"callTimeout\\" expr=\\"''60s''\\" />\\n  <var name=\\"state\\" expr=\\"''init''\\"/>\\n\\n  <!-- OUTGOING, INCOMING -->\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"statusURL\\" expr=\\"''${internal.baseURL}/callflows/status/${internal.callId}''\\" />\\n  <var name=\\"connectionId\\" expr=\\"''outboundID''\\" />\\n  <var name=\\"callId\\" expr=\\"''${internal.callId}''\\" />\\n  <var name=\\"jumpTo\\" expr=\\"''${internal.jumpTo}''\\" />\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"callStatus\\" />\\n\\n  <log expr=\\"''startupmode = '' + session.startupmode\\"/>\\n \\n  <eventprocessor>\\n\\n    <!-- CCXML Loaded -->\\n    <transition event=\\"ccxml.loaded\\">\\n      <log expr=\\"''ccxml loaded''\\" />\\n      <if cond=\\"session.startupmode === ''external''\\">\\n        <!-- tel:xxxx, sip:xxx@h:p sip:user@127.0.0.1:5070  -->\\n        <createcall dest=\\"''tel:+'' + ''${phone}''\\" callerid=\\"''${phone}''\\" connectionid=\\"connectionId\\" timeout=\\"callTimeout\\"/>\\n      </if>\\n    </transition>\\n   \\n    <!-- Process the incoming call --> \\n    <transition event=\\"connection.alerting\\">\\n      <log expr=\\"''connection.alerting''\\" />\\n      <accept/>     \\n    </transition>\\n      \\n    <transition event=\\"connection.failed\\">\\n      <var name=\\"eventReason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>      \\n\\n    </transition>\\n\\n    <!-- Call has been answered.--> \\n    <transition event=\\"connection.connected\\">\\n      <log expr=\\"''connection.connected -> ${internal.callId}''\\" />\\n\\t\\t\\t\\t<dialogstart src=\\"''${internal.baseURL}/callflows/in/voxeo/flows/MainFlow.vxml''\\" namelist=\\"session.id application.callerId callId  #if($internal.callDirection == ''OUTGOING'') jumpTo #end\\" />\\n      <var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''connected''\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <var name=\\"externalId\\" expr=\\"session.id\\" />\\n      <var name=\\"externalType\\" expr=\\"''voxeoSessionId''\\" />\\n      <send data=\\"''callMaxTimeReached''\\" target=\\"session.id\\" delay=\\"''600s''\\" />\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason externalId externalType timestamp\\"/>      \\n    </transition>\\n    \\n    <transition event=\\"callMaxTimeReached\\">\\n      <if cond=\\"callStatus == ''IN_PROGRESS''\\">\\n        <log expr=\\"''-- Max Call Time Reached / Disconnecting Call --''\\" />\\n        <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n        <var name=\\"reason\\" expr=\\"''Max time reached''\\" />\\n        <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n        <log expr=\\"''status='' + status + ''; reason = '' + reason\\" />   \\n        <send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>  \\n        <disconnect/>  \\n      </if>\\n\\t\\t</transition>  \\n\\n    <!-- Caller hung up.  -->\\n    <transition event=\\"connection.disconnected\\">\\n      <log expr=\\"''connection.disconnected -> ${internal.callId}''\\" />\\n      <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''COMPLETED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.trigger\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n    </transition>\\n    \\n    <transition event=\\"dialog.started\\">\\n      <log expr=\\"''dialog.started -> ${internal.callId}''\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''dialog start''\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n\\n    </transition>\\n     \\n    <!-- Dialog exit -->\\n    <transition event=\\"dialog.exit\\">\\n      <log expr=\\"''dialog.exit -> ${internal.callId}''\\" />\\n      <disconnect />\\n    </transition>\\n\\n    <!-- ERROR!! -->\\n    <transition event=\\"error.*\\" >\\n      <log expr=\\"''Error[CFL]: ('' + event${d}.reason + '')''\\"/>\\n      <exit/>\\n    </transition>\\n\\n  </eventprocessor>\\n\\n</ccxml>"},"vxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<vxml version=\\"2.1\\">\\n\\n  ## Note: All over-rides below must be over-ridden in your flow, preferably your entry flow\\n\\n  ## Over-ride for a different timeout between user prompts\\n  #if (! $timeout) #set($timeout = 10) #end\\n\\n  ## Mandatorily over-ride this with the current caller''s locale based on how your application stores it\\n\\t#if (! $locale) #set($locale = \\"en\\") #end\\n\\n  ## over-ride this if you want to use a different skip character\\n  #if (! $skipChars) #set($skipChars = \\"*\\") #end\\n  \\n  #set($ext = \\".mp3\\")\\n\\n  ## Mandatorily over-ride this with the new flow name that you want to skip to if the skipChars is pressed\\n  #if ($internal.callDirection == \\"OUTGOING\\" && $skipFlow && $skipFlow != \\"\\")\\n\\t<link event=\\"SkipEvent\\">\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"skipRule\\" mode=\\"dtmf\\">\\n\\t\\t\\t<rule id=\\"skipRule\\" scope=\\"public\\">\\n\\t\\t\\t\\t<item>${skipChars}</item>\\n\\t\\t\\t</rule>\\n\\t\\t</grammar>\\n\\t</link>\\n\\n\\t<catch event=\\"SkipEvent\\">\\n\\t\\t<submit next=\\"${internal.nextURL}?jumpTo=${skipFlow}\\" />\\n\\t</catch>\\n  #end\\n\\n\\n<form>\\n\\t<var name=\\"gNoInputEventCount\\" expr=\\"0\\" />\\n\\t<var name=\\"gNoMatchEventCount\\" expr=\\"0\\" />\\n\\t<block>\\n\\t\\t<prompt bargein=\\"true\\" bargeintype=\\"hotword\\">#if ($invalidCount < 2)\\n\\t#set($voiceFileName = \\"wrong_input\\")\\n  </prompt>\\n\\t\\t<prompt bargein=\\"false\\">\\n\\t\\t\\t<audio src=\\"http://cflinstalltest.cloudapp.net/audio/openmrs/$locale/$voiceFileName$ext\\" />\\n\\t\\t</prompt>\\n\\t\\t<prompt bargein=\\"true\\" bargeintype=\\"hotword\\">\\n#end\\n\\n</prompt>\\n\\t</block>\\n\\t<field name=\\"finishedHearing\\"><property name=\\"timeout\\" value=\\"0.1s\\" />\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"finishedRule\\" mode=\\"dtmf\\"><rule id=\\"finishedRule\\" scope=\\"public\\"><item>@</item></rule></grammar>\\n\\t\\t<nomatch />\\n\\t\\t<noinput count=\\"1\\"><goto nextitem=\\"submit\\" /></noinput>\\n\\t</field>\\n\\t<block name=\\"submit\\">\\n\\t\\t<goto next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t</block>\\n</form>\\n</vxml>"}},"blocks":[{"name":"Form","type":"form","elements":[{"name":"Txt","type":"txt","txt":"#if ($invalidCount < 2)\\n\\t#set($voiceFileName = \\"wrong_input\\")\\n  `$voiceFileName`\\n#end\\n\\n"}]}],"step":"invalid-input","continueNode":true},{"nodeType":"system","templates":{"velocity":{"content":"#set($params.playedMessages = $voiceFileName)\\n#if ($invalidCount < 2)\\n\\t#set($invalidCount = $invalidCount + 1)\\n\\t|$returnNode|\\n#else\\n\\t|remove-first-message|\\n#end","dirty":false}},"step":"invalid-input-handler"},{"nodeType":"user","templates":{"ccxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<ccxml version=\\"1.0\\" xmlns:voxeo=\\"http://community.voxeo.com/xmlns/ccxml\\">\\n\\n\\t#set($d = \\"$\\")\\n  <var name=\\"callTimeout\\" expr=\\"''60s''\\" />\\n  <var name=\\"state\\" expr=\\"''init''\\"/>\\n\\n  <!-- OUTGOING, INCOMING -->\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"statusURL\\" expr=\\"''${internal.baseURL}/callflows/status/${internal.callId}''\\" />\\n  <var name=\\"connectionId\\" expr=\\"''outboundID''\\" />\\n  <var name=\\"callId\\" expr=\\"''${internal.callId}''\\" />\\n  <var name=\\"jumpTo\\" expr=\\"''${internal.jumpTo}''\\" />\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"callStatus\\" />\\n\\n  <log expr=\\"''startupmode = '' + session.startupmode\\"/>\\n \\n  <eventprocessor>\\n\\n    <!-- CCXML Loaded -->\\n    <transition event=\\"ccxml.loaded\\">\\n      <log expr=\\"''ccxml loaded''\\" />\\n      <if cond=\\"session.startupmode === ''external''\\">\\n        <!-- tel:xxxx, sip:xxx@h:p sip:user@127.0.0.1:5070  -->\\n        <createcall dest=\\"''tel:+'' + ''${phone}''\\" callerid=\\"''${phone}''\\" connectionid=\\"connectionId\\" timeout=\\"callTimeout\\"/>\\n      </if>\\n    </transition>\\n   \\n    <!-- Process the incoming call --> \\n    <transition event=\\"connection.alerting\\">\\n      <log expr=\\"''connection.alerting''\\" />\\n      <accept/>     \\n    </transition>\\n      \\n    <transition event=\\"connection.failed\\">\\n      <var name=\\"eventReason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>      \\n\\n    </transition>\\n\\n    <!-- Call has been answered.--> \\n    <transition event=\\"connection.connected\\">\\n      <log expr=\\"''connection.connected -> ${internal.callId}''\\" />\\n\\t\\t\\t\\t<dialogstart src=\\"''${internal.baseURL}/callflows/in/voxeo/flows/MainFlow.vxml''\\" namelist=\\"session.id application.callerId callId  #if($internal.callDirection == ''OUTGOING'') jumpTo #end\\" />\\n      <var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''connected''\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <var name=\\"externalId\\" expr=\\"session.id\\" />\\n      <var name=\\"externalType\\" expr=\\"''voxeoSessionId''\\" />\\n      <send data=\\"''callMaxTimeReached''\\" target=\\"session.id\\" delay=\\"''600s''\\" />\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason externalId externalType timestamp\\"/>      \\n    </transition>\\n    \\n    <transition event=\\"callMaxTimeReached\\">\\n      <if cond=\\"callStatus == ''IN_PROGRESS''\\">\\n        <log expr=\\"''-- Max Call Time Reached / Disconnecting Call --''\\" />\\n        <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n        <var name=\\"reason\\" expr=\\"''Max time reached''\\" />\\n        <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n        <log expr=\\"''status='' + status + ''; reason = '' + reason\\" />   \\n        <send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>  \\n        <disconnect/>  \\n      </if>\\n\\t\\t</transition>  \\n\\n    <!-- Caller hung up.  -->\\n    <transition event=\\"connection.disconnected\\">\\n      <log expr=\\"''connection.disconnected -> ${internal.callId}''\\" />\\n      <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''COMPLETED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.trigger\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n    </transition>\\n    \\n    <transition event=\\"dialog.started\\">\\n      <log expr=\\"''dialog.started -> ${internal.callId}''\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''dialog start''\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n\\n    </transition>\\n     \\n    <!-- Dialog exit -->\\n    <transition event=\\"dialog.exit\\">\\n      <log expr=\\"''dialog.exit -> ${internal.callId}''\\" />\\n      <disconnect />\\n    </transition>\\n\\n    <!-- ERROR!! -->\\n    <transition event=\\"error.*\\" >\\n      <log expr=\\"''Error[CFL]: ('' + event${d}.reason + '')''\\"/>\\n      <exit/>\\n    </transition>\\n\\n  </eventprocessor>\\n\\n</ccxml>"},"vxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<vxml version=\\"2.1\\">\\n\\n  ## Note: All over-rides below must be over-ridden in your flow, preferably your entry flow\\n\\n  ## Over-ride for a different timeout between user prompts\\n  #if (! $timeout) #set($timeout = 10) #end\\n\\n  ## Mandatorily over-ride this with the current caller''s locale based on how your application stores it\\n\\t#if (! $locale) #set($locale = \\"en\\") #end\\n\\n  ## over-ride this if you want to use a different skip character\\n  #if (! $skipChars) #set($skipChars = \\"*\\") #end\\n  \\n  #set($ext = \\".mp3\\")\\n\\n  ## Mandatorily over-ride this with the new flow name that you want to skip to if the skipChars is pressed\\n  #if ($internal.callDirection == \\"OUTGOING\\" && $skipFlow && $skipFlow != \\"\\")\\n\\t<link event=\\"SkipEvent\\">\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"skipRule\\" mode=\\"dtmf\\">\\n\\t\\t\\t<rule id=\\"skipRule\\" scope=\\"public\\">\\n\\t\\t\\t\\t<item>${skipChars}</item>\\n\\t\\t\\t</rule>\\n\\t\\t</grammar>\\n\\t</link>\\n\\n\\t<catch event=\\"SkipEvent\\">\\n\\t\\t<submit next=\\"${internal.nextURL}?jumpTo=${skipFlow}\\" />\\n\\t</catch>\\n  #end\\n\\n\\n<form>\\n\\t<var name=\\"gNoInputEventCount\\" expr=\\"0\\" />\\n\\t<var name=\\"gNoMatchEventCount\\" expr=\\"0\\" />\\n\\t<block>\\n\\t\\t<prompt bargein=\\"true\\" bargeintype=\\"hotword\\">We have not received any valid input.</prompt>\\n\\t</block>\\n\\t<field name=\\"finishedHearing\\"><property name=\\"timeout\\" value=\\"0.1s\\" />\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"finishedRule\\" mode=\\"dtmf\\"><rule id=\\"finishedRule\\" scope=\\"public\\"><item>@</item></rule></grammar>\\n\\t\\t<nomatch />\\n\\t\\t<noinput count=\\"1\\"><goto nextitem=\\"submit\\" /></noinput>\\n\\t</field>\\n\\t<block name=\\"submit\\">\\n\\t\\t<goto next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t</block>\\n</form>\\n</vxml>"}},"blocks":[{"name":"Form","type":"form","elements":[{"name":"Txt","type":"txt","txt":"We have not received any valid input."}]}],"step":"remove-first-message","continueNode":true},{"nodeType":"system","templates":{"velocity":{"content":"$messages.remove(0)\\n|entry-handler|","dirty":false}},"step":"remove-first-message-handler"}],"name":"OutgoingFlow"}','e4c797d8-c1a4-4c8d-aaea-f47634265cc3',1,1,'2020-06-23 12:50:50','2019-12-10 17:17:42',NULL,NULL,0,NULL)
,('AdherenceReportDailyFlow',NULL,'DRAFT','{"nodes":[{"nodeType":"user","templates":{"vxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<vxml version=\\"2.1\\">\\n\\n  ## Note: All over-rides below must be over-ridden in your flow, preferably your entry flow\\n\\n  ## Over-ride for a different timeout between user prompts\\n  #if (! $timeout) #set($timeout = 10) #end\\n\\n  ## Mandatorily over-ride this with the current caller''s locale based on how your application stores it\\n\\t#if (! $locale) #set($locale = \\"en\\") #end\\n\\n  ## over-ride this if you want to use a different skip character\\n  #if (! $skipChars) #set($skipChars = \\"*\\") #end\\n  \\n  #set($ext = \\".mp3\\")\\n\\n  ## Mandatorily over-ride this with the new flow name that you want to skip to if the skipChars is pressed\\n  #if ($internal.callDirection == \\"OUTGOING\\" && $skipFlow && $skipFlow != \\"\\")\\n\\t<link event=\\"SkipEvent\\">\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"skipRule\\" mode=\\"dtmf\\">\\n\\t\\t\\t<rule id=\\"skipRule\\" scope=\\"public\\">\\n\\t\\t\\t\\t<item>${skipChars}</item>\\n\\t\\t\\t</rule>\\n\\t\\t</grammar>\\n\\t</link>\\n\\n\\t<catch event=\\"SkipEvent\\">\\n\\t\\t<submit next=\\"${internal.nextURL}?jumpTo=${skipFlow}\\" />\\n\\t</catch>\\n  #end\\n\\n\\n<form>\\n\\t<var name=\\"gNoInputEventCount\\" expr=\\"0\\" />\\n\\t<var name=\\"gNoMatchEventCount\\" expr=\\"0\\" />\\n\\t<block>\\n\\t\\t<prompt bargein=\\"true\\" bargeintype=\\"hotword\\">#set($voiceFileName = \\"intro_pillreminder\\")\\n</prompt>\\n\\t\\t<prompt bargein=\\"false\\">\\n\\t\\t\\t<audio src=\\"http://cflinstalltest.cloudapp.net/audio/openmrs/$locale/$voiceFileName$ext\\" />\\n\\t\\t</prompt>\\n\\t</block>\\n\\t<field name=\\"finishedHearing\\"><property name=\\"timeout\\" value=\\"0.1s\\" />\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"finishedRule\\" mode=\\"dtmf\\"><rule id=\\"finishedRule\\" scope=\\"public\\"><item>@</item></rule></grammar>\\n\\t\\t<nomatch />\\n\\t\\t<noinput count=\\"1\\"><goto nextitem=\\"submit\\" /></noinput>\\n\\t</field>\\n\\t<block name=\\"submit\\">\\n\\t\\t<goto next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t</block>\\n</form>\\n</vxml>"},"ccxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<ccxml version=\\"1.0\\" xmlns:voxeo=\\"http://community.voxeo.com/xmlns/ccxml\\">\\n\\n\\t#set($d = \\"$\\")\\n  <var name=\\"callTimeout\\" expr=\\"''60s''\\" />\\n  <var name=\\"state\\" expr=\\"''init''\\"/>\\n\\n  <!-- OUTGOING, INCOMING -->\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"statusURL\\" expr=\\"''${internal.baseURL}/callflows/status/${internal.callId}''\\" />\\n  <var name=\\"connectionId\\" expr=\\"''outboundID''\\" />\\n  <var name=\\"callId\\" expr=\\"''${internal.callId}''\\" />\\n  <var name=\\"jumpTo\\" expr=\\"''${internal.jumpTo}''\\" />\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"callStatus\\" />\\n\\n  <log expr=\\"''startupmode = '' + session.startupmode\\"/>\\n \\n  <eventprocessor>\\n\\n    <!-- CCXML Loaded -->\\n    <transition event=\\"ccxml.loaded\\">\\n      <log expr=\\"''ccxml loaded''\\" />\\n      <if cond=\\"session.startupmode === ''external''\\">\\n        <!-- tel:xxxx, sip:xxx@h:p sip:user@127.0.0.1:5070  -->\\n        <createcall dest=\\"''tel:+'' + ''${phone}''\\" callerid=\\"''${phone}''\\" connectionid=\\"connectionId\\" timeout=\\"callTimeout\\"/>\\n      </if>\\n    </transition>\\n   \\n    <!-- Process the incoming call --> \\n    <transition event=\\"connection.alerting\\">\\n      <log expr=\\"''connection.alerting''\\" />\\n      <accept/>     \\n    </transition>\\n      \\n    <transition event=\\"connection.failed\\">\\n      <var name=\\"eventReason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>      \\n\\n    </transition>\\n\\n    <!-- Call has been answered.--> \\n    <transition event=\\"connection.connected\\">\\n      <log expr=\\"''connection.connected -> ${internal.callId}''\\" />\\n\\t\\t\\t\\t<dialogstart src=\\"''${internal.baseURL}/callflows/in/voxeo/flows/MainFlow.vxml''\\" namelist=\\"session.id application.callerId callId  #if($internal.callDirection == ''OUTGOING'') jumpTo #end\\" />\\n      <var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''connected''\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <var name=\\"externalId\\" expr=\\"session.id\\" />\\n      <var name=\\"externalType\\" expr=\\"''voxeoSessionId''\\" />\\n      <send data=\\"''callMaxTimeReached''\\" target=\\"session.id\\" delay=\\"''600s''\\" />\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason externalId externalType timestamp\\"/>      \\n    </transition>\\n    \\n    <transition event=\\"callMaxTimeReached\\">\\n      <if cond=\\"callStatus == ''IN_PROGRESS''\\">\\n        <log expr=\\"''-- Max Call Time Reached / Disconnecting Call --''\\" />\\n        <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n        <var name=\\"reason\\" expr=\\"''Max time reached''\\" />\\n        <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n        <log expr=\\"''status='' + status + ''; reason = '' + reason\\" />   \\n        <send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>  \\n        <disconnect/>  \\n      </if>\\n\\t\\t</transition>  \\n\\n    <!-- Caller hung up.  -->\\n    <transition event=\\"connection.disconnected\\">\\n      <log expr=\\"''connection.disconnected -> ${internal.callId}''\\" />\\n      <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''COMPLETED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.trigger\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n    </transition>\\n    \\n    <transition event=\\"dialog.started\\">\\n      <log expr=\\"''dialog.started -> ${internal.callId}''\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''dialog start''\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n\\n    </transition>\\n     \\n    <!-- Dialog exit -->\\n    <transition event=\\"dialog.exit\\">\\n      <log expr=\\"''dialog.exit -> ${internal.callId}''\\" />\\n      <disconnect />\\n    </transition>\\n\\n    <!-- ERROR!! -->\\n    <transition event=\\"error.*\\" >\\n      <log expr=\\"''Error[CFL]: ('' + event${d}.reason + '')''\\"/>\\n      <exit/>\\n    </transition>\\n\\n  </eventprocessor>\\n\\n</ccxml>"}},"blocks":[{"name":"Form","type":"form","elements":[{"name":"Txt","type":"txt","txt":"#set($voiceFileName = \\"intro_pillreminder\\")\\n`$voiceFileName`"}]}],"step":"entry","continueNode":true},{"nodeType":"system","templates":{"velocity":{"content":"#set($params.playedMessages = $voiceFileName)\\n#set($invalidCount = 0)\\n#set($noInputCount = 0)\\n|adherence-question|","dirty":false}},"step":"entry-handler"},{"nodeType":"user","templates":{"vxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<vxml version=\\"2.1\\">\\n\\n  ## Note: All over-rides below must be over-ridden in your flow, preferably your entry flow\\n\\n  ## Over-ride for a different timeout between user prompts\\n  #if (! $timeout) #set($timeout = 10) #end\\n\\n  ## Mandatorily over-ride this with the current caller''s locale based on how your application stores it\\n\\t#if (! $locale) #set($locale = \\"en\\") #end\\n\\n  ## over-ride this if you want to use a different skip character\\n  #if (! $skipChars) #set($skipChars = \\"*\\") #end\\n  \\n  #set($ext = \\".mp3\\")\\n\\n  ## Mandatorily over-ride this with the new flow name that you want to skip to if the skipChars is pressed\\n  #if ($internal.callDirection == \\"OUTGOING\\" && $skipFlow && $skipFlow != \\"\\")\\n\\t<link event=\\"SkipEvent\\">\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"skipRule\\" mode=\\"dtmf\\">\\n\\t\\t\\t<rule id=\\"skipRule\\" scope=\\"public\\">\\n\\t\\t\\t\\t<item>${skipChars}</item>\\n\\t\\t\\t</rule>\\n\\t\\t</grammar>\\n\\t</link>\\n\\n\\t<catch event=\\"SkipEvent\\">\\n\\t\\t<submit next=\\"${internal.nextURL}?jumpTo=${skipFlow}\\" />\\n\\t</catch>\\n  #end\\n\\n\\n<form>\\n\\t<var name=\\"gNoInputEventCount\\" expr=\\"0\\" />\\n\\t<var name=\\"gNoMatchEventCount\\" expr=\\"0\\" />\\n\\t<block>\\n\\t\\t<prompt bargein=\\"true\\" bargeintype=\\"hotword\\">Thank you for your input.</prompt>\\n\\t</block>\\n\\t<field name=\\"finishedHearing\\"><property name=\\"timeout\\" value=\\"0.1s\\" />\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"finishedRule\\" mode=\\"dtmf\\"><rule id=\\"finishedRule\\" scope=\\"public\\"><item>@</item></rule></grammar>\\n\\t\\t<nomatch />\\n\\t\\t<noinput count=\\"1\\"><goto nextitem=\\"submit\\" /></noinput>\\n\\t</field>\\n\\t<block name=\\"submit\\">\\n\\t\\t<goto next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t</block>\\n</form>\\n</vxml>"},"ccxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<ccxml version=\\"1.0\\" xmlns:voxeo=\\"http://community.voxeo.com/xmlns/ccxml\\">\\n\\n\\t#set($d = \\"$\\")\\n  <var name=\\"callTimeout\\" expr=\\"''60s''\\" />\\n  <var name=\\"state\\" expr=\\"''init''\\"/>\\n\\n  <!-- OUTGOING, INCOMING -->\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"statusURL\\" expr=\\"''${internal.baseURL}/callflows/status/${internal.callId}''\\" />\\n  <var name=\\"connectionId\\" expr=\\"''outboundID''\\" />\\n  <var name=\\"callId\\" expr=\\"''${internal.callId}''\\" />\\n  <var name=\\"jumpTo\\" expr=\\"''${internal.jumpTo}''\\" />\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"callStatus\\" />\\n\\n  <log expr=\\"''startupmode = '' + session.startupmode\\"/>\\n \\n  <eventprocessor>\\n\\n    <!-- CCXML Loaded -->\\n    <transition event=\\"ccxml.loaded\\">\\n      <log expr=\\"''ccxml loaded''\\" />\\n      <if cond=\\"session.startupmode === ''external''\\">\\n        <!-- tel:xxxx, sip:xxx@h:p sip:user@127.0.0.1:5070  -->\\n        <createcall dest=\\"''tel:+'' + ''${phone}''\\" callerid=\\"''${phone}''\\" connectionid=\\"connectionId\\" timeout=\\"callTimeout\\"/>\\n      </if>\\n    </transition>\\n   \\n    <!-- Process the incoming call --> \\n    <transition event=\\"connection.alerting\\">\\n      <log expr=\\"''connection.alerting''\\" />\\n      <accept/>     \\n    </transition>\\n      \\n    <transition event=\\"connection.failed\\">\\n      <var name=\\"eventReason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>      \\n\\n    </transition>\\n\\n    <!-- Call has been answered.--> \\n    <transition event=\\"connection.connected\\">\\n      <log expr=\\"''connection.connected -> ${internal.callId}''\\" />\\n\\t\\t\\t\\t<dialogstart src=\\"''${internal.baseURL}/callflows/in/voxeo/flows/MainFlow.vxml''\\" namelist=\\"session.id application.callerId callId  #if($internal.callDirection == ''OUTGOING'') jumpTo #end\\" />\\n      <var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''connected''\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <var name=\\"externalId\\" expr=\\"session.id\\" />\\n      <var name=\\"externalType\\" expr=\\"''voxeoSessionId''\\" />\\n      <send data=\\"''callMaxTimeReached''\\" target=\\"session.id\\" delay=\\"''600s''\\" />\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason externalId externalType timestamp\\"/>      \\n    </transition>\\n    \\n    <transition event=\\"callMaxTimeReached\\">\\n      <if cond=\\"callStatus == ''IN_PROGRESS''\\">\\n        <log expr=\\"''-- Max Call Time Reached / Disconnecting Call --''\\" />\\n        <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n        <var name=\\"reason\\" expr=\\"''Max time reached''\\" />\\n        <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n        <log expr=\\"''status='' + status + ''; reason = '' + reason\\" />   \\n        <send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>  \\n        <disconnect/>  \\n      </if>\\n\\t\\t</transition>  \\n\\n    <!-- Caller hung up.  -->\\n    <transition event=\\"connection.disconnected\\">\\n      <log expr=\\"''connection.disconnected -> ${internal.callId}''\\" />\\n      <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''COMPLETED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.trigger\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n    </transition>\\n    \\n    <transition event=\\"dialog.started\\">\\n      <log expr=\\"''dialog.started -> ${internal.callId}''\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''dialog start''\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n\\n    </transition>\\n     \\n    <!-- Dialog exit -->\\n    <transition event=\\"dialog.exit\\">\\n      <log expr=\\"''dialog.exit -> ${internal.callId}''\\" />\\n      <disconnect />\\n    </transition>\\n\\n    <!-- ERROR!! -->\\n    <transition event=\\"error.*\\" >\\n      <log expr=\\"''Error[CFL]: ('' + event${d}.reason + '')''\\"/>\\n      <exit/>\\n    </transition>\\n\\n  </eventprocessor>\\n\\n</ccxml>"}},"blocks":[{"name":"Form","type":"form","elements":[{"name":"Txt","type":"txt","txt":"Thank you for your input."}]}],"step":"user-response","continueNode":true},{"nodeType":"system","templates":{"velocity":{"content":"message::::::::::: $messages.get(0).messageId\\ncalId::::::::::::::: $callId\\nresponseId:::::::::: $responseId\\n#set($messageId = $messages.get(0).messageId)\\n##$messagesService.registerResponseAndStatus($messageId, 165280, $responseId, $userResponse.toString(), ''DELIVERED'', $DateUtil.now(), $callId)\\n$messagesService.registerResponseAndStatus($messageId, 165280, '''', $responseId, $response, ''DELIVERED'', $DateUtil.now(), $callId)\\n$messages.remove(0)\\n|OutgoingFlow.entry-handler|","dirty":false}},"step":"user-response-handler"},{"nodeType":"user","templates":{"vxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<vxml version=\\"2.1\\">\\n\\n  ## Note: All over-rides below must be over-ridden in your flow, preferably your entry flow\\n\\n  ## Over-ride for a different timeout between user prompts\\n  #if (! $timeout) #set($timeout = 10) #end\\n\\n  ## Mandatorily over-ride this with the current caller''s locale based on how your application stores it\\n\\t#if (! $locale) #set($locale = \\"en\\") #end\\n\\n  ## over-ride this if you want to use a different skip character\\n  #if (! $skipChars) #set($skipChars = \\"*\\") #end\\n  \\n  #set($ext = \\".mp3\\")\\n\\n  ## Mandatorily over-ride this with the new flow name that you want to skip to if the skipChars is pressed\\n  #if ($internal.callDirection == \\"OUTGOING\\" && $skipFlow && $skipFlow != \\"\\")\\n\\t<link event=\\"SkipEvent\\">\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"skipRule\\" mode=\\"dtmf\\">\\n\\t\\t\\t<rule id=\\"skipRule\\" scope=\\"public\\">\\n\\t\\t\\t\\t<item>${skipChars}</item>\\n\\t\\t\\t</rule>\\n\\t\\t</grammar>\\n\\t</link>\\n\\n\\t<catch event=\\"SkipEvent\\">\\n\\t\\t<submit next=\\"${internal.nextURL}?jumpTo=${skipFlow}\\" />\\n\\t</catch>\\n  #end\\n\\n\\n<form>\\n\\t<var name=\\"gNoInputEventCount\\" expr=\\"0\\" />\\n\\t<var name=\\"gNoMatchEventCount\\" expr=\\"0\\" />\\n\\t<field name=\\"userInput\\" type=\\"digits?length=1\\">\\n\\t\\t<property name=\\"inputmodes\\" value=\\"dtmf\\" />\\n\\t\\t<prompt bargein=\\"true\\" timeout=\\"${timeout}s\\">#set($voiceFileName = \\"001_02_02_itsTimeForPill1\\")\\n</prompt>\\n\\t\\t<prompt bargein=\\"true\\" timeout=\\"${timeout}s\\">\\n\\t\\t\\t<audio src=\\"http://cflinstalltest.cloudapp.net/audio/openmrs/$locale/$voiceFileName$ext\\" />\\n\\t\\t</prompt>\\n\\t\\t<prompt bargein=\\"true\\" timeout=\\"${timeout}s\\">\\nIf you had taken your current dosage press 1, if you can not take your current dosage press 3.</prompt>\\n\\t\\t<noinput count=\\"1\\">\\n\\t\\t<var name=\\"gNoInputEventCount\\" expr=\\"gNoInputEventCount+1\\" />\\n\\t\\t<submit namelist=\\"gNoInputEventCount gNoMatchEventCount\\" next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t\\t</noinput>\\n\\t\\t<nomatch count=\\"1\\">\\n\\t\\t<var name=\\"gNoMatchEventCount\\" expr=\\"gNoMatchEventCount+1\\" />\\n\\t\\t<submit namelist=\\"gNoInputEventCount gNoMatchEventCount\\" next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t\\t</nomatch>\\n\\t\\t<noinput><reprompt />\\n\\t\\t</noinput>\\n\\t\\t<nomatch><reprompt />\\n\\t\\t</nomatch>\\n\\t</field>\\n\\t<filled mode=\\"all\\">\\n\\t\\t<submit namelist=\\"userInput\\" next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t</filled>\\n</form>\\n</vxml>"},"ccxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<ccxml version=\\"1.0\\" xmlns:voxeo=\\"http://community.voxeo.com/xmlns/ccxml\\">\\n\\n\\t#set($d = \\"$\\")\\n  <var name=\\"callTimeout\\" expr=\\"''60s''\\" />\\n  <var name=\\"state\\" expr=\\"''init''\\"/>\\n\\n  <!-- OUTGOING, INCOMING -->\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"statusURL\\" expr=\\"''${internal.baseURL}/callflows/status/${internal.callId}''\\" />\\n  <var name=\\"connectionId\\" expr=\\"''outboundID''\\" />\\n  <var name=\\"callId\\" expr=\\"''${internal.callId}''\\" />\\n  <var name=\\"jumpTo\\" expr=\\"''${internal.jumpTo}''\\" />\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"callStatus\\" />\\n\\n  <log expr=\\"''startupmode = '' + session.startupmode\\"/>\\n \\n  <eventprocessor>\\n\\n    <!-- CCXML Loaded -->\\n    <transition event=\\"ccxml.loaded\\">\\n      <log expr=\\"''ccxml loaded''\\" />\\n      <if cond=\\"session.startupmode === ''external''\\">\\n        <!-- tel:xxxx, sip:xxx@h:p sip:user@127.0.0.1:5070  -->\\n        <createcall dest=\\"''tel:+'' + ''${phone}''\\" callerid=\\"''${phone}''\\" connectionid=\\"connectionId\\" timeout=\\"callTimeout\\"/>\\n      </if>\\n    </transition>\\n   \\n    <!-- Process the incoming call --> \\n    <transition event=\\"connection.alerting\\">\\n      <log expr=\\"''connection.alerting''\\" />\\n      <accept/>     \\n    </transition>\\n      \\n    <transition event=\\"connection.failed\\">\\n      <var name=\\"eventReason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>      \\n\\n    </transition>\\n\\n    <!-- Call has been answered.--> \\n    <transition event=\\"connection.connected\\">\\n      <log expr=\\"''connection.connected -> ${internal.callId}''\\" />\\n\\t\\t\\t\\t<dialogstart src=\\"''${internal.baseURL}/callflows/in/voxeo/flows/MainFlow.vxml''\\" namelist=\\"session.id application.callerId callId  #if($internal.callDirection == ''OUTGOING'') jumpTo #end\\" />\\n      <var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''connected''\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <var name=\\"externalId\\" expr=\\"session.id\\" />\\n      <var name=\\"externalType\\" expr=\\"''voxeoSessionId''\\" />\\n      <send data=\\"''callMaxTimeReached''\\" target=\\"session.id\\" delay=\\"''600s''\\" />\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason externalId externalType timestamp\\"/>      \\n    </transition>\\n    \\n    <transition event=\\"callMaxTimeReached\\">\\n      <if cond=\\"callStatus == ''IN_PROGRESS''\\">\\n        <log expr=\\"''-- Max Call Time Reached / Disconnecting Call --''\\" />\\n        <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n        <var name=\\"reason\\" expr=\\"''Max time reached''\\" />\\n        <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n        <log expr=\\"''status='' + status + ''; reason = '' + reason\\" />   \\n        <send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>  \\n        <disconnect/>  \\n      </if>\\n\\t\\t</transition>  \\n\\n    <!-- Caller hung up.  -->\\n    <transition event=\\"connection.disconnected\\">\\n      <log expr=\\"''connection.disconnected -> ${internal.callId}''\\" />\\n      <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''COMPLETED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.trigger\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n    </transition>\\n    \\n    <transition event=\\"dialog.started\\">\\n      <log expr=\\"''dialog.started -> ${internal.callId}''\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''dialog start''\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n\\n    </transition>\\n     \\n    <!-- Dialog exit -->\\n    <transition event=\\"dialog.exit\\">\\n      <log expr=\\"''dialog.exit -> ${internal.callId}''\\" />\\n      <disconnect />\\n    </transition>\\n\\n    <!-- ERROR!! -->\\n    <transition event=\\"error.*\\" >\\n      <log expr=\\"''Error[CFL]: ('' + event${d}.reason + '')''\\"/>\\n      <exit/>\\n    </transition>\\n\\n  </eventprocessor>\\n\\n</ccxml>"}},"blocks":[{"name":"Form","type":"form","elements":[{"name":"userInput","type":"field","txt":"#set($voiceFileName = \\"001_02_02_itsTimeForPill1\\")\\n`$voiceFileName`\\nIf you had taken your current dosage press 1, if you can not take your current dosage press 3.","fieldType":"digits","noInput":"","noMatch":"","goodBye":"","bargeIn":true,"dtmf":true,"voice":false,"reprompt":"1","fieldMeta":"1"}]}],"step":"adherence-question","continueNode":true},{"nodeType":"system","templates":{"velocity":{"content":"message::::::::::: $messages.get(0)\\n#set($params.playedMessages = $voiceFileName + ''|'' + $voiceFileName + ''|''+ $params.userInput)\\n#if($params.userInput)\\n\\t#set($userResponse = $params.userInput)\\n\\t#if ($params.userInput == 1)\\n    #set($responseId = 165319)\\n    #set($response = \\"YES\\")\\n    |user-response|\\n  ##elseif($params.userInput == 2)\\n  ##\\t#set($responseId = 165296)\\n  ##  #set($response = \\"YES\\")\\n  ##  |user-response|\\n  #elseif($params.userInput == 3)\\n  \\t#set($responseId = 165310)\\n    #set($response = \\"NO\\")\\n  \\t|user-response|\\n  #else\\n  \\t#set($returnNode = \\"AdherenceReportDailyFlow.adherence-question\\")\\n    |OutgoingFlow.invalid-input|\\n  #end  \\n#else\\n\\t|MainFlow.no-input|\\n#end","dirty":false}},"step":"adherence-question-handler"}],"name":"AdherenceReportDailyFlow"}','cfdf7096-8c25-45e0-9ec2-9c6a20628392',1,1,'2020-02-24 12:18:57','2019-12-12 00:21:46',NULL,NULL,0,NULL)
,('MainFlow',NULL,'DRAFT','{"nodes":[{"nodeType":"user","templates":{"ccxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<ccxml version=\\"1.0\\" xmlns:voxeo=\\"http://community.voxeo.com/xmlns/ccxml\\">\\n\\n\\t#set($d = \\"$\\")\\n  <var name=\\"callTimeout\\" expr=\\"''60s''\\" />\\n  <var name=\\"state\\" expr=\\"''init''\\"/>\\n\\n  <!-- OUTGOING, INCOMING -->\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"statusURL\\" expr=\\"''${internal.baseURL}/callflows/status/${internal.callId}''\\" />\\n  <var name=\\"connectionId\\" expr=\\"''outboundID''\\" />\\n  <var name=\\"callId\\" expr=\\"''${internal.callId}''\\" />\\n  <var name=\\"jumpTo\\" expr=\\"''${internal.jumpTo}''\\" />\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"callStatus\\" />\\n\\n  <log expr=\\"''startupmode = '' + session.startupmode\\"/>\\n \\n  <eventprocessor>\\n\\n    <!-- CCXML Loaded -->\\n    <transition event=\\"ccxml.loaded\\">\\n      <log expr=\\"''ccxml loaded''\\" />\\n      <if cond=\\"session.startupmode === ''external''\\">\\n        <!-- tel:xxxx, sip:xxx@h:p sip:user@127.0.0.1:5070  -->\\n        <createcall dest=\\"''tel:+'' + ''${phone}''\\" callerid=\\"''${phone}''\\" connectionid=\\"connectionId\\" timeout=\\"callTimeout\\"/>\\n      </if>\\n    </transition>\\n   \\n    <!-- Process the incoming call --> \\n    <transition event=\\"connection.alerting\\">\\n      <log expr=\\"''connection.alerting''\\" />\\n      <accept/>     \\n    </transition>\\n      \\n    <transition event=\\"connection.failed\\">\\n      <var name=\\"eventReason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>      \\n\\n    </transition>\\n\\n    <!-- Call has been answered.--> \\n    <transition event=\\"connection.connected\\">\\n      <log expr=\\"''connection.connected -> ${internal.callId}''\\" />\\n\\t\\t\\t\\t<dialogstart src=\\"''${internal.baseURL}/callflows/in/voxeo/flows/MainFlow.vxml''\\" namelist=\\"session.id application.callerId callId  #if($internal.callDirection == ''OUTGOING'') jumpTo #end\\" />\\n      <var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''connected''\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <var name=\\"externalId\\" expr=\\"session.id\\" />\\n      <var name=\\"externalType\\" expr=\\"''voxeoSessionId''\\" />\\n      <send data=\\"''callMaxTimeReached''\\" target=\\"session.id\\" delay=\\"''600s''\\" />\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason externalId externalType timestamp\\"/>      \\n    </transition>\\n    \\n    <transition event=\\"callMaxTimeReached\\">\\n      <if cond=\\"callStatus == ''IN_PROGRESS''\\">\\n        <log expr=\\"''-- Max Call Time Reached / Disconnecting Call --''\\" />\\n        <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n        <var name=\\"reason\\" expr=\\"''Max time reached''\\" />\\n        <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n        <log expr=\\"''status='' + status + ''; reason = '' + reason\\" />   \\n        <send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>  \\n        <disconnect/>  \\n      </if>\\n\\t\\t</transition>  \\n\\n    <!-- Caller hung up.  -->\\n    <transition event=\\"connection.disconnected\\">\\n      <log expr=\\"''connection.disconnected -> ${internal.callId}''\\" />\\n      <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''COMPLETED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.trigger\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n    </transition>\\n    \\n    <transition event=\\"dialog.started\\">\\n      <log expr=\\"''dialog.started -> ${internal.callId}''\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''dialog start''\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n\\n    </transition>\\n     \\n    <!-- Dialog exit -->\\n    <transition event=\\"dialog.exit\\">\\n      <log expr=\\"''dialog.exit -> ${internal.callId}''\\" />\\n      <disconnect />\\n    </transition>\\n\\n    <!-- ERROR!! -->\\n    <transition event=\\"error.*\\" >\\n      <log expr=\\"''Error[CFL]: ('' + event${d}.reason + '')''\\"/>\\n      <exit/>\\n    </transition>\\n\\n  </eventprocessor>\\n\\n</ccxml>"},"vxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<vxml version=\\"2.1\\">\\n\\n  ## Note: All over-rides below must be over-ridden in your flow, preferably your entry flow\\n\\n  ## Over-ride for a different timeout between user prompts\\n  #if (! $timeout) #set($timeout = 10) #end\\n\\n  ## Mandatorily over-ride this with the current caller''s locale based on how your application stores it\\n\\t#if (! $locale) #set($locale = \\"en\\") #end\\n\\n  ## over-ride this if you want to use a different skip character\\n  #if (! $skipChars) #set($skipChars = \\"*\\") #end\\n  \\n  #set($ext = \\".mp3\\")\\n\\n  ## Mandatorily over-ride this with the new flow name that you want to skip to if the skipChars is pressed\\n  #if ($internal.callDirection == \\"OUTGOING\\" && $skipFlow && $skipFlow != \\"\\")\\n\\t<link event=\\"SkipEvent\\">\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"skipRule\\" mode=\\"dtmf\\">\\n\\t\\t\\t<rule id=\\"skipRule\\" scope=\\"public\\">\\n\\t\\t\\t\\t<item>${skipChars}</item>\\n\\t\\t\\t</rule>\\n\\t\\t</grammar>\\n\\t</link>\\n\\n\\t<catch event=\\"SkipEvent\\">\\n\\t\\t<submit next=\\"${internal.nextURL}?jumpTo=${skipFlow}\\" />\\n\\t</catch>\\n  #end\\n\\n\\n<form>\\n\\t<var name=\\"gNoInputEventCount\\" expr=\\"0\\" />\\n\\t<var name=\\"gNoMatchEventCount\\" expr=\\"0\\" />\\n\\t<block>\\n\\t\\t<prompt bargein=\\"true\\" bargeintype=\\"hotword\\">#set($callId = $params.callId)\\n#if(!$phone)\\n #set($phone = $params.get(\\"session.callerid\\"))\\n#end</prompt>\\n\\t</block>\\n\\t<field name=\\"finishedHearing\\"><property name=\\"timeout\\" value=\\"0.1s\\" />\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"finishedRule\\" mode=\\"dtmf\\"><rule id=\\"finishedRule\\" scope=\\"public\\"><item>@</item></rule></grammar>\\n\\t\\t<nomatch />\\n\\t\\t<noinput count=\\"1\\"><goto nextitem=\\"submit\\" /></noinput>\\n\\t</field>\\n\\t<block name=\\"submit\\">\\n\\t\\t<goto next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t</block>\\n</form>\\n</vxml>"}},"blocks":[{"name":"Form","type":"form","elements":[{"name":"Txt","type":"txt","txt":"#set($callId = $params.callId)\\n#if(!$phone)\\n #set($phone = $params.get(\\"session.callerid\\"))\\n#end"}]}],"step":"entry","continueNode":true},{"nodeType":"system","templates":{"velocity":{"content":" ::::::::::::::::::::::::::::::::\\n ::::: MainFlow params logger::::\\n phone:::::::::::: $phone\\n \\n session.callid ::::::::::::::::::: $params.get(\\"session.callerid\\")\\n ::::::::::::::::::::::::::::::::\\n params::::::::::: $params\\n messages::::::::: $messages\\n ::::::::::::::::::::::::::::::::\\n personId::::::::: $personId\\n actorType:::::::: $actorType\\n actorId:::::::: $actorId\\n refKey:::::::: $refKey\\n internal::::::::::::::: $internal\\n callId = $internal.callId\\n #set($callId = $internal.callId)\\n #set($pinAttempts = 0)\\n #set($maxPinAttempt = 3)\\n ::::::::::::::::::::::::::::::::\\n \\n## |test-reschedule|\\n## |exit|\\n\\n#if($refKey)\\n\\t#set($sourceId = $refKey)\\n  #set($sourceType = \\"SCHEDULED_SERVICE_GROUP\\")\\n  #set($serviceGroup = $messagingGroupService.getById($Integer.parseInt($refKey)))\\n  #set($patientId = $serviceGroup.getPatient().personId)\\nservice group:::::::::::::: $patientId\\n\\n#else\\n\\t#set($sourceId = $callId)\\n  #set($sourceType = \\"OTHER\\")\\n  #set($patientId = $actorId)\\n#end\\n\\n\\n#if(!$actorId && $personId)\\n\\t#set ($actorId = $personId)\\n#elseif($actorId)\\t\\n\\t#set ($actorId = $Integer.parseInt($actorId)) \\n#end\\n\\nactorId:::::::: $actorId\\nclassname::::::::::::::::: $actorId.getClass().getName()\\n\\n#if($actorId && $internal.callDirection == ''OUTGOING'')\\n\\t#set ($person = $personDAO.getPerson($actorId))    \\nperson::::::$person\\n#elseif($phone && $internal.callDirection == ''INCOMING'')\\n\\t#set ($cflPersons = $cflPersonService.findByPhone($phone, false))\\n  #set ($resultSize = $cflPersons.size())\\n  #foreach($person in $cflPersons)\\n  ::::::::$person.person\\n  \\t#if($person.patient)\\n    \\t#set ($cflPerson = $person)\\n    #end\\n  #end\\n  \\n \\t#if (!$cflPerson && $resultSize > 0)\\n  \\t#set ($cflPerson = $cflPersons.get(0))\\n  #end\\n  #if ($cflPerson)\\n  \\t#set ($personId = $cflPerson.personId)\\n    #set ($person = $cflPerson.person) \\n    #set ($caregiver = $cflPerson.caregiver)\\n    #set ($isPatient = $cflPerson.patient)\\n  #end\\n#end\\n\\n#if($person)\\n\\t  #set($personStatus = \\"DEACTIVATED\\")\\n    #set ($maxPinAttempt = 3)\\n    #set ($pinAttempts = 0)\\n  \\t#foreach($attribute in $person.getActiveAttributes())\\n    \\tassa:: $attribute.attributeType.personAttributeTypeId ::::::::$attribute.attributeType.name  ::::::  $attribute.value ::::$attribute.voided\\n      #if($attribute.attributeType.personAttributeTypeId == 15 && !$attribute.voided)\\n      \\t#set($personStatus = $attribute.value)\\n        asdasdasd :::::: $personStatus\\n      #end\\n    #end\\n   ## |AdherenceReportDailyFlow.|\\n    |PinFlow.|\\n    ##|main|\\n#else\\n\\t|person-not-found|\\n#end","dirty":false}},"step":"entry-handler"},{"nodeType":"user","templates":{"ccxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<ccxml version=\\"1.0\\" xmlns:voxeo=\\"http://community.voxeo.com/xmlns/ccxml\\">\\n\\n\\t#set($d = \\"$\\")\\n  <var name=\\"callTimeout\\" expr=\\"''60s''\\" />\\n  <var name=\\"state\\" expr=\\"''init''\\"/>\\n\\n  <!-- OUTGOING, INCOMING -->\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"statusURL\\" expr=\\"''${internal.baseURL}/callflows/status/${internal.callId}''\\" />\\n  <var name=\\"connectionId\\" expr=\\"''outboundID''\\" />\\n  <var name=\\"callId\\" expr=\\"''${internal.callId}''\\" />\\n  <var name=\\"jumpTo\\" expr=\\"''${internal.jumpTo}''\\" />\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"callStatus\\" />\\n\\n  <log expr=\\"''startupmode = '' + session.startupmode\\"/>\\n \\n  <eventprocessor>\\n\\n    <!-- CCXML Loaded -->\\n    <transition event=\\"ccxml.loaded\\">\\n      <log expr=\\"''ccxml loaded''\\" />\\n      <if cond=\\"session.startupmode === ''external''\\">\\n        <!-- tel:xxxx, sip:xxx@h:p sip:user@127.0.0.1:5070  -->\\n        <createcall dest=\\"''tel:+'' + ''${phone}''\\" callerid=\\"''${phone}''\\" connectionid=\\"connectionId\\" timeout=\\"callTimeout\\"/>\\n      </if>\\n    </transition>\\n   \\n    <!-- Process the incoming call --> \\n    <transition event=\\"connection.alerting\\">\\n      <log expr=\\"''connection.alerting''\\" />\\n      <accept/>     \\n    </transition>\\n      \\n    <transition event=\\"connection.failed\\">\\n      <var name=\\"eventReason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>      \\n\\n    </transition>\\n\\n    <!-- Call has been answered.--> \\n    <transition event=\\"connection.connected\\">\\n      <log expr=\\"''connection.connected -> ${internal.callId}''\\" />\\n\\t\\t\\t\\t<dialogstart src=\\"''${internal.baseURL}/callflows/in/voxeo/flows/MainFlow.vxml''\\" namelist=\\"session.id application.callerId callId  #if($internal.callDirection == ''OUTGOING'') jumpTo #end\\" />\\n      <var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''connected''\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <var name=\\"externalId\\" expr=\\"session.id\\" />\\n      <var name=\\"externalType\\" expr=\\"''voxeoSessionId''\\" />\\n      <send data=\\"''callMaxTimeReached''\\" target=\\"session.id\\" delay=\\"''600s''\\" />\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason externalId externalType timestamp\\"/>      \\n    </transition>\\n    \\n    <transition event=\\"callMaxTimeReached\\">\\n      <if cond=\\"callStatus == ''IN_PROGRESS''\\">\\n        <log expr=\\"''-- Max Call Time Reached / Disconnecting Call --''\\" />\\n        <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n        <var name=\\"reason\\" expr=\\"''Max time reached''\\" />\\n        <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n        <log expr=\\"''status='' + status + ''; reason = '' + reason\\" />   \\n        <send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>  \\n        <disconnect/>  \\n      </if>\\n\\t\\t</transition>  \\n\\n    <!-- Caller hung up.  -->\\n    <transition event=\\"connection.disconnected\\">\\n      <log expr=\\"''connection.disconnected -> ${internal.callId}''\\" />\\n      <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''COMPLETED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.trigger\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n    </transition>\\n    \\n    <transition event=\\"dialog.started\\">\\n      <log expr=\\"''dialog.started -> ${internal.callId}''\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''dialog start''\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n\\n    </transition>\\n     \\n    <!-- Dialog exit -->\\n    <transition event=\\"dialog.exit\\">\\n      <log expr=\\"''dialog.exit -> ${internal.callId}''\\" />\\n      <disconnect />\\n    </transition>\\n\\n    <!-- ERROR!! -->\\n    <transition event=\\"error.*\\" >\\n      <log expr=\\"''Error[CFL]: ('' + event${d}.reason + '')''\\"/>\\n      <exit/>\\n    </transition>\\n\\n  </eventprocessor>\\n\\n</ccxml>"},"vxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<vxml version=\\"2.1\\">\\n\\n  ## Note: All over-rides below must be over-ridden in your flow, preferably your entry flow\\n\\n  ## Over-ride for a different timeout between user prompts\\n  #if (! $timeout) #set($timeout = 10) #end\\n\\n  ## Mandatorily over-ride this with the current caller''s locale based on how your application stores it\\n\\t#if (! $locale) #set($locale = \\"en\\") #end\\n\\n  ## over-ride this if you want to use a different skip character\\n  #if (! $skipChars) #set($skipChars = \\"*\\") #end\\n  \\n  #set($ext = \\".mp3\\")\\n\\n  ## Mandatorily over-ride this with the new flow name that you want to skip to if the skipChars is pressed\\n  #if ($internal.callDirection == \\"OUTGOING\\" && $skipFlow && $skipFlow != \\"\\")\\n\\t<link event=\\"SkipEvent\\">\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"skipRule\\" mode=\\"dtmf\\">\\n\\t\\t\\t<rule id=\\"skipRule\\" scope=\\"public\\">\\n\\t\\t\\t\\t<item>${skipChars}</item>\\n\\t\\t\\t</rule>\\n\\t\\t</grammar>\\n\\t</link>\\n\\n\\t<catch event=\\"SkipEvent\\">\\n\\t\\t<submit next=\\"${internal.nextURL}?jumpTo=${skipFlow}\\" />\\n\\t</catch>\\n  #end\\n\\n\\n<form>\\n\\t<var name=\\"gNoInputEventCount\\" expr=\\"0\\" />\\n\\t<var name=\\"gNoMatchEventCount\\" expr=\\"0\\" />\\n\\t<block>\\n\\t</block>\\n\\t<field name=\\"finishedHearing\\"><property name=\\"timeout\\" value=\\"0.1s\\" />\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"finishedRule\\" mode=\\"dtmf\\"><rule id=\\"finishedRule\\" scope=\\"public\\"><item>@</item></rule></grammar>\\n\\t\\t<nomatch />\\n\\t\\t<noinput count=\\"1\\"><goto nextitem=\\"submit\\" /></noinput>\\n\\t</field>\\n\\t<block name=\\"submit\\">\\n\\t\\t<goto next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t</block>\\n</form>\\n</vxml>"}},"blocks":[{"name":"Form","type":"form","elements":[{"name":"Txt","type":"txt","txt":""}]}],"step":"main","continueNode":true},{"nodeType":"system","templates":{"velocity":{"content":"$personStatus\\n#set($noInputCount = 0)\\n#set($invalidCount = 0)\\n#if($personStatus == \\"DEACTIVATED\\")\\n\\t|deactivated|\\n#elseif($personStatus == \\"NO_CONSENT\\")\\n\\t|ConsentFlow.|\\n#else\\n\\t|active|\\n#end","dirty":false}},"step":"main-handler"},{"nodeType":"user","templates":{"ccxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<ccxml version=\\"1.0\\" xmlns:voxeo=\\"http://community.voxeo.com/xmlns/ccxml\\">\\n\\n\\t#set($d = \\"$\\")\\n  <var name=\\"callTimeout\\" expr=\\"''60s''\\" />\\n  <var name=\\"state\\" expr=\\"''init''\\"/>\\n\\n  <!-- OUTGOING, INCOMING -->\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"statusURL\\" expr=\\"''${internal.baseURL}/callflows/status/${internal.callId}''\\" />\\n  <var name=\\"connectionId\\" expr=\\"''outboundID''\\" />\\n  <var name=\\"callId\\" expr=\\"''${internal.callId}''\\" />\\n  <var name=\\"jumpTo\\" expr=\\"''${internal.jumpTo}''\\" />\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"callStatus\\" />\\n\\n  <log expr=\\"''startupmode = '' + session.startupmode\\"/>\\n \\n  <eventprocessor>\\n\\n    <!-- CCXML Loaded -->\\n    <transition event=\\"ccxml.loaded\\">\\n      <log expr=\\"''ccxml loaded''\\" />\\n      <if cond=\\"session.startupmode === ''external''\\">\\n        <!-- tel:xxxx, sip:xxx@h:p sip:user@127.0.0.1:5070  -->\\n        <createcall dest=\\"''tel:+'' + ''${phone}''\\" callerid=\\"''${phone}''\\" connectionid=\\"connectionId\\" timeout=\\"callTimeout\\"/>\\n      </if>\\n    </transition>\\n   \\n    <!-- Process the incoming call --> \\n    <transition event=\\"connection.alerting\\">\\n      <log expr=\\"''connection.alerting''\\" />\\n      <accept/>     \\n    </transition>\\n      \\n    <transition event=\\"connection.failed\\">\\n      <var name=\\"eventReason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>      \\n\\n    </transition>\\n\\n    <!-- Call has been answered.--> \\n    <transition event=\\"connection.connected\\">\\n      <log expr=\\"''connection.connected -> ${internal.callId}''\\" />\\n\\t\\t\\t\\t<dialogstart src=\\"''${internal.baseURL}/callflows/in/voxeo/flows/MainFlow.vxml''\\" namelist=\\"session.id application.callerId callId  #if($internal.callDirection == ''OUTGOING'') jumpTo #end\\" />\\n      <var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''connected''\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <var name=\\"externalId\\" expr=\\"session.id\\" />\\n      <var name=\\"externalType\\" expr=\\"''voxeoSessionId''\\" />\\n      <send data=\\"''callMaxTimeReached''\\" target=\\"session.id\\" delay=\\"''600s''\\" />\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason externalId externalType timestamp\\"/>      \\n    </transition>\\n    \\n    <transition event=\\"callMaxTimeReached\\">\\n      <if cond=\\"callStatus == ''IN_PROGRESS''\\">\\n        <log expr=\\"''-- Max Call Time Reached / Disconnecting Call --''\\" />\\n        <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n        <var name=\\"reason\\" expr=\\"''Max time reached''\\" />\\n        <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n        <log expr=\\"''status='' + status + ''; reason = '' + reason\\" />   \\n        <send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>  \\n        <disconnect/>  \\n      </if>\\n\\t\\t</transition>  \\n\\n    <!-- Caller hung up.  -->\\n    <transition event=\\"connection.disconnected\\">\\n      <log expr=\\"''connection.disconnected -> ${internal.callId}''\\" />\\n      <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''COMPLETED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.trigger\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n    </transition>\\n    \\n    <transition event=\\"dialog.started\\">\\n      <log expr=\\"''dialog.started -> ${internal.callId}''\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''dialog start''\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n\\n    </transition>\\n     \\n    <!-- Dialog exit -->\\n    <transition event=\\"dialog.exit\\">\\n      <log expr=\\"''dialog.exit -> ${internal.callId}''\\" />\\n      <disconnect />\\n    </transition>\\n\\n    <!-- ERROR!! -->\\n    <transition event=\\"error.*\\" >\\n      <log expr=\\"''Error[CFL]: ('' + event${d}.reason + '')''\\"/>\\n      <exit/>\\n    </transition>\\n\\n  </eventprocessor>\\n\\n</ccxml>"},"vxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<vxml version=\\"2.1\\">\\n\\n  ## Note: All over-rides below must be over-ridden in your flow, preferably your entry flow\\n\\n  ## Over-ride for a different timeout between user prompts\\n  #if (! $timeout) #set($timeout = 10) #end\\n\\n  ## Mandatorily over-ride this with the current caller''s locale based on how your application stores it\\n\\t#if (! $locale) #set($locale = \\"en\\") #end\\n\\n  ## over-ride this if you want to use a different skip character\\n  #if (! $skipChars) #set($skipChars = \\"*\\") #end\\n  \\n  #set($ext = \\".mp3\\")\\n\\n  ## Mandatorily over-ride this with the new flow name that you want to skip to if the skipChars is pressed\\n  #if ($internal.callDirection == \\"OUTGOING\\" && $skipFlow && $skipFlow != \\"\\")\\n\\t<link event=\\"SkipEvent\\">\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"skipRule\\" mode=\\"dtmf\\">\\n\\t\\t\\t<rule id=\\"skipRule\\" scope=\\"public\\">\\n\\t\\t\\t\\t<item>${skipChars}</item>\\n\\t\\t\\t</rule>\\n\\t\\t</grammar>\\n\\t</link>\\n\\n\\t<catch event=\\"SkipEvent\\">\\n\\t\\t<submit next=\\"${internal.nextURL}?jumpTo=${skipFlow}\\" />\\n\\t</catch>\\n  #end\\n\\n\\n<form>\\n\\t<var name=\\"gNoInputEventCount\\" expr=\\"0\\" />\\n\\t<var name=\\"gNoMatchEventCount\\" expr=\\"0\\" />\\n\\t<block>\\n\\t</block>\\n</form>\\n</vxml>"}},"blocks":[{"name":"Form","type":"form","elements":[{"name":"Txt","type":"txt","txt":""}]}],"step":"exit"},{"nodeType":"system","templates":{"velocity":{"content":"","dirty":false}},"step":""},{"nodeType":"user","templates":{"ccxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<ccxml version=\\"1.0\\" xmlns:voxeo=\\"http://community.voxeo.com/xmlns/ccxml\\">\\n\\n\\t#set($d = \\"$\\")\\n  <var name=\\"callTimeout\\" expr=\\"''60s''\\" />\\n  <var name=\\"state\\" expr=\\"''init''\\"/>\\n\\n  <!-- OUTGOING, INCOMING -->\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"statusURL\\" expr=\\"''${internal.baseURL}/callflows/status/${internal.callId}''\\" />\\n  <var name=\\"connectionId\\" expr=\\"''outboundID''\\" />\\n  <var name=\\"callId\\" expr=\\"''${internal.callId}''\\" />\\n  <var name=\\"jumpTo\\" expr=\\"''${internal.jumpTo}''\\" />\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"callStatus\\" />\\n\\n  <log expr=\\"''startupmode = '' + session.startupmode\\"/>\\n \\n  <eventprocessor>\\n\\n    <!-- CCXML Loaded -->\\n    <transition event=\\"ccxml.loaded\\">\\n      <log expr=\\"''ccxml loaded''\\" />\\n      <if cond=\\"session.startupmode === ''external''\\">\\n        <!-- tel:xxxx, sip:xxx@h:p sip:user@127.0.0.1:5070  -->\\n        <createcall dest=\\"''tel:+'' + ''${phone}''\\" callerid=\\"''${phone}''\\" connectionid=\\"connectionId\\" timeout=\\"callTimeout\\"/>\\n      </if>\\n    </transition>\\n   \\n    <!-- Process the incoming call --> \\n    <transition event=\\"connection.alerting\\">\\n      <log expr=\\"''connection.alerting''\\" />\\n      <accept/>     \\n    </transition>\\n      \\n    <transition event=\\"connection.failed\\">\\n      <var name=\\"eventReason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>      \\n\\n    </transition>\\n\\n    <!-- Call has been answered.--> \\n    <transition event=\\"connection.connected\\">\\n      <log expr=\\"''connection.connected -> ${internal.callId}''\\" />\\n\\t\\t\\t\\t<dialogstart src=\\"''${internal.baseURL}/callflows/in/voxeo/flows/MainFlow.vxml''\\" namelist=\\"session.id application.callerId callId  #if($internal.callDirection == ''OUTGOING'') jumpTo #end\\" />\\n      <var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''connected''\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <var name=\\"externalId\\" expr=\\"session.id\\" />\\n      <var name=\\"externalType\\" expr=\\"''voxeoSessionId''\\" />\\n      <send data=\\"''callMaxTimeReached''\\" target=\\"session.id\\" delay=\\"''600s''\\" />\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason externalId externalType timestamp\\"/>      \\n    </transition>\\n    \\n    <transition event=\\"callMaxTimeReached\\">\\n      <if cond=\\"callStatus == ''IN_PROGRESS''\\">\\n        <log expr=\\"''-- Max Call Time Reached / Disconnecting Call --''\\" />\\n        <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n        <var name=\\"reason\\" expr=\\"''Max time reached''\\" />\\n        <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n        <log expr=\\"''status='' + status + ''; reason = '' + reason\\" />   \\n        <send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>  \\n        <disconnect/>  \\n      </if>\\n\\t\\t</transition>  \\n\\n    <!-- Caller hung up.  -->\\n    <transition event=\\"connection.disconnected\\">\\n      <log expr=\\"''connection.disconnected -> ${internal.callId}''\\" />\\n      <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''COMPLETED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.trigger\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n    </transition>\\n    \\n    <transition event=\\"dialog.started\\">\\n      <log expr=\\"''dialog.started -> ${internal.callId}''\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''dialog start''\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n\\n    </transition>\\n     \\n    <!-- Dialog exit -->\\n    <transition event=\\"dialog.exit\\">\\n      <log expr=\\"''dialog.exit -> ${internal.callId}''\\" />\\n      <disconnect />\\n    </transition>\\n\\n    <!-- ERROR!! -->\\n    <transition event=\\"error.*\\" >\\n      <log expr=\\"''Error[CFL]: ('' + event${d}.reason + '')''\\"/>\\n      <exit/>\\n    </transition>\\n\\n  </eventprocessor>\\n\\n</ccxml>"},"vxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<vxml version=\\"2.1\\">\\n\\n  ## Note: All over-rides below must be over-ridden in your flow, preferably your entry flow\\n\\n  ## Over-ride for a different timeout between user prompts\\n  #if (! $timeout) #set($timeout = 10) #end\\n\\n  ## Mandatorily over-ride this with the current caller''s locale based on how your application stores it\\n\\t#if (! $locale) #set($locale = \\"en\\") #end\\n\\n  ## over-ride this if you want to use a different skip character\\n  #if (! $skipChars) #set($skipChars = \\"*\\") #end\\n  \\n  #set($ext = \\".mp3\\")\\n\\n  ## Mandatorily over-ride this with the new flow name that you want to skip to if the skipChars is pressed\\n  #if ($internal.callDirection == \\"OUTGOING\\" && $skipFlow && $skipFlow != \\"\\")\\n\\t<link event=\\"SkipEvent\\">\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"skipRule\\" mode=\\"dtmf\\">\\n\\t\\t\\t<rule id=\\"skipRule\\" scope=\\"public\\">\\n\\t\\t\\t\\t<item>${skipChars}</item>\\n\\t\\t\\t</rule>\\n\\t\\t</grammar>\\n\\t</link>\\n\\n\\t<catch event=\\"SkipEvent\\">\\n\\t\\t<submit next=\\"${internal.nextURL}?jumpTo=${skipFlow}\\" />\\n\\t</catch>\\n  #end\\n\\n\\n<form>\\n\\t<var name=\\"gNoInputEventCount\\" expr=\\"0\\" />\\n\\t<var name=\\"gNoMatchEventCount\\" expr=\\"0\\" />\\n\\t<block>\\n\\t\\t<prompt bargein=\\"true\\" bargeintype=\\"hotword\\">#set($voiceFileName = \\"ByeBye\\")\\n</prompt>\\n\\t\\t<prompt bargein=\\"false\\">\\n\\t\\t\\t<audio src=\\"http://cflinstalltest.cloudapp.net/audio/openmrs/$locale/$voiceFileName$ext\\" />\\n\\t\\t</prompt>\\n\\t</block>\\n\\t<field name=\\"finishedHearing\\"><property name=\\"timeout\\" value=\\"0.1s\\" />\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"finishedRule\\" mode=\\"dtmf\\"><rule id=\\"finishedRule\\" scope=\\"public\\"><item>@</item></rule></grammar>\\n\\t\\t<nomatch />\\n\\t\\t<noinput count=\\"1\\"><goto nextitem=\\"submit\\" /></noinput>\\n\\t</field>\\n\\t<block name=\\"submit\\">\\n\\t\\t<goto next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t</block>\\n</form>\\n</vxml>"}},"blocks":[{"name":"Form","type":"form","elements":[{"name":"Txt","type":"txt","txt":"#set($voiceFileName = \\"ByeBye\\")\\n`$voiceFileName`"}]}],"step":"goodbye","continueNode":true},{"nodeType":"system","templates":{"velocity":{"content":"#set($params.playedMessages = $voiceFileName)\\n|exit|","dirty":false}},"step":"goodbye-handler"},{"nodeType":"user","templates":{"ccxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<ccxml version=\\"1.0\\" xmlns:voxeo=\\"http://community.voxeo.com/xmlns/ccxml\\">\\n\\n\\t#set($d = \\"$\\")\\n  <var name=\\"callTimeout\\" expr=\\"''60s''\\" />\\n  <var name=\\"state\\" expr=\\"''init''\\"/>\\n\\n  <!-- OUTGOING, INCOMING -->\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"statusURL\\" expr=\\"''${internal.baseURL}/callflows/status/${internal.callId}''\\" />\\n  <var name=\\"connectionId\\" expr=\\"''outboundID''\\" />\\n  <var name=\\"callId\\" expr=\\"''${internal.callId}''\\" />\\n  <var name=\\"jumpTo\\" expr=\\"''${internal.jumpTo}''\\" />\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"callStatus\\" />\\n\\n  <log expr=\\"''startupmode = '' + session.startupmode\\"/>\\n \\n  <eventprocessor>\\n\\n    <!-- CCXML Loaded -->\\n    <transition event=\\"ccxml.loaded\\">\\n      <log expr=\\"''ccxml loaded''\\" />\\n      <if cond=\\"session.startupmode === ''external''\\">\\n        <!-- tel:xxxx, sip:xxx@h:p sip:user@127.0.0.1:5070  -->\\n        <createcall dest=\\"''tel:+'' + ''${phone}''\\" callerid=\\"''${phone}''\\" connectionid=\\"connectionId\\" timeout=\\"callTimeout\\"/>\\n      </if>\\n    </transition>\\n   \\n    <!-- Process the incoming call --> \\n    <transition event=\\"connection.alerting\\">\\n      <log expr=\\"''connection.alerting''\\" />\\n      <accept/>     \\n    </transition>\\n      \\n    <transition event=\\"connection.failed\\">\\n      <var name=\\"eventReason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>      \\n\\n    </transition>\\n\\n    <!-- Call has been answered.--> \\n    <transition event=\\"connection.connected\\">\\n      <log expr=\\"''connection.connected -> ${internal.callId}''\\" />\\n\\t\\t\\t\\t<dialogstart src=\\"''${internal.baseURL}/callflows/in/voxeo/flows/MainFlow.vxml''\\" namelist=\\"session.id application.callerId callId  #if($internal.callDirection == ''OUTGOING'') jumpTo #end\\" />\\n      <var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''connected''\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <var name=\\"externalId\\" expr=\\"session.id\\" />\\n      <var name=\\"externalType\\" expr=\\"''voxeoSessionId''\\" />\\n      <send data=\\"''callMaxTimeReached''\\" target=\\"session.id\\" delay=\\"''600s''\\" />\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason externalId externalType timestamp\\"/>      \\n    </transition>\\n    \\n    <transition event=\\"callMaxTimeReached\\">\\n      <if cond=\\"callStatus == ''IN_PROGRESS''\\">\\n        <log expr=\\"''-- Max Call Time Reached / Disconnecting Call --''\\" />\\n        <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n        <var name=\\"reason\\" expr=\\"''Max time reached''\\" />\\n        <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n        <log expr=\\"''status='' + status + ''; reason = '' + reason\\" />   \\n        <send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>  \\n        <disconnect/>  \\n      </if>\\n\\t\\t</transition>  \\n\\n    <!-- Caller hung up.  -->\\n    <transition event=\\"connection.disconnected\\">\\n      <log expr=\\"''connection.disconnected -> ${internal.callId}''\\" />\\n      <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''COMPLETED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.trigger\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n    </transition>\\n    \\n    <transition event=\\"dialog.started\\">\\n      <log expr=\\"''dialog.started -> ${internal.callId}''\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''dialog start''\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n\\n    </transition>\\n     \\n    <!-- Dialog exit -->\\n    <transition event=\\"dialog.exit\\">\\n      <log expr=\\"''dialog.exit -> ${internal.callId}''\\" />\\n      <disconnect />\\n    </transition>\\n\\n    <!-- ERROR!! -->\\n    <transition event=\\"error.*\\" >\\n      <log expr=\\"''Error[CFL]: ('' + event${d}.reason + '')''\\"/>\\n      <exit/>\\n    </transition>\\n\\n  </eventprocessor>\\n\\n</ccxml>"},"vxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<vxml version=\\"2.1\\">\\n\\n  ## Note: All over-rides below must be over-ridden in your flow, preferably your entry flow\\n\\n  ## Over-ride for a different timeout between user prompts\\n  #if (! $timeout) #set($timeout = 10) #end\\n\\n  ## Mandatorily over-ride this with the current caller''s locale based on how your application stores it\\n\\t#if (! $locale) #set($locale = \\"en\\") #end\\n\\n  ## over-ride this if you want to use a different skip character\\n  #if (! $skipChars) #set($skipChars = \\"*\\") #end\\n  \\n  #set($ext = \\".mp3\\")\\n\\n  ## Mandatorily over-ride this with the new flow name that you want to skip to if the skipChars is pressed\\n  #if ($internal.callDirection == \\"OUTGOING\\" && $skipFlow && $skipFlow != \\"\\")\\n\\t<link event=\\"SkipEvent\\">\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"skipRule\\" mode=\\"dtmf\\">\\n\\t\\t\\t<rule id=\\"skipRule\\" scope=\\"public\\">\\n\\t\\t\\t\\t<item>${skipChars}</item>\\n\\t\\t\\t</rule>\\n\\t\\t</grammar>\\n\\t</link>\\n\\n\\t<catch event=\\"SkipEvent\\">\\n\\t\\t<submit next=\\"${internal.nextURL}?jumpTo=${skipFlow}\\" />\\n\\t</catch>\\n  #end\\n\\n\\n<form>\\n\\t<var name=\\"gNoInputEventCount\\" expr=\\"0\\" />\\n\\t<var name=\\"gNoMatchEventCount\\" expr=\\"0\\" />\\n\\t<block>\\n\\t\\t<prompt bargein=\\"true\\" bargeintype=\\"hotword\\">We do not have any record with your phone number.</prompt>\\n\\t</block>\\n\\t<field name=\\"finishedHearing\\"><property name=\\"timeout\\" value=\\"0.1s\\" />\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"finishedRule\\" mode=\\"dtmf\\"><rule id=\\"finishedRule\\" scope=\\"public\\"><item>@</item></rule></grammar>\\n\\t\\t<nomatch />\\n\\t\\t<noinput count=\\"1\\"><goto nextitem=\\"submit\\" /></noinput>\\n\\t</field>\\n\\t<block name=\\"submit\\">\\n\\t\\t<goto next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t</block>\\n</form>\\n</vxml>"}},"blocks":[{"name":"Form","type":"form","elements":[{"name":"Txt","type":"txt","txt":"We do not have any record with your phone number."}]}],"step":"person-not-found","continueNode":true},{"nodeType":"system","templates":{"velocity":{"content":"|exit|","dirty":false}},"step":"person-not-found-handler"},{"nodeType":"user","templates":{"ccxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<ccxml version=\\"1.0\\" xmlns:voxeo=\\"http://community.voxeo.com/xmlns/ccxml\\">\\n\\n\\t#set($d = \\"$\\")\\n  <var name=\\"callTimeout\\" expr=\\"''60s''\\" />\\n  <var name=\\"state\\" expr=\\"''init''\\"/>\\n\\n  <!-- OUTGOING, INCOMING -->\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"statusURL\\" expr=\\"''${internal.baseURL}/callflows/status/${internal.callId}''\\" />\\n  <var name=\\"connectionId\\" expr=\\"''outboundID''\\" />\\n  <var name=\\"callId\\" expr=\\"''${internal.callId}''\\" />\\n  <var name=\\"jumpTo\\" expr=\\"''${internal.jumpTo}''\\" />\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"callStatus\\" />\\n\\n  <log expr=\\"''startupmode = '' + session.startupmode\\"/>\\n \\n  <eventprocessor>\\n\\n    <!-- CCXML Loaded -->\\n    <transition event=\\"ccxml.loaded\\">\\n      <log expr=\\"''ccxml loaded''\\" />\\n      <if cond=\\"session.startupmode === ''external''\\">\\n        <!-- tel:xxxx, sip:xxx@h:p sip:user@127.0.0.1:5070  -->\\n        <createcall dest=\\"''tel:+'' + ''${phone}''\\" callerid=\\"''${phone}''\\" connectionid=\\"connectionId\\" timeout=\\"callTimeout\\"/>\\n      </if>\\n    </transition>\\n   \\n    <!-- Process the incoming call --> \\n    <transition event=\\"connection.alerting\\">\\n      <log expr=\\"''connection.alerting''\\" />\\n      <accept/>     \\n    </transition>\\n      \\n    <transition event=\\"connection.failed\\">\\n      <var name=\\"eventReason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>      \\n\\n    </transition>\\n\\n    <!-- Call has been answered.--> \\n    <transition event=\\"connection.connected\\">\\n      <log expr=\\"''connection.connected -> ${internal.callId}''\\" />\\n\\t\\t\\t\\t<dialogstart src=\\"''${internal.baseURL}/callflows/in/voxeo/flows/MainFlow.vxml''\\" namelist=\\"session.id application.callerId callId  #if($internal.callDirection == ''OUTGOING'') jumpTo #end\\" />\\n      <var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''connected''\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <var name=\\"externalId\\" expr=\\"session.id\\" />\\n      <var name=\\"externalType\\" expr=\\"''voxeoSessionId''\\" />\\n      <send data=\\"''callMaxTimeReached''\\" target=\\"session.id\\" delay=\\"''600s''\\" />\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason externalId externalType timestamp\\"/>      \\n    </transition>\\n    \\n    <transition event=\\"callMaxTimeReached\\">\\n      <if cond=\\"callStatus == ''IN_PROGRESS''\\">\\n        <log expr=\\"''-- Max Call Time Reached / Disconnecting Call --''\\" />\\n        <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n        <var name=\\"reason\\" expr=\\"''Max time reached''\\" />\\n        <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n        <log expr=\\"''status='' + status + ''; reason = '' + reason\\" />   \\n        <send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>  \\n        <disconnect/>  \\n      </if>\\n\\t\\t</transition>  \\n\\n    <!-- Caller hung up.  -->\\n    <transition event=\\"connection.disconnected\\">\\n      <log expr=\\"''connection.disconnected -> ${internal.callId}''\\" />\\n      <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''COMPLETED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.trigger\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n    </transition>\\n    \\n    <transition event=\\"dialog.started\\">\\n      <log expr=\\"''dialog.started -> ${internal.callId}''\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''dialog start''\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n\\n    </transition>\\n     \\n    <!-- Dialog exit -->\\n    <transition event=\\"dialog.exit\\">\\n      <log expr=\\"''dialog.exit -> ${internal.callId}''\\" />\\n      <disconnect />\\n    </transition>\\n\\n    <!-- ERROR!! -->\\n    <transition event=\\"error.*\\" >\\n      <log expr=\\"''Error[CFL]: ('' + event${d}.reason + '')''\\"/>\\n      <exit/>\\n    </transition>\\n\\n  </eventprocessor>\\n\\n</ccxml>"},"vxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<vxml version=\\"2.1\\">\\n\\n  ## Note: All over-rides below must be over-ridden in your flow, preferably your entry flow\\n\\n  ## Over-ride for a different timeout between user prompts\\n  #if (! $timeout) #set($timeout = 10) #end\\n\\n  ## Mandatorily over-ride this with the current caller''s locale based on how your application stores it\\n\\t#if (! $locale) #set($locale = \\"en\\") #end\\n\\n  ## over-ride this if you want to use a different skip character\\n  #if (! $skipChars) #set($skipChars = \\"*\\") #end\\n  \\n  #set($ext = \\".mp3\\")\\n\\n  ## Mandatorily over-ride this with the new flow name that you want to skip to if the skipChars is pressed\\n  #if ($internal.callDirection == \\"OUTGOING\\" && $skipFlow && $skipFlow != \\"\\")\\n\\t<link event=\\"SkipEvent\\">\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"skipRule\\" mode=\\"dtmf\\">\\n\\t\\t\\t<rule id=\\"skipRule\\" scope=\\"public\\">\\n\\t\\t\\t\\t<item>${skipChars}</item>\\n\\t\\t\\t</rule>\\n\\t\\t</grammar>\\n\\t</link>\\n\\n\\t<catch event=\\"SkipEvent\\">\\n\\t\\t<submit next=\\"${internal.nextURL}?jumpTo=${skipFlow}\\" />\\n\\t</catch>\\n  #end\\n\\n\\n<form>\\n\\t<var name=\\"gNoInputEventCount\\" expr=\\"0\\" />\\n\\t<var name=\\"gNoMatchEventCount\\" expr=\\"0\\" />\\n\\t<block>\\n\\t\\t<prompt bargein=\\"true\\" bargeintype=\\"hotword\\">#set($voiceFileName = \\"Deactivated Message\\")\\n</prompt>\\n\\t\\t<prompt bargein=\\"false\\">\\n\\t\\t\\t<audio src=\\"http://cflinstalltest.cloudapp.net/audio/openmrs/$locale/$voiceFileName$ext\\" />\\n\\t\\t</prompt>\\n\\t</block>\\n\\t<field name=\\"finishedHearing\\"><property name=\\"timeout\\" value=\\"0.1s\\" />\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"finishedRule\\" mode=\\"dtmf\\"><rule id=\\"finishedRule\\" scope=\\"public\\"><item>@</item></rule></grammar>\\n\\t\\t<nomatch />\\n\\t\\t<noinput count=\\"1\\"><goto nextitem=\\"submit\\" /></noinput>\\n\\t</field>\\n\\t<block name=\\"submit\\">\\n\\t\\t<goto next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t</block>\\n</form>\\n</vxml>"}},"blocks":[{"name":"Form","type":"form","elements":[{"name":"Txt","type":"txt","txt":"#set($voiceFileName = \\"Deactivated Message\\")\\n`$voiceFileName`"}]}],"step":"deactivated","continueNode":true},{"nodeType":"system","templates":{"velocity":{"content":"#set($params.playedMessages = $voiceFileName)\\n|exit|","dirty":false}},"step":"deactivated-handler"},{"nodeType":"user","templates":{"ccxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<ccxml version=\\"1.0\\" xmlns:voxeo=\\"http://community.voxeo.com/xmlns/ccxml\\">\\n\\n\\t#set($d = \\"$\\")\\n  <var name=\\"callTimeout\\" expr=\\"''60s''\\" />\\n  <var name=\\"state\\" expr=\\"''init''\\"/>\\n\\n  <!-- OUTGOING, INCOMING -->\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"statusURL\\" expr=\\"''${internal.baseURL}/callflows/status/${internal.callId}''\\" />\\n  <var name=\\"connectionId\\" expr=\\"''outboundID''\\" />\\n  <var name=\\"callId\\" expr=\\"''${internal.callId}''\\" />\\n  <var name=\\"jumpTo\\" expr=\\"''${internal.jumpTo}''\\" />\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"callStatus\\" />\\n\\n  <log expr=\\"''startupmode = '' + session.startupmode\\"/>\\n \\n  <eventprocessor>\\n\\n    <!-- CCXML Loaded -->\\n    <transition event=\\"ccxml.loaded\\">\\n      <log expr=\\"''ccxml loaded''\\" />\\n      <if cond=\\"session.startupmode === ''external''\\">\\n        <!-- tel:xxxx, sip:xxx@h:p sip:user@127.0.0.1:5070  -->\\n        <createcall dest=\\"''tel:+'' + ''${phone}''\\" callerid=\\"''${phone}''\\" connectionid=\\"connectionId\\" timeout=\\"callTimeout\\"/>\\n      </if>\\n    </transition>\\n   \\n    <!-- Process the incoming call --> \\n    <transition event=\\"connection.alerting\\">\\n      <log expr=\\"''connection.alerting''\\" />\\n      <accept/>     \\n    </transition>\\n      \\n    <transition event=\\"connection.failed\\">\\n      <var name=\\"eventReason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>      \\n\\n    </transition>\\n\\n    <!-- Call has been answered.--> \\n    <transition event=\\"connection.connected\\">\\n      <log expr=\\"''connection.connected -> ${internal.callId}''\\" />\\n\\t\\t\\t\\t<dialogstart src=\\"''${internal.baseURL}/callflows/in/voxeo/flows/MainFlow.vxml''\\" namelist=\\"session.id application.callerId callId  #if($internal.callDirection == ''OUTGOING'') jumpTo #end\\" />\\n      <var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''connected''\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <var name=\\"externalId\\" expr=\\"session.id\\" />\\n      <var name=\\"externalType\\" expr=\\"''voxeoSessionId''\\" />\\n      <send data=\\"''callMaxTimeReached''\\" target=\\"session.id\\" delay=\\"''600s''\\" />\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason externalId externalType timestamp\\"/>      \\n    </transition>\\n    \\n    <transition event=\\"callMaxTimeReached\\">\\n      <if cond=\\"callStatus == ''IN_PROGRESS''\\">\\n        <log expr=\\"''-- Max Call Time Reached / Disconnecting Call --''\\" />\\n        <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n        <var name=\\"reason\\" expr=\\"''Max time reached''\\" />\\n        <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n        <log expr=\\"''status='' + status + ''; reason = '' + reason\\" />   \\n        <send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>  \\n        <disconnect/>  \\n      </if>\\n\\t\\t</transition>  \\n\\n    <!-- Caller hung up.  -->\\n    <transition event=\\"connection.disconnected\\">\\n      <log expr=\\"''connection.disconnected -> ${internal.callId}''\\" />\\n      <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''COMPLETED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.trigger\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n    </transition>\\n    \\n    <transition event=\\"dialog.started\\">\\n      <log expr=\\"''dialog.started -> ${internal.callId}''\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''dialog start''\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n\\n    </transition>\\n     \\n    <!-- Dialog exit -->\\n    <transition event=\\"dialog.exit\\">\\n      <log expr=\\"''dialog.exit -> ${internal.callId}''\\" />\\n      <disconnect />\\n    </transition>\\n\\n    <!-- ERROR!! -->\\n    <transition event=\\"error.*\\" >\\n      <log expr=\\"''Error[CFL]: ('' + event${d}.reason + '')''\\"/>\\n      <exit/>\\n    </transition>\\n\\n  </eventprocessor>\\n\\n</ccxml>"},"vxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<vxml version=\\"2.1\\">\\n\\n  ## Note: All over-rides below must be over-ridden in your flow, preferably your entry flow\\n\\n  ## Over-ride for a different timeout between user prompts\\n  #if (! $timeout) #set($timeout = 10) #end\\n\\n  ## Mandatorily over-ride this with the current caller''s locale based on how your application stores it\\n\\t#if (! $locale) #set($locale = \\"en\\") #end\\n\\n  ## over-ride this if you want to use a different skip character\\n  #if (! $skipChars) #set($skipChars = \\"*\\") #end\\n  \\n  #set($ext = \\".mp3\\")\\n\\n  ## Mandatorily over-ride this with the new flow name that you want to skip to if the skipChars is pressed\\n  #if ($internal.callDirection == \\"OUTGOING\\" && $skipFlow && $skipFlow != \\"\\")\\n\\t<link event=\\"SkipEvent\\">\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"skipRule\\" mode=\\"dtmf\\">\\n\\t\\t\\t<rule id=\\"skipRule\\" scope=\\"public\\">\\n\\t\\t\\t\\t<item>${skipChars}</item>\\n\\t\\t\\t</rule>\\n\\t\\t</grammar>\\n\\t</link>\\n\\n\\t<catch event=\\"SkipEvent\\">\\n\\t\\t<submit next=\\"${internal.nextURL}?jumpTo=${skipFlow}\\" />\\n\\t</catch>\\n  #end\\n\\n\\n<form>\\n\\t<var name=\\"gNoInputEventCount\\" expr=\\"0\\" />\\n\\t<var name=\\"gNoMatchEventCount\\" expr=\\"0\\" />\\n\\t<block>\\n\\t\\t<prompt bargein=\\"true\\" bargeintype=\\"hotword\\">#set($voiceFileName = \\"theme_music_long\\")\\n</prompt>\\n\\t\\t<prompt bargein=\\"false\\">\\n\\t\\t\\t<audio src=\\"http://cflinstalltest.cloudapp.net/audio/openmrs/$locale/$voiceFileName$ext\\" />\\n\\t\\t</prompt>\\n\\t</block>\\n\\t<field name=\\"finishedHearing\\"><property name=\\"timeout\\" value=\\"0.1s\\" />\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"finishedRule\\" mode=\\"dtmf\\"><rule id=\\"finishedRule\\" scope=\\"public\\"><item>@</item></rule></grammar>\\n\\t\\t<nomatch />\\n\\t\\t<noinput count=\\"1\\"><goto nextitem=\\"submit\\" /></noinput>\\n\\t</field>\\n\\t<block name=\\"submit\\">\\n\\t\\t<goto next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t</block>\\n</form>\\n</vxml>"}},"blocks":[{"name":"Form","type":"form","elements":[{"name":"Txt","type":"txt","txt":"#set($voiceFileName = \\"theme_music_long\\")\\n`$voiceFileName`"}]}],"step":"invalid-person","continueNode":true},{"nodeType":"system","templates":{"velocity":{"content":"#set($params.playedMessages = $voiceFileName)\\n|exit|","dirty":false}},"step":"invalid-person-handler"},{"nodeType":"user","templates":{"ccxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<ccxml version=\\"1.0\\" xmlns:voxeo=\\"http://community.voxeo.com/xmlns/ccxml\\">\\n\\n\\t#set($d = \\"$\\")\\n  <var name=\\"callTimeout\\" expr=\\"''60s''\\" />\\n  <var name=\\"state\\" expr=\\"''init''\\"/>\\n\\n  <!-- OUTGOING, INCOMING -->\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"statusURL\\" expr=\\"''${internal.baseURL}/callflows/status/${internal.callId}''\\" />\\n  <var name=\\"connectionId\\" expr=\\"''outboundID''\\" />\\n  <var name=\\"callId\\" expr=\\"''${internal.callId}''\\" />\\n  <var name=\\"jumpTo\\" expr=\\"''${internal.jumpTo}''\\" />\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"callStatus\\" />\\n\\n  <log expr=\\"''startupmode = '' + session.startupmode\\"/>\\n \\n  <eventprocessor>\\n\\n    <!-- CCXML Loaded -->\\n    <transition event=\\"ccxml.loaded\\">\\n      <log expr=\\"''ccxml loaded''\\" />\\n      <if cond=\\"session.startupmode === ''external''\\">\\n        <!-- tel:xxxx, sip:xxx@h:p sip:user@127.0.0.1:5070  -->\\n        <createcall dest=\\"''tel:+'' + ''${phone}''\\" callerid=\\"''${phone}''\\" connectionid=\\"connectionId\\" timeout=\\"callTimeout\\"/>\\n      </if>\\n    </transition>\\n   \\n    <!-- Process the incoming call --> \\n    <transition event=\\"connection.alerting\\">\\n      <log expr=\\"''connection.alerting''\\" />\\n      <accept/>     \\n    </transition>\\n      \\n    <transition event=\\"connection.failed\\">\\n      <var name=\\"eventReason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>      \\n\\n    </transition>\\n\\n    <!-- Call has been answered.--> \\n    <transition event=\\"connection.connected\\">\\n      <log expr=\\"''connection.connected -> ${internal.callId}''\\" />\\n\\t\\t\\t\\t<dialogstart src=\\"''${internal.baseURL}/callflows/in/voxeo/flows/MainFlow.vxml''\\" namelist=\\"session.id application.callerId callId  #if($internal.callDirection == ''OUTGOING'') jumpTo #end\\" />\\n      <var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''connected''\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <var name=\\"externalId\\" expr=\\"session.id\\" />\\n      <var name=\\"externalType\\" expr=\\"''voxeoSessionId''\\" />\\n      <send data=\\"''callMaxTimeReached''\\" target=\\"session.id\\" delay=\\"''600s''\\" />\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason externalId externalType timestamp\\"/>      \\n    </transition>\\n    \\n    <transition event=\\"callMaxTimeReached\\">\\n      <if cond=\\"callStatus == ''IN_PROGRESS''\\">\\n        <log expr=\\"''-- Max Call Time Reached / Disconnecting Call --''\\" />\\n        <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n        <var name=\\"reason\\" expr=\\"''Max time reached''\\" />\\n        <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n        <log expr=\\"''status='' + status + ''; reason = '' + reason\\" />   \\n        <send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>  \\n        <disconnect/>  \\n      </if>\\n\\t\\t</transition>  \\n\\n    <!-- Caller hung up.  -->\\n    <transition event=\\"connection.disconnected\\">\\n      <log expr=\\"''connection.disconnected -> ${internal.callId}''\\" />\\n      <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''COMPLETED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.trigger\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n    </transition>\\n    \\n    <transition event=\\"dialog.started\\">\\n      <log expr=\\"''dialog.started -> ${internal.callId}''\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''dialog start''\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n\\n    </transition>\\n     \\n    <!-- Dialog exit -->\\n    <transition event=\\"dialog.exit\\">\\n      <log expr=\\"''dialog.exit -> ${internal.callId}''\\" />\\n      <disconnect />\\n    </transition>\\n\\n    <!-- ERROR!! -->\\n    <transition event=\\"error.*\\" >\\n      <log expr=\\"''Error[CFL]: ('' + event${d}.reason + '')''\\"/>\\n      <exit/>\\n    </transition>\\n\\n  </eventprocessor>\\n\\n</ccxml>"},"vxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<vxml version=\\"2.1\\">\\n\\n  ## Note: All over-rides below must be over-ridden in your flow, preferably your entry flow\\n\\n  ## Over-ride for a different timeout between user prompts\\n  #if (! $timeout) #set($timeout = 10) #end\\n\\n  ## Mandatorily over-ride this with the current caller''s locale based on how your application stores it\\n\\t#if (! $locale) #set($locale = \\"en\\") #end\\n\\n  ## over-ride this if you want to use a different skip character\\n  #if (! $skipChars) #set($skipChars = \\"*\\") #end\\n  \\n  #set($ext = \\".mp3\\")\\n\\n  ## Mandatorily over-ride this with the new flow name that you want to skip to if the skipChars is pressed\\n  #if ($internal.callDirection == \\"OUTGOING\\" && $skipFlow && $skipFlow != \\"\\")\\n\\t<link event=\\"SkipEvent\\">\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"skipRule\\" mode=\\"dtmf\\">\\n\\t\\t\\t<rule id=\\"skipRule\\" scope=\\"public\\">\\n\\t\\t\\t\\t<item>${skipChars}</item>\\n\\t\\t\\t</rule>\\n\\t\\t</grammar>\\n\\t</link>\\n\\n\\t<catch event=\\"SkipEvent\\">\\n\\t\\t<submit next=\\"${internal.nextURL}?jumpTo=${skipFlow}\\" />\\n\\t</catch>\\n  #end\\n\\n\\n<form>\\n\\t<var name=\\"gNoInputEventCount\\" expr=\\"0\\" />\\n\\t<var name=\\"gNoMatchEventCount\\" expr=\\"0\\" />\\n\\t<block>\\n\\t\\t<prompt bargein=\\"true\\" bargeintype=\\"hotword\\">#set($voiceFileName = \\"Greeting\\")\\n</prompt>\\n\\t\\t<prompt bargein=\\"false\\">\\n\\t\\t\\t<audio src=\\"http://cflinstalltest.cloudapp.net/audio/openmrs/$locale/$voiceFileName$ext\\" />\\n\\t\\t</prompt>\\n\\t</block>\\n\\t<field name=\\"finishedHearing\\"><property name=\\"timeout\\" value=\\"0.1s\\" />\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"finishedRule\\" mode=\\"dtmf\\"><rule id=\\"finishedRule\\" scope=\\"public\\"><item>@</item></rule></grammar>\\n\\t\\t<nomatch />\\n\\t\\t<noinput count=\\"1\\"><goto nextitem=\\"submit\\" /></noinput>\\n\\t</field>\\n\\t<block name=\\"submit\\">\\n\\t\\t<goto next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t</block>\\n</form>\\n</vxml>"}},"blocks":[{"name":"Form","type":"form","elements":[{"name":"Txt","type":"txt","txt":"#set($voiceFileName = \\"Greeting\\")\\n`$voiceFileName`"}]}],"step":"active","continueNode":true},{"nodeType":"system","templates":{"velocity":{"content":"#set($params.playedMessages = $voiceFileName)\\n#if($internal.callDirection == \\"OUTGOING\\")\\n\\t|OutgoingFlow.|\\n#else\\n\\t|IncomingFlow.|\\n#end","dirty":false}},"step":"active-handler"},{"nodeType":"user","templates":{"ccxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<ccxml version=\\"1.0\\" xmlns:voxeo=\\"http://community.voxeo.com/xmlns/ccxml\\">\\n\\n\\t#set($d = \\"$\\")\\n  <var name=\\"callTimeout\\" expr=\\"''60s''\\" />\\n  <var name=\\"state\\" expr=\\"''init''\\"/>\\n\\n  <!-- OUTGOING, INCOMING -->\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"statusURL\\" expr=\\"''${internal.baseURL}/callflows/status/${internal.callId}''\\" />\\n  <var name=\\"connectionId\\" expr=\\"''outboundID''\\" />\\n  <var name=\\"callId\\" expr=\\"''${internal.callId}''\\" />\\n  <var name=\\"jumpTo\\" expr=\\"''${internal.jumpTo}''\\" />\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"callStatus\\" />\\n\\n  <log expr=\\"''startupmode = '' + session.startupmode\\"/>\\n \\n  <eventprocessor>\\n\\n    <!-- CCXML Loaded -->\\n    <transition event=\\"ccxml.loaded\\">\\n      <log expr=\\"''ccxml loaded''\\" />\\n      <if cond=\\"session.startupmode === ''external''\\">\\n        <!-- tel:xxxx, sip:xxx@h:p sip:user@127.0.0.1:5070  -->\\n        <createcall dest=\\"''tel:+'' + ''${phone}''\\" callerid=\\"''${phone}''\\" connectionid=\\"connectionId\\" timeout=\\"callTimeout\\"/>\\n      </if>\\n    </transition>\\n   \\n    <!-- Process the incoming call --> \\n    <transition event=\\"connection.alerting\\">\\n      <log expr=\\"''connection.alerting''\\" />\\n      <accept/>     \\n    </transition>\\n      \\n    <transition event=\\"connection.failed\\">\\n      <var name=\\"eventReason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>      \\n\\n    </transition>\\n\\n    <!-- Call has been answered.--> \\n    <transition event=\\"connection.connected\\">\\n      <log expr=\\"''connection.connected -> ${internal.callId}''\\" />\\n\\t\\t\\t\\t<dialogstart src=\\"''${internal.baseURL}/callflows/in/voxeo/flows/MainFlow.vxml''\\" namelist=\\"session.id application.callerId callId  #if($internal.callDirection == ''OUTGOING'') jumpTo #end\\" />\\n      <var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''connected''\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <var name=\\"externalId\\" expr=\\"session.id\\" />\\n      <var name=\\"externalType\\" expr=\\"''voxeoSessionId''\\" />\\n      <send data=\\"''callMaxTimeReached''\\" target=\\"session.id\\" delay=\\"''600s''\\" />\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason externalId externalType timestamp\\"/>      \\n    </transition>\\n    \\n    <transition event=\\"callMaxTimeReached\\">\\n      <if cond=\\"callStatus == ''IN_PROGRESS''\\">\\n        <log expr=\\"''-- Max Call Time Reached / Disconnecting Call --''\\" />\\n        <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n        <var name=\\"reason\\" expr=\\"''Max time reached''\\" />\\n        <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n        <log expr=\\"''status='' + status + ''; reason = '' + reason\\" />   \\n        <send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>  \\n        <disconnect/>  \\n      </if>\\n\\t\\t</transition>  \\n\\n    <!-- Caller hung up.  -->\\n    <transition event=\\"connection.disconnected\\">\\n      <log expr=\\"''connection.disconnected -> ${internal.callId}''\\" />\\n      <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''COMPLETED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.trigger\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n    </transition>\\n    \\n    <transition event=\\"dialog.started\\">\\n      <log expr=\\"''dialog.started -> ${internal.callId}''\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''dialog start''\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n\\n    </transition>\\n     \\n    <!-- Dialog exit -->\\n    <transition event=\\"dialog.exit\\">\\n      <log expr=\\"''dialog.exit -> ${internal.callId}''\\" />\\n      <disconnect />\\n    </transition>\\n\\n    <!-- ERROR!! -->\\n    <transition event=\\"error.*\\" >\\n      <log expr=\\"''Error[CFL]: ('' + event${d}.reason + '')''\\"/>\\n      <exit/>\\n    </transition>\\n\\n  </eventprocessor>\\n\\n</ccxml>"},"vxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<vxml version=\\"2.1\\">\\n\\n  ## Note: All over-rides below must be over-ridden in your flow, preferably your entry flow\\n\\n  ## Over-ride for a different timeout between user prompts\\n  #if (! $timeout) #set($timeout = 10) #end\\n\\n  ## Mandatorily over-ride this with the current caller''s locale based on how your application stores it\\n\\t#if (! $locale) #set($locale = \\"en\\") #end\\n\\n  ## over-ride this if you want to use a different skip character\\n  #if (! $skipChars) #set($skipChars = \\"*\\") #end\\n  \\n  #set($ext = \\".mp3\\")\\n\\n  ## Mandatorily over-ride this with the new flow name that you want to skip to if the skipChars is pressed\\n  #if ($internal.callDirection == \\"OUTGOING\\" && $skipFlow && $skipFlow != \\"\\")\\n\\t<link event=\\"SkipEvent\\">\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"skipRule\\" mode=\\"dtmf\\">\\n\\t\\t\\t<rule id=\\"skipRule\\" scope=\\"public\\">\\n\\t\\t\\t\\t<item>${skipChars}</item>\\n\\t\\t\\t</rule>\\n\\t\\t</grammar>\\n\\t</link>\\n\\n\\t<catch event=\\"SkipEvent\\">\\n\\t\\t<submit next=\\"${internal.nextURL}?jumpTo=${skipFlow}\\" />\\n\\t</catch>\\n  #end\\n\\n\\n<form>\\n\\t<var name=\\"gNoInputEventCount\\" expr=\\"0\\" />\\n\\t<var name=\\"gNoMatchEventCount\\" expr=\\"0\\" />\\n\\t<block>\\n\\t\\t<prompt bargein=\\"true\\" bargeintype=\\"hotword\\">#set($voiceFileName = \\"no_input_goodbye\\")\\n</prompt>\\n\\t\\t<prompt bargein=\\"false\\">\\n\\t\\t\\t<audio src=\\"http://cflinstalltest.cloudapp.net/audio/openmrs/$locale/$voiceFileName$ext\\" />\\n\\t\\t</prompt>\\n\\t</block>\\n\\t<field name=\\"finishedHearing\\"><property name=\\"timeout\\" value=\\"0.1s\\" />\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"finishedRule\\" mode=\\"dtmf\\"><rule id=\\"finishedRule\\" scope=\\"public\\"><item>@</item></rule></grammar>\\n\\t\\t<nomatch />\\n\\t\\t<noinput count=\\"1\\"><goto nextitem=\\"submit\\" /></noinput>\\n\\t</field>\\n\\t<block name=\\"submit\\">\\n\\t\\t<goto next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t</block>\\n</form>\\n</vxml>"}},"blocks":[{"name":"Form","type":"form","elements":[{"name":"Txt","type":"txt","txt":"#set($voiceFileName = \\"no_input_goodbye\\")\\n`$voiceFileName`"}]}],"step":"no-input","continueNode":true},{"nodeType":"system","templates":{"velocity":{"content":"#set($params.playedMessages = $voiceFileName)\\n#set($noInputCount = 3)\\n|exit|","dirty":false}},"step":"no-input-handler"},{"nodeType":"user","templates":{"ccxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<ccxml version=\\"1.0\\" xmlns:voxeo=\\"http://community.voxeo.com/xmlns/ccxml\\">\\n\\n\\t#set($d = \\"$\\")\\n  <var name=\\"callTimeout\\" expr=\\"''60s''\\" />\\n  <var name=\\"state\\" expr=\\"''init''\\"/>\\n\\n  <!-- OUTGOING, INCOMING -->\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"statusURL\\" expr=\\"''${internal.baseURL}/callflows/status/${internal.callId}''\\" />\\n  <var name=\\"connectionId\\" expr=\\"''outboundID''\\" />\\n  <var name=\\"callId\\" expr=\\"''${internal.callId}''\\" />\\n  <var name=\\"jumpTo\\" expr=\\"''${internal.jumpTo}''\\" />\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"callStatus\\" />\\n\\n  <log expr=\\"''startupmode = '' + session.startupmode\\"/>\\n \\n  <eventprocessor>\\n\\n    <!-- CCXML Loaded -->\\n    <transition event=\\"ccxml.loaded\\">\\n      <log expr=\\"''ccxml loaded''\\" />\\n      <if cond=\\"session.startupmode === ''external''\\">\\n        <!-- tel:xxxx, sip:xxx@h:p sip:user@127.0.0.1:5070  -->\\n        <createcall dest=\\"''tel:+'' + ''${phone}''\\" callerid=\\"''${phone}''\\" connectionid=\\"connectionId\\" timeout=\\"callTimeout\\"/>\\n      </if>\\n    </transition>\\n   \\n    <!-- Process the incoming call --> \\n    <transition event=\\"connection.alerting\\">\\n      <log expr=\\"''connection.alerting''\\" />\\n      <accept/>     \\n    </transition>\\n      \\n    <transition event=\\"connection.failed\\">\\n      <var name=\\"eventReason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>      \\n\\n    </transition>\\n\\n    <!-- Call has been answered.--> \\n    <transition event=\\"connection.connected\\">\\n      <log expr=\\"''connection.connected -> ${internal.callId}''\\" />\\n\\t\\t\\t\\t<dialogstart src=\\"''${internal.baseURL}/callflows/in/voxeo/flows/MainFlow.vxml''\\" namelist=\\"session.id application.callerId callId  #if($internal.callDirection == ''OUTGOING'') jumpTo #end\\" />\\n      <var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''connected''\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <var name=\\"externalId\\" expr=\\"session.id\\" />\\n      <var name=\\"externalType\\" expr=\\"''voxeoSessionId''\\" />\\n      <send data=\\"''callMaxTimeReached''\\" target=\\"session.id\\" delay=\\"''600s''\\" />\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason externalId externalType timestamp\\"/>      \\n    </transition>\\n    \\n    <transition event=\\"callMaxTimeReached\\">\\n      <if cond=\\"callStatus == ''IN_PROGRESS''\\">\\n        <log expr=\\"''-- Max Call Time Reached / Disconnecting Call --''\\" />\\n        <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n        <var name=\\"reason\\" expr=\\"''Max time reached''\\" />\\n        <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n        <log expr=\\"''status='' + status + ''; reason = '' + reason\\" />   \\n        <send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>  \\n        <disconnect/>  \\n      </if>\\n\\t\\t</transition>  \\n\\n    <!-- Caller hung up.  -->\\n    <transition event=\\"connection.disconnected\\">\\n      <log expr=\\"''connection.disconnected -> ${internal.callId}''\\" />\\n      <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''COMPLETED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.trigger\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n    </transition>\\n    \\n    <transition event=\\"dialog.started\\">\\n      <log expr=\\"''dialog.started -> ${internal.callId}''\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''dialog start''\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n\\n    </transition>\\n     \\n    <!-- Dialog exit -->\\n    <transition event=\\"dialog.exit\\">\\n      <log expr=\\"''dialog.exit -> ${internal.callId}''\\" />\\n      <disconnect />\\n    </transition>\\n\\n    <!-- ERROR!! -->\\n    <transition event=\\"error.*\\" >\\n      <log expr=\\"''Error[CFL]: ('' + event${d}.reason + '')''\\"/>\\n      <exit/>\\n    </transition>\\n\\n  </eventprocessor>\\n\\n</ccxml>"},"vxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<vxml version=\\"2.1\\">\\n\\n  ## Note: All over-rides below must be over-ridden in your flow, preferably your entry flow\\n\\n  ## Over-ride for a different timeout between user prompts\\n  #if (! $timeout) #set($timeout = 10) #end\\n\\n  ## Mandatorily over-ride this with the current caller''s locale based on how your application stores it\\n\\t#if (! $locale) #set($locale = \\"en\\") #end\\n\\n  ## over-ride this if you want to use a different skip character\\n  #if (! $skipChars) #set($skipChars = \\"*\\") #end\\n  \\n  #set($ext = \\".mp3\\")\\n\\n  ## Mandatorily over-ride this with the new flow name that you want to skip to if the skipChars is pressed\\n  #if ($internal.callDirection == \\"OUTGOING\\" && $skipFlow && $skipFlow != \\"\\")\\n\\t<link event=\\"SkipEvent\\">\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"skipRule\\" mode=\\"dtmf\\">\\n\\t\\t\\t<rule id=\\"skipRule\\" scope=\\"public\\">\\n\\t\\t\\t\\t<item>${skipChars}</item>\\n\\t\\t\\t</rule>\\n\\t\\t</grammar>\\n\\t</link>\\n\\n\\t<catch event=\\"SkipEvent\\">\\n\\t\\t<submit next=\\"${internal.nextURL}?jumpTo=${skipFlow}\\" />\\n\\t</catch>\\n  #end\\n\\n\\n<form>\\n\\t<var name=\\"gNoInputEventCount\\" expr=\\"0\\" />\\n\\t<var name=\\"gNoMatchEventCount\\" expr=\\"0\\" />\\n\\t<block>\\n\\t\\t<prompt bargein=\\"true\\" bargeintype=\\"hotword\\">#if ($invalidCount < 2)\\n\\t#set($voiceFileName = \\"wrong_input\\")\\n#else\\n\\t#set($voiceFileName = \\"no_valid_input_goodbye\\")\\n#end\\n\\n</prompt>\\n\\t\\t<prompt bargein=\\"false\\">\\n\\t\\t\\t<audio src=\\"http://cflinstalltest.cloudapp.net/audio/openmrs/$locale/$voiceFileName$ext\\" />\\n\\t\\t</prompt>\\n\\t</block>\\n\\t<field name=\\"finishedHearing\\"><property name=\\"timeout\\" value=\\"0.1s\\" />\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"finishedRule\\" mode=\\"dtmf\\"><rule id=\\"finishedRule\\" scope=\\"public\\"><item>@</item></rule></grammar>\\n\\t\\t<nomatch />\\n\\t\\t<noinput count=\\"1\\"><goto nextitem=\\"submit\\" /></noinput>\\n\\t</field>\\n\\t<block name=\\"submit\\">\\n\\t\\t<goto next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t</block>\\n</form>\\n</vxml>"}},"blocks":[{"name":"Form","type":"form","elements":[{"name":"Txt","type":"txt","txt":"#if ($invalidCount < 2)\\n\\t#set($voiceFileName = \\"wrong_input\\")\\n#else\\n\\t#set($voiceFileName = \\"no_valid_input_goodbye\\")\\n#end\\n\\n`$voiceFileName`"}]}],"step":"invalid-input","continueNode":true},{"nodeType":"system","templates":{"velocity":{"content":"#set($params.playedMessages = $voiceFileName)\\n#if ($invalidCount < 2)\\n\\t#set($invalidCount = $invalidCount + 1)\\n\\t|$returnNode|\\n#else\\n\\t|exit|\\n#end","dirty":false}},"step":"invalid-input-handler"}],"name":"MainFlow"}','5846e404-8625-40bd-9e88-2f7ad2de9221',1,1,'2020-06-16 14:33:05','2019-12-17 19:34:22',NULL,NULL,0,NULL)
,('PinFlow',NULL,'DRAFT','{"nodes":[{"nodeType":"user","templates":{"ccxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<ccxml version=\\"1.0\\" xmlns:voxeo=\\"http://community.voxeo.com/xmlns/ccxml\\">\\n\\n\\t#set($d = \\"$\\")\\n  <var name=\\"callTimeout\\" expr=\\"''60s''\\" />\\n  <var name=\\"state\\" expr=\\"''init''\\"/>\\n\\n  <!-- OUTGOING, INCOMING -->\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"statusURL\\" expr=\\"''${internal.baseURL}/callflows/status/${internal.callId}''\\" />\\n  <var name=\\"connectionId\\" expr=\\"''outboundID''\\" />\\n  <var name=\\"callId\\" expr=\\"''${internal.callId}''\\" />\\n  <var name=\\"jumpTo\\" expr=\\"''${internal.jumpTo}''\\" />\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"callStatus\\" />\\n\\n  <log expr=\\"''startupmode = '' + session.startupmode\\"/>\\n \\n  <eventprocessor>\\n\\n    <!-- CCXML Loaded -->\\n    <transition event=\\"ccxml.loaded\\">\\n      <log expr=\\"''ccxml loaded''\\" />\\n      <if cond=\\"session.startupmode === ''external''\\">\\n        <!-- tel:xxxx, sip:xxx@h:p sip:user@127.0.0.1:5070  -->\\n        <createcall dest=\\"''tel:+'' + ''${phone}''\\" callerid=\\"''${phone}''\\" connectionid=\\"connectionId\\" timeout=\\"callTimeout\\"/>\\n      </if>\\n    </transition>\\n   \\n    <!-- Process the incoming call --> \\n    <transition event=\\"connection.alerting\\">\\n      <log expr=\\"''connection.alerting''\\" />\\n      <accept/>     \\n    </transition>\\n      \\n    <transition event=\\"connection.failed\\">\\n      <var name=\\"eventReason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>      \\n\\n    </transition>\\n\\n    <!-- Call has been answered.--> \\n    <transition event=\\"connection.connected\\">\\n      <log expr=\\"''connection.connected -> ${internal.callId}''\\" />\\n\\t\\t\\t\\t<dialogstart src=\\"''${internal.baseURL}/callflows/in/voxeo/flows/MainFlow.vxml''\\" namelist=\\"session.id application.callerId callId  #if($internal.callDirection == ''OUTGOING'') jumpTo #end\\" />\\n      <var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''connected''\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <var name=\\"externalId\\" expr=\\"session.id\\" />\\n      <var name=\\"externalType\\" expr=\\"''voxeoSessionId''\\" />\\n      <send data=\\"''callMaxTimeReached''\\" target=\\"session.id\\" delay=\\"''600s''\\" />\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason externalId externalType timestamp\\"/>      \\n    </transition>\\n    \\n    <transition event=\\"callMaxTimeReached\\">\\n      <if cond=\\"callStatus == ''IN_PROGRESS''\\">\\n        <log expr=\\"''-- Max Call Time Reached / Disconnecting Call --''\\" />\\n        <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n        <var name=\\"reason\\" expr=\\"''Max time reached''\\" />\\n        <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n        <log expr=\\"''status='' + status + ''; reason = '' + reason\\" />   \\n        <send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>  \\n        <disconnect/>  \\n      </if>\\n\\t\\t</transition>  \\n\\n    <!-- Caller hung up.  -->\\n    <transition event=\\"connection.disconnected\\">\\n      <log expr=\\"''connection.disconnected -> ${internal.callId}''\\" />\\n      <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''COMPLETED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.trigger\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n    </transition>\\n    \\n    <transition event=\\"dialog.started\\">\\n      <log expr=\\"''dialog.started -> ${internal.callId}''\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''dialog start''\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n\\n    </transition>\\n     \\n    <!-- Dialog exit -->\\n    <transition event=\\"dialog.exit\\">\\n      <log expr=\\"''dialog.exit -> ${internal.callId}''\\" />\\n      <disconnect />\\n    </transition>\\n\\n    <!-- ERROR!! -->\\n    <transition event=\\"error.*\\" >\\n      <log expr=\\"''Error[CFL]: ('' + event${d}.reason + '')''\\"/>\\n      <exit/>\\n    </transition>\\n\\n  </eventprocessor>\\n\\n</ccxml>"},"vxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<vxml version=\\"2.1\\">\\n\\n  ## Note: All over-rides below must be over-ridden in your flow, preferably your entry flow\\n\\n  ## Over-ride for a different timeout between user prompts\\n  #if (! $timeout) #set($timeout = 10) #end\\n\\n  ## Mandatorily over-ride this with the current caller''s locale based on how your application stores it\\n\\t#if (! $locale) #set($locale = \\"en\\") #end\\n\\n  ## over-ride this if you want to use a different skip character\\n  #if (! $skipChars) #set($skipChars = \\"*\\") #end\\n  \\n  #set($ext = \\".mp3\\")\\n\\n  ## Mandatorily over-ride this with the new flow name that you want to skip to if the skipChars is pressed\\n  #if ($internal.callDirection == \\"OUTGOING\\" && $skipFlow && $skipFlow != \\"\\")\\n\\t<link event=\\"SkipEvent\\">\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"skipRule\\" mode=\\"dtmf\\">\\n\\t\\t\\t<rule id=\\"skipRule\\" scope=\\"public\\">\\n\\t\\t\\t\\t<item>${skipChars}</item>\\n\\t\\t\\t</rule>\\n\\t\\t</grammar>\\n\\t</link>\\n\\n\\t<catch event=\\"SkipEvent\\">\\n\\t\\t<submit next=\\"${internal.nextURL}?jumpTo=${skipFlow}\\" />\\n\\t</catch>\\n  #end\\n\\n\\n<form>\\n\\t<var name=\\"gNoInputEventCount\\" expr=\\"0\\" />\\n\\t<var name=\\"gNoMatchEventCount\\" expr=\\"0\\" />\\n\\t<field name=\\"userInput\\" type=\\"digits?length=4\\">\\n\\t\\t<property name=\\"inputmodes\\" value=\\"dtmf\\" />\\n\\t\\t<prompt bargein=\\"true\\" timeout=\\"${timeout}s\\">#set($voiceFileName = \\"theme_music_shot\\")\\n</prompt>\\n\\t\\t<prompt bargein=\\"true\\" timeout=\\"${timeout}s\\">\\n\\t\\t\\t<audio src=\\"http://cflinstalltest.cloudapp.net/audio/openmrs/$locale/$voiceFileName$ext\\" />\\n\\t\\t</prompt>\\n\\t\\t<noinput count=\\"1\\">\\n\\t\\t<var name=\\"gNoInputEventCount\\" expr=\\"gNoInputEventCount+1\\" />\\n\\t\\t<submit namelist=\\"gNoInputEventCount gNoMatchEventCount\\" next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t\\t</noinput>\\n\\t\\t<nomatch count=\\"1\\">\\n\\t\\t<var name=\\"gNoMatchEventCount\\" expr=\\"gNoMatchEventCount+1\\" />\\n\\t\\t<submit namelist=\\"gNoInputEventCount gNoMatchEventCount\\" next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t\\t</nomatch>\\n\\t\\t<noinput><reprompt />\\n\\t\\t</noinput>\\n\\t\\t<nomatch><reprompt />\\n\\t\\t</nomatch>\\n\\t</field>\\n\\t<filled mode=\\"all\\">\\n\\t\\t<submit namelist=\\"userInput\\" next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t</filled>\\n</form>\\n</vxml>"}},"blocks":[{"name":"Form","type":"form","elements":[{"name":"userInput","type":"field","txt":"#set($voiceFileName = \\"theme_music_shot\\")\\n`$voiceFileName`","fieldType":"digits","noInput":"","noMatch":"","goodBye":"","bargeIn":true,"dtmf":true,"voice":false,"reprompt":"1","fieldMeta":"4"}]}],"step":"validate-pin","continueNode":true},{"nodeType":"system","templates":{"velocity":{"content":"#set($pinAttempts = $pinAttempts + 1)\\n::::::::::::$params.gNoInputEventCount\\n::::::::::::$params.gNoMatchEventCount\\n::::::::::::$pinAttempts\\n::::::::::::$maxPinAttempt\\n#if($internal.callDirection == ''INCOMING'')\\n\\t#set($actorId = $personId)\\n  #set($patientId = $personId)\\n#end\\n\\n#set($params.playedMessages = ''theme_music_long|'' + $params.userInput)\\n#if($params.userInput)\\n\\t#if ($params.userInput == ''1111'')\\n  \\t#set($params.playedMessages = $params.playedMessages + \\"|validPin\\")\\n    #set($dummy = $messagesService.registerResponse($actorId, $patientId, $callId, ''OTHER'', null, ''PIN'', null, ''VALID'', $DateUtil.now()))\\n    |MainFlow.main|\\n  #else\\n  \\t#set($params.playedMessages = $params.playedMessages + \\"|invalidPin\\")\\n    #set($dummy = $messagesService.registerResponse($actorId, $patientId, $callId, ''OTHER'', null, ''PIN'', null, ''INVALID'', $DateUtil.now()))\\n    #if($pinAttempts < $maxPinAttempt)\\n    \\t|validate-pin|\\n    #else\\n    \\t|MainFlow.no-input|\\n    #end\\n  #end\\n#else\\n\\t#if ($params.gNoInputEventCount == \\"1\\")\\n  \\t#set($params.playedMessages = $params.playedMessages + \\"|noinput\\")\\n    #set ($shouldDisconnect = true)\\n  #elseif ($params.gNoMatchEventCount == \\"1\\")\\n \\t\\t#set($params.playedMessages = $params.playedMessages + \\"|noMatch\\")\\n  #end\\n\\t#if ($shouldDisconnect || ($pinAttempts >= $maxPinAttempt))\\n  \\t|MainFlow.no-input|\\n\\t#else\\n  \\t|validate-pin|\\n  #end\\n#end","dirty":false}},"step":"validate-pin-handler"}],"name":"PinFlow"}','9175cb7f-f4ea-4023-bb57-b64837cfa5b5',1,1,'2020-06-16 14:06:04','2019-12-17 21:00:06',NULL,NULL,0,NULL)
,('ConsentFlow',NULL,'DRAFT','{"nodes":[{"nodeType":"user","templates":{"vxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<vxml version=\\"2.1\\">\\n\\n  ## Note: All over-rides below must be over-ridden in your flow, preferably your entry flow\\n\\n  ## Over-ride for a different timeout between user prompts\\n  #if (! $timeout) #set($timeout = 10) #end\\n\\n  ## Mandatorily over-ride this with the current caller''s locale based on how your application stores it\\n\\t#if (! $locale) #set($locale = \\"en\\") #end\\n\\n  ## over-ride this if you want to use a different skip character\\n  #if (! $skipChars) #set($skipChars = \\"*\\") #end\\n  \\n  #set($ext = \\".mp3\\")\\n\\n  ## Mandatorily over-ride this with the new flow name that you want to skip to if the skipChars is pressed\\n  #if ($internal.callDirection == \\"OUTGOING\\" && $skipFlow && $skipFlow != \\"\\")\\n\\t<link event=\\"SkipEvent\\">\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"skipRule\\" mode=\\"dtmf\\">\\n\\t\\t\\t<rule id=\\"skipRule\\" scope=\\"public\\">\\n\\t\\t\\t\\t<item>${skipChars}</item>\\n\\t\\t\\t</rule>\\n\\t\\t</grammar>\\n\\t</link>\\n\\n\\t<catch event=\\"SkipEvent\\">\\n\\t\\t<submit next=\\"${internal.nextURL}?jumpTo=${skipFlow}\\" />\\n\\t</catch>\\n  #end\\n\\n\\n<form>\\n\\t<var name=\\"gNoInputEventCount\\" expr=\\"0\\" />\\n\\t<var name=\\"gNoMatchEventCount\\" expr=\\"0\\" />\\n\\t<field name=\\"userInput\\" type=\\"digits?length=1\\">\\n\\t\\t<property name=\\"inputmodes\\" value=\\"dtmf\\" />\\n\\t\\t<prompt bargein=\\"true\\" timeout=\\"${timeout}s\\">#set($voiceFileName = \\"ask-consent-merged\\")\\n</prompt>\\n\\t\\t<prompt bargein=\\"true\\" timeout=\\"${timeout}s\\">\\n\\t\\t\\t<audio src=\\"http://cflinstalltest.cloudapp.net/audio/openmrs/$locale/$voiceFileName$ext\\" />\\n\\t\\t</prompt>\\n\\t\\t<noinput count=\\"1\\">\\n\\t\\t<var name=\\"gNoInputEventCount\\" expr=\\"gNoInputEventCount+1\\" />\\n\\t\\t<submit namelist=\\"gNoInputEventCount gNoMatchEventCount\\" next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t\\t</noinput>\\n\\t\\t<nomatch count=\\"1\\">\\n\\t\\t<var name=\\"gNoMatchEventCount\\" expr=\\"gNoMatchEventCount+1\\" />\\n\\t\\t<submit namelist=\\"gNoInputEventCount gNoMatchEventCount\\" next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t\\t</nomatch>\\n\\t\\t<noinput><reprompt />\\n\\t\\t</noinput>\\n\\t\\t<nomatch><reprompt />\\n\\t\\t</nomatch>\\n\\t</field>\\n\\t<filled mode=\\"all\\">\\n\\t\\t<submit namelist=\\"userInput\\" next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t</filled>\\n</form>\\n</vxml>"},"ccxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<ccxml version=\\"1.0\\" xmlns:voxeo=\\"http://community.voxeo.com/xmlns/ccxml\\">\\n\\n\\t#set($d = \\"$\\")\\n  <var name=\\"callTimeout\\" expr=\\"''60s''\\" />\\n  <var name=\\"state\\" expr=\\"''init''\\"/>\\n\\n  <!-- OUTGOING, INCOMING -->\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"statusURL\\" expr=\\"''${internal.baseURL}/callflows/status/${internal.callId}''\\" />\\n  <var name=\\"connectionId\\" expr=\\"''outboundID''\\" />\\n  <var name=\\"callId\\" expr=\\"''${internal.callId}''\\" />\\n  <var name=\\"jumpTo\\" expr=\\"''${internal.jumpTo}''\\" />\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"callStatus\\" />\\n\\n  <log expr=\\"''startupmode = '' + session.startupmode\\"/>\\n \\n  <eventprocessor>\\n\\n    <!-- CCXML Loaded -->\\n    <transition event=\\"ccxml.loaded\\">\\n      <log expr=\\"''ccxml loaded''\\" />\\n      <if cond=\\"session.startupmode === ''external''\\">\\n        <!-- tel:xxxx, sip:xxx@h:p sip:user@127.0.0.1:5070  -->\\n        <createcall dest=\\"''tel:+'' + ''${phone}''\\" callerid=\\"''${phone}''\\" connectionid=\\"connectionId\\" timeout=\\"callTimeout\\"/>\\n      </if>\\n    </transition>\\n   \\n    <!-- Process the incoming call --> \\n    <transition event=\\"connection.alerting\\">\\n      <log expr=\\"''connection.alerting''\\" />\\n      <accept/>     \\n    </transition>\\n      \\n    <transition event=\\"connection.failed\\">\\n      <var name=\\"eventReason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>      \\n\\n    </transition>\\n\\n    <!-- Call has been answered.--> \\n    <transition event=\\"connection.connected\\">\\n      <log expr=\\"''connection.connected -> ${internal.callId}''\\" />\\n\\t\\t\\t\\t<dialogstart src=\\"''${internal.baseURL}/callflows/in/voxeo/flows/MainFlow.vxml''\\" namelist=\\"session.id application.callerId callId  #if($internal.callDirection == ''OUTGOING'') jumpTo #end\\" />\\n      <var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''connected''\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <var name=\\"externalId\\" expr=\\"session.id\\" />\\n      <var name=\\"externalType\\" expr=\\"''voxeoSessionId''\\" />\\n      <send data=\\"''callMaxTimeReached''\\" target=\\"session.id\\" delay=\\"''600s''\\" />\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason externalId externalType timestamp\\"/>      \\n    </transition>\\n    \\n    <transition event=\\"callMaxTimeReached\\">\\n      <if cond=\\"callStatus == ''IN_PROGRESS''\\">\\n        <log expr=\\"''-- Max Call Time Reached / Disconnecting Call --''\\" />\\n        <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n        <var name=\\"reason\\" expr=\\"''Max time reached''\\" />\\n        <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n        <log expr=\\"''status='' + status + ''; reason = '' + reason\\" />   \\n        <send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>  \\n        <disconnect/>  \\n      </if>\\n\\t\\t</transition>  \\n\\n    <!-- Caller hung up.  -->\\n    <transition event=\\"connection.disconnected\\">\\n      <log expr=\\"''connection.disconnected -> ${internal.callId}''\\" />\\n      <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''COMPLETED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.trigger\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n    </transition>\\n    \\n    <transition event=\\"dialog.started\\">\\n      <log expr=\\"''dialog.started -> ${internal.callId}''\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''dialog start''\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n\\n    </transition>\\n     \\n    <!-- Dialog exit -->\\n    <transition event=\\"dialog.exit\\">\\n      <log expr=\\"''dialog.exit -> ${internal.callId}''\\" />\\n      <disconnect />\\n    </transition>\\n\\n    <!-- ERROR!! -->\\n    <transition event=\\"error.*\\" >\\n      <log expr=\\"''Error[CFL]: ('' + event${d}.reason + '')''\\"/>\\n      <exit/>\\n    </transition>\\n\\n  </eventprocessor>\\n\\n</ccxml>"}},"blocks":[{"name":"Form","type":"form","elements":[{"name":"userInput","type":"field","txt":"#set($voiceFileName = \\"ask-consent-merged\\")\\n`$voiceFileName`","fieldType":"digits","noInput":"","noMatch":"","goodBye":"","bargeIn":true,"dtmf":true,"voice":false,"fieldMeta":"1","dtmfGrammar":"","reprompt":"1"}]}],"step":"ask-consent"},{"nodeType":"system","templates":{"velocity":{"content":"#set($params.playedMessages = $voiceFileName + ''|'' + $params.userInput)\\n::::::::::::::$personId\\n#if($params.userInput)\\n  #if ($params.userInput == 1)\\n    #set($voiceFileName = \\"thank_you_for_consent\\")\\n    #set($consent = $cflPersonService.savePersonAttribute($personId,\\"Person status\\", \\"ACTIVATED\\"));\\n    |consent-response|\\n  #elseif($params.userInput == 3)\\n    #set($voiceFileName = \\"no_consent_provided\\")\\n    |consent-response|\\n  #elseif($params.userInput == 5)\\n    |ask-consent|\\n  #else\\n      #set($returnNode = \\"ConsentFlow.ask-consent\\")\\n      |MainFlow.invalid-input|\\n  #end  \\n#else\\n  |MainFlow.no-input|\\n#end","dirty":false}},"step":"ask-consent-handler"},{"nodeType":"user","templates":{"vxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<vxml version=\\"2.1\\">\\n\\n  ## Note: All over-rides below must be over-ridden in your flow, preferably your entry flow\\n\\n  ## Over-ride for a different timeout between user prompts\\n  #if (! $timeout) #set($timeout = 10) #end\\n\\n  ## Mandatorily over-ride this with the current caller''s locale based on how your application stores it\\n\\t#if (! $locale) #set($locale = \\"en\\") #end\\n\\n  ## over-ride this if you want to use a different skip character\\n  #if (! $skipChars) #set($skipChars = \\"*\\") #end\\n  \\n  #set($ext = \\".mp3\\")\\n\\n  ## Mandatorily over-ride this with the new flow name that you want to skip to if the skipChars is pressed\\n  #if ($internal.callDirection == \\"OUTGOING\\" && $skipFlow && $skipFlow != \\"\\")\\n\\t<link event=\\"SkipEvent\\">\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"skipRule\\" mode=\\"dtmf\\">\\n\\t\\t\\t<rule id=\\"skipRule\\" scope=\\"public\\">\\n\\t\\t\\t\\t<item>${skipChars}</item>\\n\\t\\t\\t</rule>\\n\\t\\t</grammar>\\n\\t</link>\\n\\n\\t<catch event=\\"SkipEvent\\">\\n\\t\\t<submit next=\\"${internal.nextURL}?jumpTo=${skipFlow}\\" />\\n\\t</catch>\\n  #end\\n\\n\\n<form>\\n\\t<var name=\\"gNoInputEventCount\\" expr=\\"0\\" />\\n\\t<var name=\\"gNoMatchEventCount\\" expr=\\"0\\" />\\n\\t<block>\\n\\t\\t<prompt bargein=\\"false\\">\\n\\t\\t\\t<audio src=\\"http://cflinstalltest.cloudapp.net/audio/openmrs/$locale/$voiceFileName$ext\\" />\\n\\t\\t</prompt>\\n\\t</block>\\n\\t<field name=\\"finishedHearing\\"><property name=\\"timeout\\" value=\\"0.1s\\" />\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"finishedRule\\" mode=\\"dtmf\\"><rule id=\\"finishedRule\\" scope=\\"public\\"><item>@</item></rule></grammar>\\n\\t\\t<nomatch />\\n\\t\\t<noinput count=\\"1\\"><goto nextitem=\\"submit\\" /></noinput>\\n\\t</field>\\n\\t<block name=\\"submit\\">\\n\\t\\t<goto next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t</block>\\n</form>\\n</vxml>"},"ccxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<ccxml version=\\"1.0\\" xmlns:voxeo=\\"http://community.voxeo.com/xmlns/ccxml\\">\\n\\n\\t#set($d = \\"$\\")\\n  <var name=\\"callTimeout\\" expr=\\"''60s''\\" />\\n  <var name=\\"state\\" expr=\\"''init''\\"/>\\n\\n  <!-- OUTGOING, INCOMING -->\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"statusURL\\" expr=\\"''${internal.baseURL}/callflows/status/${internal.callId}''\\" />\\n  <var name=\\"connectionId\\" expr=\\"''outboundID''\\" />\\n  <var name=\\"callId\\" expr=\\"''${internal.callId}''\\" />\\n  <var name=\\"jumpTo\\" expr=\\"''${internal.jumpTo}''\\" />\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"callStatus\\" />\\n\\n  <log expr=\\"''startupmode = '' + session.startupmode\\"/>\\n \\n  <eventprocessor>\\n\\n    <!-- CCXML Loaded -->\\n    <transition event=\\"ccxml.loaded\\">\\n      <log expr=\\"''ccxml loaded''\\" />\\n      <if cond=\\"session.startupmode === ''external''\\">\\n        <!-- tel:xxxx, sip:xxx@h:p sip:user@127.0.0.1:5070  -->\\n        <createcall dest=\\"''tel:+'' + ''${phone}''\\" callerid=\\"''${phone}''\\" connectionid=\\"connectionId\\" timeout=\\"callTimeout\\"/>\\n      </if>\\n    </transition>\\n   \\n    <!-- Process the incoming call --> \\n    <transition event=\\"connection.alerting\\">\\n      <log expr=\\"''connection.alerting''\\" />\\n      <accept/>     \\n    </transition>\\n      \\n    <transition event=\\"connection.failed\\">\\n      <var name=\\"eventReason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>      \\n\\n    </transition>\\n\\n    <!-- Call has been answered.--> \\n    <transition event=\\"connection.connected\\">\\n      <log expr=\\"''connection.connected -> ${internal.callId}''\\" />\\n\\t\\t\\t\\t<dialogstart src=\\"''${internal.baseURL}/callflows/in/voxeo/flows/MainFlow.vxml''\\" namelist=\\"session.id application.callerId callId  #if($internal.callDirection == ''OUTGOING'') jumpTo #end\\" />\\n      <var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''connected''\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <var name=\\"externalId\\" expr=\\"session.id\\" />\\n      <var name=\\"externalType\\" expr=\\"''voxeoSessionId''\\" />\\n      <send data=\\"''callMaxTimeReached''\\" target=\\"session.id\\" delay=\\"''600s''\\" />\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason externalId externalType timestamp\\"/>      \\n    </transition>\\n    \\n    <transition event=\\"callMaxTimeReached\\">\\n      <if cond=\\"callStatus == ''IN_PROGRESS''\\">\\n        <log expr=\\"''-- Max Call Time Reached / Disconnecting Call --''\\" />\\n        <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n        <var name=\\"reason\\" expr=\\"''Max time reached''\\" />\\n        <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n        <log expr=\\"''status='' + status + ''; reason = '' + reason\\" />   \\n        <send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>  \\n        <disconnect/>  \\n      </if>\\n\\t\\t</transition>  \\n\\n    <!-- Caller hung up.  -->\\n    <transition event=\\"connection.disconnected\\">\\n      <log expr=\\"''connection.disconnected -> ${internal.callId}''\\" />\\n      <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''COMPLETED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.trigger\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n    </transition>\\n    \\n    <transition event=\\"dialog.started\\">\\n      <log expr=\\"''dialog.started -> ${internal.callId}''\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''dialog start''\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n\\n    </transition>\\n     \\n    <!-- Dialog exit -->\\n    <transition event=\\"dialog.exit\\">\\n      <log expr=\\"''dialog.exit -> ${internal.callId}''\\" />\\n      <disconnect />\\n    </transition>\\n\\n    <!-- ERROR!! -->\\n    <transition event=\\"error.*\\" >\\n      <log expr=\\"''Error[CFL]: ('' + event${d}.reason + '')''\\"/>\\n      <exit/>\\n    </transition>\\n\\n  </eventprocessor>\\n\\n</ccxml>"}},"blocks":[{"name":"Form","type":"form","elements":[{"name":"Txt","type":"txt","txt":"`$voiceFileName`"}]}],"step":"consent-response","continueNode":true},{"nodeType":"system","templates":{"velocity":{"content":"#set($params.playedMessages = $voiceFileName)\\n|MainFlow.goodbye|","dirty":false}},"step":"consent-response-handler"}],"name":"ConsentFlow"}','71df4193-4d9f-4ec3-b3ee-ad4e29791415',1,1,'2020-02-24 11:32:54','2019-12-17 21:23:49',NULL,NULL,0,NULL)
,('HealthTipFlow',NULL,'DRAFT','{"nodes":[{"nodeType":"user","templates":{"vxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<vxml version=\\"2.1\\">\\n\\n  ## Note: All over-rides below must be over-ridden in your flow, preferably your entry flow\\n\\n  ## Over-ride for a different timeout between user prompts\\n  #if (! $timeout) #set($timeout = 10) #end\\n\\n  ## Mandatorily over-ride this with the current caller''s locale based on how your application stores it\\n\\t#if (! $locale) #set($locale = \\"en\\") #end\\n\\n  ## over-ride this if you want to use a different skip character\\n  #if (! $skipChars) #set($skipChars = \\"*\\") #end\\n  \\n  #set($ext = \\".mp3\\")\\n\\n  ## Mandatorily over-ride this with the new flow name that you want to skip to if the skipChars is pressed\\n  #if ($internal.callDirection == \\"OUTGOING\\" && $skipFlow && $skipFlow != \\"\\")\\n\\t<link event=\\"SkipEvent\\">\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"skipRule\\" mode=\\"dtmf\\">\\n\\t\\t\\t<rule id=\\"skipRule\\" scope=\\"public\\">\\n\\t\\t\\t\\t<item>${skipChars}</item>\\n\\t\\t\\t</rule>\\n\\t\\t</grammar>\\n\\t</link>\\n\\n\\t<catch event=\\"SkipEvent\\">\\n\\t\\t<submit next=\\"${internal.nextURL}?jumpTo=${skipFlow}\\" />\\n\\t</catch>\\n  #end\\n\\n\\n<form>\\n\\t<var name=\\"gNoInputEventCount\\" expr=\\"0\\" />\\n\\t<var name=\\"gNoMatchEventCount\\" expr=\\"0\\" />\\n\\t<block>\\n\\t\\t<prompt bargein=\\"true\\" bargeintype=\\"hotword\\">#set($voiceFileName = \\"intro_healthtip\\")\\n</prompt>\\n\\t\\t<prompt bargein=\\"false\\">\\n\\t\\t\\t<audio src=\\"http://cflinstalltest.cloudapp.net/audio/openmrs/$locale/$voiceFileName$ext\\" />\\n\\t\\t</prompt>\\n\\t</block>\\n\\t<field name=\\"finishedHearing\\"><property name=\\"timeout\\" value=\\"0.1s\\" />\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"finishedRule\\" mode=\\"dtmf\\"><rule id=\\"finishedRule\\" scope=\\"public\\"><item>@</item></rule></grammar>\\n\\t\\t<nomatch />\\n\\t\\t<noinput count=\\"1\\"><goto nextitem=\\"submit\\" /></noinput>\\n\\t</field>\\n\\t<block name=\\"submit\\">\\n\\t\\t<goto next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t</block>\\n</form>\\n</vxml>"},"ccxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<ccxml version=\\"1.0\\" xmlns:voxeo=\\"http://community.voxeo.com/xmlns/ccxml\\">\\n\\n\\t#set($d = \\"$\\")\\n  <var name=\\"callTimeout\\" expr=\\"''60s''\\" />\\n  <var name=\\"state\\" expr=\\"''init''\\"/>\\n\\n  <!-- OUTGOING, INCOMING -->\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"statusURL\\" expr=\\"''${internal.baseURL}/callflows/status/${internal.callId}''\\" />\\n  <var name=\\"connectionId\\" expr=\\"''outboundID''\\" />\\n  <var name=\\"callId\\" expr=\\"''${internal.callId}''\\" />\\n  <var name=\\"jumpTo\\" expr=\\"''${internal.jumpTo}''\\" />\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"callStatus\\" />\\n\\n  <log expr=\\"''startupmode = '' + session.startupmode\\"/>\\n \\n  <eventprocessor>\\n\\n    <!-- CCXML Loaded -->\\n    <transition event=\\"ccxml.loaded\\">\\n      <log expr=\\"''ccxml loaded''\\" />\\n      <if cond=\\"session.startupmode === ''external''\\">\\n        <!-- tel:xxxx, sip:xxx@h:p sip:user@127.0.0.1:5070  -->\\n        <createcall dest=\\"''tel:+'' + ''${phone}''\\" callerid=\\"''${phone}''\\" connectionid=\\"connectionId\\" timeout=\\"callTimeout\\"/>\\n      </if>\\n    </transition>\\n   \\n    <!-- Process the incoming call --> \\n    <transition event=\\"connection.alerting\\">\\n      <log expr=\\"''connection.alerting''\\" />\\n      <accept/>     \\n    </transition>\\n      \\n    <transition event=\\"connection.failed\\">\\n      <var name=\\"eventReason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>      \\n\\n    </transition>\\n\\n    <!-- Call has been answered.--> \\n    <transition event=\\"connection.connected\\">\\n      <log expr=\\"''connection.connected -> ${internal.callId}''\\" />\\n\\t\\t\\t\\t<dialogstart src=\\"''${internal.baseURL}/callflows/in/voxeo/flows/MainFlow.vxml''\\" namelist=\\"session.id application.callerId callId  #if($internal.callDirection == ''OUTGOING'') jumpTo #end\\" />\\n      <var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''connected''\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <var name=\\"externalId\\" expr=\\"session.id\\" />\\n      <var name=\\"externalType\\" expr=\\"''voxeoSessionId''\\" />\\n      <send data=\\"''callMaxTimeReached''\\" target=\\"session.id\\" delay=\\"''600s''\\" />\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason externalId externalType timestamp\\"/>      \\n    </transition>\\n    \\n    <transition event=\\"callMaxTimeReached\\">\\n      <if cond=\\"callStatus == ''IN_PROGRESS''\\">\\n        <log expr=\\"''-- Max Call Time Reached / Disconnecting Call --''\\" />\\n        <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n        <var name=\\"reason\\" expr=\\"''Max time reached''\\" />\\n        <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n        <log expr=\\"''status='' + status + ''; reason = '' + reason\\" />   \\n        <send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>  \\n        <disconnect/>  \\n      </if>\\n\\t\\t</transition>  \\n\\n    <!-- Caller hung up.  -->\\n    <transition event=\\"connection.disconnected\\">\\n      <log expr=\\"''connection.disconnected -> ${internal.callId}''\\" />\\n      <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''COMPLETED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.trigger\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n    </transition>\\n    \\n    <transition event=\\"dialog.started\\">\\n      <log expr=\\"''dialog.started -> ${internal.callId}''\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''dialog start''\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n\\n    </transition>\\n     \\n    <!-- Dialog exit -->\\n    <transition event=\\"dialog.exit\\">\\n      <log expr=\\"''dialog.exit -> ${internal.callId}''\\" />\\n      <disconnect />\\n    </transition>\\n\\n    <!-- ERROR!! -->\\n    <transition event=\\"error.*\\" >\\n      <log expr=\\"''Error[CFL]: ('' + event${d}.reason + '')''\\"/>\\n      <exit/>\\n    </transition>\\n\\n  </eventprocessor>\\n\\n</ccxml>"}},"blocks":[{"name":"Form","type":"form","elements":[{"name":"Txt","type":"txt","txt":"#set($voiceFileName = \\"intro_healthtip\\")\\n`$voiceFileName`"}]}],"step":"entry","continueNode":true},{"nodeType":"system","templates":{"velocity":{"content":"#set($params.playedMessages = $voiceFileName)\\n#set($healthTipParam = $messages.get(0).params)\\n#set($healthTipId = $healthTipParam.HEALTH_TIP_ID.split('','').get(0))\\n#set ($healthTipId = $Integer.parseInt($healthTipId)) \\n#set($healthTip = $conceptDAO.getConcept($healthTipId))\\n#set($localeClass = $conceptDAO.getClass().forName(\\"java.util.Locale\\"))\\nlocaleClass::::::::: $localeClass.getName() \\ngetShortestNames:::::::::::::: $healthTip.getShortNames().get(0)\\nlocale::::::::: $locale\\ngetShortNameInLocale:::::::::::::: $healthTip.getShortNameInLocale($localeClass.ENGLISH)\\n#set($healthTipText = $healthTip.getDescription().getDescription())\\n|play-tip| ","dirty":false}},"step":"entry-handler"},{"nodeType":"user","templates":{"vxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<vxml version=\\"2.1\\">\\n\\n  ## Note: All over-rides below must be over-ridden in your flow, preferably your entry flow\\n\\n  ## Over-ride for a different timeout between user prompts\\n  #if (! $timeout) #set($timeout = 10) #end\\n\\n  ## Mandatorily over-ride this with the current caller''s locale based on how your application stores it\\n\\t#if (! $locale) #set($locale = \\"en\\") #end\\n\\n  ## over-ride this if you want to use a different skip character\\n  #if (! $skipChars) #set($skipChars = \\"*\\") #end\\n  \\n  #set($ext = \\".mp3\\")\\n\\n  ## Mandatorily over-ride this with the new flow name that you want to skip to if the skipChars is pressed\\n  #if ($internal.callDirection == \\"OUTGOING\\" && $skipFlow && $skipFlow != \\"\\")\\n\\t<link event=\\"SkipEvent\\">\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"skipRule\\" mode=\\"dtmf\\">\\n\\t\\t\\t<rule id=\\"skipRule\\" scope=\\"public\\">\\n\\t\\t\\t\\t<item>${skipChars}</item>\\n\\t\\t\\t</rule>\\n\\t\\t</grammar>\\n\\t</link>\\n\\n\\t<catch event=\\"SkipEvent\\">\\n\\t\\t<submit next=\\"${internal.nextURL}?jumpTo=${skipFlow}\\" />\\n\\t</catch>\\n  #end\\n\\n\\n<form>\\n\\t<var name=\\"gNoInputEventCount\\" expr=\\"0\\" />\\n\\t<var name=\\"gNoMatchEventCount\\" expr=\\"0\\" />\\n\\t<block>\\n\\t\\t<prompt bargein=\\"true\\" bargeintype=\\"hotword\\">$healthTipText</prompt>\\n\\t</block>\\n\\t<field name=\\"finishedHearing\\"><property name=\\"timeout\\" value=\\"0.1s\\" />\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"finishedRule\\" mode=\\"dtmf\\"><rule id=\\"finishedRule\\" scope=\\"public\\"><item>@</item></rule></grammar>\\n\\t\\t<nomatch />\\n\\t\\t<noinput count=\\"1\\"><goto nextitem=\\"submit\\" /></noinput>\\n\\t</field>\\n\\t<block name=\\"submit\\">\\n\\t\\t<goto next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t</block>\\n</form>\\n</vxml>"},"ccxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<ccxml version=\\"1.0\\" xmlns:voxeo=\\"http://community.voxeo.com/xmlns/ccxml\\">\\n\\n\\t#set($d = \\"$\\")\\n  <var name=\\"callTimeout\\" expr=\\"''60s''\\" />\\n  <var name=\\"state\\" expr=\\"''init''\\"/>\\n\\n  <!-- OUTGOING, INCOMING -->\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"statusURL\\" expr=\\"''${internal.baseURL}/callflows/status/${internal.callId}''\\" />\\n  <var name=\\"connectionId\\" expr=\\"''outboundID''\\" />\\n  <var name=\\"callId\\" expr=\\"''${internal.callId}''\\" />\\n  <var name=\\"jumpTo\\" expr=\\"''${internal.jumpTo}''\\" />\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"callStatus\\" />\\n\\n  <log expr=\\"''startupmode = '' + session.startupmode\\"/>\\n \\n  <eventprocessor>\\n\\n    <!-- CCXML Loaded -->\\n    <transition event=\\"ccxml.loaded\\">\\n      <log expr=\\"''ccxml loaded''\\" />\\n      <if cond=\\"session.startupmode === ''external''\\">\\n        <!-- tel:xxxx, sip:xxx@h:p sip:user@127.0.0.1:5070  -->\\n        <createcall dest=\\"''tel:+'' + ''${phone}''\\" callerid=\\"''${phone}''\\" connectionid=\\"connectionId\\" timeout=\\"callTimeout\\"/>\\n      </if>\\n    </transition>\\n   \\n    <!-- Process the incoming call --> \\n    <transition event=\\"connection.alerting\\">\\n      <log expr=\\"''connection.alerting''\\" />\\n      <accept/>     \\n    </transition>\\n      \\n    <transition event=\\"connection.failed\\">\\n      <var name=\\"eventReason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>      \\n\\n    </transition>\\n\\n    <!-- Call has been answered.--> \\n    <transition event=\\"connection.connected\\">\\n      <log expr=\\"''connection.connected -> ${internal.callId}''\\" />\\n\\t\\t\\t\\t<dialogstart src=\\"''${internal.baseURL}/callflows/in/voxeo/flows/MainFlow.vxml''\\" namelist=\\"session.id application.callerId callId  #if($internal.callDirection == ''OUTGOING'') jumpTo #end\\" />\\n      <var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''connected''\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <var name=\\"externalId\\" expr=\\"session.id\\" />\\n      <var name=\\"externalType\\" expr=\\"''voxeoSessionId''\\" />\\n      <send data=\\"''callMaxTimeReached''\\" target=\\"session.id\\" delay=\\"''600s''\\" />\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason externalId externalType timestamp\\"/>      \\n    </transition>\\n    \\n    <transition event=\\"callMaxTimeReached\\">\\n      <if cond=\\"callStatus == ''IN_PROGRESS''\\">\\n        <log expr=\\"''-- Max Call Time Reached / Disconnecting Call --''\\" />\\n        <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n        <var name=\\"reason\\" expr=\\"''Max time reached''\\" />\\n        <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n        <log expr=\\"''status='' + status + ''; reason = '' + reason\\" />   \\n        <send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>  \\n        <disconnect/>  \\n      </if>\\n\\t\\t</transition>  \\n\\n    <!-- Caller hung up.  -->\\n    <transition event=\\"connection.disconnected\\">\\n      <log expr=\\"''connection.disconnected -> ${internal.callId}''\\" />\\n      <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''COMPLETED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.trigger\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n    </transition>\\n    \\n    <transition event=\\"dialog.started\\">\\n      <log expr=\\"''dialog.started -> ${internal.callId}''\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''dialog start''\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n\\n    </transition>\\n     \\n    <!-- Dialog exit -->\\n    <transition event=\\"dialog.exit\\">\\n      <log expr=\\"''dialog.exit -> ${internal.callId}''\\" />\\n      <disconnect />\\n    </transition>\\n\\n    <!-- ERROR!! -->\\n    <transition event=\\"error.*\\" >\\n      <log expr=\\"''Error[CFL]: ('' + event${d}.reason + '')''\\"/>\\n      <exit/>\\n    </transition>\\n\\n  </eventprocessor>\\n\\n</ccxml>"}},"blocks":[{"name":"Form","type":"form","elements":[{"name":"Txt","type":"txt","txt":"$healthTipText"}]}],"step":"play-tip","continueNode":true},{"nodeType":"system","templates":{"velocity":{"content":"message::::::::::: $messages.get(0).messageId\\ncalId::::::::::::::: $callId\\n#set($messageId = $messages.get(0).messageId)\\nmessageId::::::::::::::: $messageId\\nhealthTipId::::::::::::::: $healthTipId\\nDateUtil.now()::::::::::::::: $DateUtil.now()\\n#if($internal.callDirection == ''OUTGOING'')\\n  $messagesService.registerResponse($personId, $personId, $messageId, ''SCHEDULED_SERVICE_GROUP'', 165350, '''', $healthTipId, '''', $DateUtil.now())\\n\\t$messagesService.registerResponseAndStatus($messageId, $healthTipId, '''', 165270, '''', ''DELIVERED'', $DateUtil.now(), $callId)\\n#elseif($internal.callDirection == ''INCOMING'')\\n\\t$messagesService.registerResponse($personId, $personId, $callId, ''OTHER'', 165350, '''', $healthTipId, '''', $DateUtil.now())\\n#end\\n$messages.remove(0)\\n|OutgoingFlow.entry-handler|","dirty":false}},"step":"play-tip-handler"}],"name":"HealthTipFlow"}','b04a54a6-cfca-4f2b-9d27-eef5eeacf34c',1,1,'2020-03-26 17:36:21','2020-01-27 21:13:20',NULL,NULL,0,NULL)
,('VisitReminderFlow',NULL,'DRAFT','{"nodes":[{"nodeType":"user","templates":{"vxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<vxml version=\\"2.1\\">\\n  \\n  ## Note: All over-rides below must be over-ridden in your flow, preferably your entry flow\\n\\t\\n  ## Over-ride for a different timeout between user prompts\\n  #if (! $timeout) #set($timeout = 5) #end\\n  \\n  ## Mandatorily over-ride this with the current caller''s locale based on how your application stores it\\n\\t#if (! $locale) #set($locale = \\"en\\") #end \\n  \\n  ## over-ride this if you want to use a different skip character\\n  #if (! $skipChars) #set($skipChars = \\"*\\") #end\\n  \\n  ## Mandatorily over-ride this with the new flow name that you want to skip to if the skipChars is pressed\\n  #if ($internal.callDirection == \\"OUTGOING\\" && $skipFlow && $skipFlow != \\"\\")  \\n\\t<link event=\\"SkipEvent\\">\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"skipRule\\" mode=\\"dtmf\\">\\n\\t\\t\\t<rule id=\\"skipRule\\" scope=\\"public\\">\\n\\t\\t\\t\\t<item>${skipChars}</item>\\n\\t\\t\\t</rule>\\n\\t\\t</grammar>\\n\\t</link>\\n\\n\\t<catch event=\\"SkipEvent\\">\\n\\t\\t<submit next=\\"${internal.nextURL}?jumpTo=${skipFlow}\\" />\\n\\t</catch>\\n  #end\\n    \\n\\n<form>\\n\\t<block>\\n\\t\\t<prompt bargein=\\"true\\" bargeintype=\\"hotword\\">#set($textToRead = \\"You have scheduled visit\\")\\n#set($locationId = $messages.get(0).params.locationId)\\n#set($visitTime = $messages.get(0).params.timeStarted)\\n#set($locationToRead = \\"\\")\\n#set($timeToRead = \\"\\")\\n#if($locationId)\\n\\t#set($locationId = $Integer.parseInt($locationId))\\n  #set($location = $locationService.getLocation($locationId).getDisplayString())\\n\\t#set($locationToRead = \\"Please go to the clinic $location\\")\\n#end\\n#if($visitTime)\\n  #set($timeToRead = \\"at $visitTime\\")\\n#end\\n#set($voiceFileName = \\"intro_visitreminder_patient\\")\\n</prompt>\\n\\t\\t<prompt bargein=\\"false\\">\\n\\t\\t\\t<audio src=\\"${internal.baseURL}/cmsliteapi/stream/$locale/$voiceFileName\\" />\\n\\t\\t</prompt>\\n\\t\\t<prompt bargein=\\"true\\" bargeintype=\\"hotword\\">\\n$textToRead $locationToRead $timeToRead\\n\\n\\n\\n</prompt>\\n\\t</block>\\n\\t<field name=\\"finishedHearing\\"><property name=\\"timeout\\" value=\\"0.1s\\" />\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"finishedRule\\" mode=\\"dtmf\\"><rule id=\\"finishedRule\\" scope=\\"public\\"><item>@</item></rule></grammar>\\n\\t\\t<nomatch />\\n\\t\\t<noinput count=\\"1\\"><goto nextitem=\\"submit\\" /></noinput>\\n\\t</field>\\n\\t<block name=\\"submit\\">\\n\\t\\t<goto next=\\"${internal.nextURL}?_dt=$DateTime.now().getMillis()\\" />\\n\\t</block>\\n</form>\\n</vxml>\\n"},"ccxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<ccxml version=\\"1.0\\" xmlns:voxeo=\\"http://community.voxeo.com/xmlns/ccxml\\">\\n\\n\\t#set($d = \\"$\\")\\n  <var name=\\"callTimeout\\" expr=\\"''60s''\\" />\\n  <var name=\\"state\\" expr=\\"''init''\\"/>\\n\\n  <!-- OUTGOING, INCOMING -->\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"statusURL\\" expr=\\"''${internal.baseURL}/callflows/status/${internal.callId}''\\" />\\n  <var name=\\"connectionId\\" expr=\\"''outboundID''\\" />\\n  <var name=\\"callId\\" expr=\\"''${internal.callId}''\\" />\\n  <var name=\\"jumpTo\\" expr=\\"''${internal.jumpTo}''\\" />\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"callStatus\\" />\\n\\n  <log expr=\\"''startupmode = '' + session.startupmode\\"/>\\n \\n  <eventprocessor>\\n\\n    <!-- CCXML Loaded -->\\n    <transition event=\\"ccxml.loaded\\">\\n      <log expr=\\"''ccxml loaded''\\" />\\n      <if cond=\\"session.startupmode === ''external''\\">\\n        <!-- tel:xxxx, sip:xxx@h:p sip:user@127.0.0.1:5070  -->\\n        <createcall dest=\\"''tel:+'' + ''${phone}''\\" callerid=\\"''${phone}''\\" connectionid=\\"connectionId\\" timeout=\\"callTimeout\\"/>\\n      </if>\\n    </transition>\\n   \\n    <!-- Process the incoming call --> \\n    <transition event=\\"connection.alerting\\">\\n      <log expr=\\"''connection.alerting''\\" />\\n      <accept/>     \\n    </transition>\\n      \\n    <transition event=\\"connection.failed\\">\\n      <var name=\\"eventReason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>      \\n\\n    </transition>\\n\\n    <!-- Call has been answered.--> \\n    <transition event=\\"connection.connected\\">\\n      <log expr=\\"''connection.connected -> ${internal.callId}''\\" />\\n\\t\\t\\t\\t<dialogstart src=\\"''${internal.baseURL}/callflows/in/voxeo/flows/MainFlow.vxml''\\" namelist=\\"session.id application.callerId callId  #if($internal.callDirection == ''OUTGOING'') jumpTo #end\\" />\\n      <var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''connected''\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <var name=\\"externalId\\" expr=\\"session.id\\" />\\n      <var name=\\"externalType\\" expr=\\"''voxeoSessionId''\\" />\\n      <send data=\\"''callMaxTimeReached''\\" target=\\"session.id\\" delay=\\"''600s''\\" />\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason externalId externalType timestamp\\"/>      \\n    </transition>\\n    \\n    <transition event=\\"callMaxTimeReached\\">\\n      <if cond=\\"callStatus == ''IN_PROGRESS''\\">\\n        <log expr=\\"''-- Max Call Time Reached / Disconnecting Call --''\\" />\\n        <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n        <var name=\\"reason\\" expr=\\"''Max time reached''\\" />\\n        <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n        <log expr=\\"''status='' + status + ''; reason = '' + reason\\" />   \\n        <send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>  \\n        <disconnect/>  \\n      </if>\\n\\t\\t</transition>  \\n\\n    <!-- Caller hung up.  -->\\n    <transition event=\\"connection.disconnected\\">\\n      <log expr=\\"''connection.disconnected -> ${internal.callId}''\\" />\\n      <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''COMPLETED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.trigger\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n    </transition>\\n    \\n    <transition event=\\"dialog.started\\">\\n      <log expr=\\"''dialog.started -> ${internal.callId}''\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''dialog start''\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n\\n    </transition>\\n     \\n    <!-- Dialog exit -->\\n    <transition event=\\"dialog.exit\\">\\n      <log expr=\\"''dialog.exit -> ${internal.callId}''\\" />\\n      <disconnect />\\n    </transition>\\n\\n    <!-- ERROR!! -->\\n    <transition event=\\"error.*\\" >\\n      <log expr=\\"''Error[CFL]: ('' + event${d}.reason + '')''\\"/>\\n      <exit/>\\n    </transition>\\n\\n  </eventprocessor>\\n\\n</ccxml>\\n"}},"blocks":[{"name":"Form","type":"form","elements":[{"name":"Txt","type":"txt","txt":"#set($textToRead = \\"You have scheduled visit\\")\\n#set($locationId = $messages.get(0).params.locationId)\\n#set($visitTime = $messages.get(0).params.timeStarted)\\n#set($locationToRead = \\"\\")\\n#set($timeToRead = \\"\\")\\n#if($locationId)\\n\\t#set($locationId = $Integer.parseInt($locationId))\\n  #set($location = $locationService.getLocation($locationId).getDisplayString())\\n\\t#set($locationToRead = \\"Please go to the clinic $location\\")\\n#end\\n#if($visitTime)\\n  #set($timeToRead = \\"at $visitTime\\")\\n#end\\n#set($voiceFileName = \\"intro_visitreminder_patient\\")\\n`$voiceFileName`\\n$textToRead $locationToRead $timeToRead\\n\\n\\n\\n"}]}],"step":"entry","continueNode":true},{"nodeType":"system","templates":{"velocity":{"content":"#set($params.playedMessages = $voiceFileName)\\n#set($messageId = $messages.get(0).messageId)\\n$messagesService.registerAttempt($messageId, ''DELIVERED'', $DateUtil.now(), $callId)\\n$messages.remove(0)\\n|OutgoingFlow.entry-handler|","dirty":false}},"step":"entry-handler"}],"name":"VisitReminderFlow"}','1881b1fc-3d1e-47a5-b3a4-2a830a7e9de7',1,1,'2020-02-25 05:16:34','2020-01-30 08:29:54',NULL,NULL,0,NULL)
,('AdherenceFeedbackFlow',NULL,'DRAFT','{"nodes":[{"nodeType":"user","templates":{"vxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<vxml version=\\"2.1\\">\\n\\n  ## Note: All over-rides below must be over-ridden in your flow, preferably your entry flow\\n\\n  ## Over-ride for a different timeout between user prompts\\n  #if (! $timeout) #set($timeout = 10) #end\\n\\n  ## Mandatorily over-ride this with the current caller''s locale based on how your application stores it\\n\\t#if (! $locale) #set($locale = \\"en\\") #end\\n\\n  ## over-ride this if you want to use a different skip character\\n  #if (! $skipChars) #set($skipChars = \\"*\\") #end\\n  \\n  #set($ext = \\".mp3\\")\\n\\n  ## Mandatorily over-ride this with the new flow name that you want to skip to if the skipChars is pressed\\n  #if ($internal.callDirection == \\"OUTGOING\\" && $skipFlow && $skipFlow != \\"\\")\\n\\t<link event=\\"SkipEvent\\">\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"skipRule\\" mode=\\"dtmf\\">\\n\\t\\t\\t<rule id=\\"skipRule\\" scope=\\"public\\">\\n\\t\\t\\t\\t<item>${skipChars}</item>\\n\\t\\t\\t</rule>\\n\\t\\t</grammar>\\n\\t</link>\\n\\n\\t<catch event=\\"SkipEvent\\">\\n\\t\\t<submit next=\\"${internal.nextURL}?jumpTo=${skipFlow}\\" />\\n\\t</catch>\\n  #end\\n\\n\\n<form>\\n\\t<var name=\\"gNoInputEventCount\\" expr=\\"0\\" />\\n\\t<var name=\\"gNoMatchEventCount\\" expr=\\"0\\" />\\n\\t<block>\\n\\t\\t<prompt bargein=\\"true\\" bargeintype=\\"hotword\\">This is adherence feedback flow\\n#set($adfParam = $messages.get(0).params)\\n#set($adfLevel = $adfParam.ADHERENCE_LEVEL)\\n#set($adfTrend = $adfParam.ADHERENCE_TREND)\\n\\nyour adherence for past week is $adfLevel and compare to last week your adherence trend is $adfTrend</prompt>\\n\\t</block>\\n\\t<field name=\\"finishedHearing\\"><property name=\\"timeout\\" value=\\"0.1s\\" />\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"finishedRule\\" mode=\\"dtmf\\"><rule id=\\"finishedRule\\" scope=\\"public\\"><item>@</item></rule></grammar>\\n\\t\\t<nomatch />\\n\\t\\t<noinput count=\\"1\\"><goto nextitem=\\"submit\\" /></noinput>\\n\\t</field>\\n\\t<block name=\\"submit\\">\\n\\t\\t<goto next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t</block>\\n</form>\\n</vxml>"},"ccxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<ccxml version=\\"1.0\\" xmlns:voxeo=\\"http://community.voxeo.com/xmlns/ccxml\\">\\n\\n\\t#set($d = \\"$\\")\\n  <var name=\\"callTimeout\\" expr=\\"''60s''\\" />\\n  <var name=\\"state\\" expr=\\"''init''\\"/>\\n\\n  <!-- OUTGOING, INCOMING -->\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"statusURL\\" expr=\\"''${internal.baseURL}/callflows/status/${internal.callId}''\\" />\\n  <var name=\\"connectionId\\" expr=\\"''outboundID''\\" />\\n  <var name=\\"callId\\" expr=\\"''${internal.callId}''\\" />\\n  <var name=\\"jumpTo\\" expr=\\"''${internal.jumpTo}''\\" />\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"callStatus\\" />\\n\\n  <log expr=\\"''startupmode = '' + session.startupmode\\"/>\\n \\n  <eventprocessor>\\n\\n    <!-- CCXML Loaded -->\\n    <transition event=\\"ccxml.loaded\\">\\n      <log expr=\\"''ccxml loaded''\\" />\\n      <if cond=\\"session.startupmode === ''external''\\">\\n        <!-- tel:xxxx, sip:xxx@h:p sip:user@127.0.0.1:5070  -->\\n        <createcall dest=\\"''tel:+'' + ''${phone}''\\" callerid=\\"''${phone}''\\" connectionid=\\"connectionId\\" timeout=\\"callTimeout\\"/>\\n      </if>\\n    </transition>\\n   \\n    <!-- Process the incoming call --> \\n    <transition event=\\"connection.alerting\\">\\n      <log expr=\\"''connection.alerting''\\" />\\n      <accept/>     \\n    </transition>\\n      \\n    <transition event=\\"connection.failed\\">\\n      <var name=\\"eventReason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>      \\n\\n    </transition>\\n\\n    <!-- Call has been answered.--> \\n    <transition event=\\"connection.connected\\">\\n      <log expr=\\"''connection.connected -> ${internal.callId}''\\" />\\n\\t\\t\\t\\t<dialogstart src=\\"''${internal.baseURL}/callflows/in/voxeo/flows/MainFlow.vxml''\\" namelist=\\"session.id application.callerId callId  #if($internal.callDirection == ''OUTGOING'') jumpTo #end\\" />\\n      <var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''connected''\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <var name=\\"externalId\\" expr=\\"session.id\\" />\\n      <var name=\\"externalType\\" expr=\\"''voxeoSessionId''\\" />\\n      <send data=\\"''callMaxTimeReached''\\" target=\\"session.id\\" delay=\\"''600s''\\" />\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason externalId externalType timestamp\\"/>      \\n    </transition>\\n    \\n    <transition event=\\"callMaxTimeReached\\">\\n      <if cond=\\"callStatus == ''IN_PROGRESS''\\">\\n        <log expr=\\"''-- Max Call Time Reached / Disconnecting Call --''\\" />\\n        <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n        <var name=\\"reason\\" expr=\\"''Max time reached''\\" />\\n        <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n        <log expr=\\"''status='' + status + ''; reason = '' + reason\\" />   \\n        <send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>  \\n        <disconnect/>  \\n      </if>\\n\\t\\t</transition>  \\n\\n    <!-- Caller hung up.  -->\\n    <transition event=\\"connection.disconnected\\">\\n      <log expr=\\"''connection.disconnected -> ${internal.callId}''\\" />\\n      <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''COMPLETED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.trigger\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n    </transition>\\n    \\n    <transition event=\\"dialog.started\\">\\n      <log expr=\\"''dialog.started -> ${internal.callId}''\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''dialog start''\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n\\n    </transition>\\n     \\n    <!-- Dialog exit -->\\n    <transition event=\\"dialog.exit\\">\\n      <log expr=\\"''dialog.exit -> ${internal.callId}''\\" />\\n      <disconnect />\\n    </transition>\\n\\n    <!-- ERROR!! -->\\n    <transition event=\\"error.*\\" >\\n      <log expr=\\"''Error[CFL]: ('' + event${d}.reason + '')''\\"/>\\n      <exit/>\\n    </transition>\\n\\n  </eventprocessor>\\n\\n</ccxml>"},"New renderer":{"dirty":false,"content":"{Success}"}},"blocks":[{"name":"Form","type":"form","elements":[{"name":"Txt","type":"txt","txt":"This is adherence feedback flow\\n#set($adfParam = $messages.get(0).params)\\n#set($adfLevel = $adfParam.ADHERENCE_LEVEL)\\n#set($adfTrend = $adfParam.ADHERENCE_TREND)\\n\\nyour adherence for past week is $adfLevel and compare to last week your adherence trend is $adfTrend"}]}],"step":"entry","continueNode":true},{"nodeType":"system","templates":{"velocity":{"content":"#set($messageId = $messages.get(0).messageId)\\n$messagesService.registerAttempt($messageId, ''DELIVERED'', $DateUtil.now(), $callId)\\n$messages.remove(0)\\n|OutgoingFlow.entry-handler|","dirty":false}},"step":"entry-handler"}],"name":"AdherenceFeedbackFlow"}','4213dcb9-b70f-4741-9da3-b76c64dd7b3c',1,1,'2020-02-25 11:56:23','2020-01-30 10:48:31',NULL,NULL,0,NULL)
,('AdherenceReportWeeklyFlow',NULL,'DRAFT','{"nodes":[{"nodeType":"user","templates":{"vxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<vxml version=\\"2.1\\">\\n\\n  ## Note: All over-rides below must be over-ridden in your flow, preferably your entry flow\\n\\n  ## Over-ride for a different timeout between user prompts\\n  #if (! $timeout) #set($timeout = 10) #end\\n\\n  ## Mandatorily over-ride this with the current caller''s locale based on how your application stores it\\n\\t#if (! $locale) #set($locale = \\"en\\") #end\\n\\n  ## over-ride this if you want to use a different skip character\\n  #if (! $skipChars) #set($skipChars = \\"*\\") #end\\n  \\n  #set($ext = \\".mp3\\")\\n\\n  ## Mandatorily over-ride this with the new flow name that you want to skip to if the skipChars is pressed\\n  #if ($internal.callDirection == \\"OUTGOING\\" && $skipFlow && $skipFlow != \\"\\")\\n\\t<link event=\\"SkipEvent\\">\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"skipRule\\" mode=\\"dtmf\\">\\n\\t\\t\\t<rule id=\\"skipRule\\" scope=\\"public\\">\\n\\t\\t\\t\\t<item>${skipChars}</item>\\n\\t\\t\\t</rule>\\n\\t\\t</grammar>\\n\\t</link>\\n\\n\\t<catch event=\\"SkipEvent\\">\\n\\t\\t<submit next=\\"${internal.nextURL}?jumpTo=${skipFlow}\\" />\\n\\t</catch>\\n  #end\\n\\n\\n<form>\\n\\t<var name=\\"gNoInputEventCount\\" expr=\\"0\\" />\\n\\t<var name=\\"gNoMatchEventCount\\" expr=\\"0\\" />\\n\\t<block>\\n\\t\\t<prompt bargein=\\"true\\" bargeintype=\\"hotword\\">#set($voiceFileName = \\"intro_pillreminder\\")\\n</prompt>\\n\\t\\t<prompt bargein=\\"false\\">\\n\\t\\t\\t<audio src=\\"http://cflinstalltest.cloudapp.net/audio/openmrs/$locale/$voiceFileName$ext\\" />\\n\\t\\t</prompt>\\n\\t</block>\\n\\t<field name=\\"finishedHearing\\"><property name=\\"timeout\\" value=\\"0.1s\\" />\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"finishedRule\\" mode=\\"dtmf\\"><rule id=\\"finishedRule\\" scope=\\"public\\"><item>@</item></rule></grammar>\\n\\t\\t<nomatch />\\n\\t\\t<noinput count=\\"1\\"><goto nextitem=\\"submit\\" /></noinput>\\n\\t</field>\\n\\t<block name=\\"submit\\">\\n\\t\\t<goto next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t</block>\\n</form>\\n</vxml>"},"ccxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<ccxml version=\\"1.0\\" xmlns:voxeo=\\"http://community.voxeo.com/xmlns/ccxml\\">\\n\\n\\t#set($d = \\"$\\")\\n  <var name=\\"callTimeout\\" expr=\\"''60s''\\" />\\n  <var name=\\"state\\" expr=\\"''init''\\"/>\\n\\n  <!-- OUTGOING, INCOMING -->\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"statusURL\\" expr=\\"''${internal.baseURL}/callflows/status/${internal.callId}''\\" />\\n  <var name=\\"connectionId\\" expr=\\"''outboundID''\\" />\\n  <var name=\\"callId\\" expr=\\"''${internal.callId}''\\" />\\n  <var name=\\"jumpTo\\" expr=\\"''${internal.jumpTo}''\\" />\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"callStatus\\" />\\n\\n  <log expr=\\"''startupmode = '' + session.startupmode\\"/>\\n \\n  <eventprocessor>\\n\\n    <!-- CCXML Loaded -->\\n    <transition event=\\"ccxml.loaded\\">\\n      <log expr=\\"''ccxml loaded''\\" />\\n      <if cond=\\"session.startupmode === ''external''\\">\\n        <!-- tel:xxxx, sip:xxx@h:p sip:user@127.0.0.1:5070  -->\\n        <createcall dest=\\"''tel:+'' + ''${phone}''\\" callerid=\\"''${phone}''\\" connectionid=\\"connectionId\\" timeout=\\"callTimeout\\"/>\\n      </if>\\n    </transition>\\n   \\n    <!-- Process the incoming call --> \\n    <transition event=\\"connection.alerting\\">\\n      <log expr=\\"''connection.alerting''\\" />\\n      <accept/>     \\n    </transition>\\n      \\n    <transition event=\\"connection.failed\\">\\n      <var name=\\"eventReason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>      \\n\\n    </transition>\\n\\n    <!-- Call has been answered.--> \\n    <transition event=\\"connection.connected\\">\\n      <log expr=\\"''connection.connected -> ${internal.callId}''\\" />\\n\\t\\t\\t\\t<dialogstart src=\\"''${internal.baseURL}/callflows/in/voxeo/flows/MainFlow.vxml''\\" namelist=\\"session.id application.callerId callId  #if($internal.callDirection == ''OUTGOING'') jumpTo #end\\" />\\n      <var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''connected''\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <var name=\\"externalId\\" expr=\\"session.id\\" />\\n      <var name=\\"externalType\\" expr=\\"''voxeoSessionId''\\" />\\n      <send data=\\"''callMaxTimeReached''\\" target=\\"session.id\\" delay=\\"''600s''\\" />\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason externalId externalType timestamp\\"/>      \\n    </transition>\\n    \\n    <transition event=\\"callMaxTimeReached\\">\\n      <if cond=\\"callStatus == ''IN_PROGRESS''\\">\\n        <log expr=\\"''-- Max Call Time Reached / Disconnecting Call --''\\" />\\n        <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n        <var name=\\"reason\\" expr=\\"''Max time reached''\\" />\\n        <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n        <log expr=\\"''status='' + status + ''; reason = '' + reason\\" />   \\n        <send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>  \\n        <disconnect/>  \\n      </if>\\n\\t\\t</transition>  \\n\\n    <!-- Caller hung up.  -->\\n    <transition event=\\"connection.disconnected\\">\\n      <log expr=\\"''connection.disconnected -> ${internal.callId}''\\" />\\n      <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''COMPLETED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.trigger\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n    </transition>\\n    \\n    <transition event=\\"dialog.started\\">\\n      <log expr=\\"''dialog.started -> ${internal.callId}''\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''dialog start''\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n\\n    </transition>\\n     \\n    <!-- Dialog exit -->\\n    <transition event=\\"dialog.exit\\">\\n      <log expr=\\"''dialog.exit -> ${internal.callId}''\\" />\\n      <disconnect />\\n    </transition>\\n\\n    <!-- ERROR!! -->\\n    <transition event=\\"error.*\\" >\\n      <log expr=\\"''Error[CFL]: ('' + event${d}.reason + '')''\\"/>\\n      <exit/>\\n    </transition>\\n\\n  </eventprocessor>\\n\\n</ccxml>"}},"blocks":[{"name":"Form","type":"form","elements":[{"name":"Txt","type":"txt","txt":"#set($voiceFileName = \\"intro_pillreminder\\")\\n`$voiceFileName`"}]}],"step":"entry","continueNode":true},{"nodeType":"system","templates":{"velocity":{"content":"#set($params.playedMessages = $voiceFileName)\\n#set($params.playedMessages = $voiceFileName)\\n#set($invalidCount = 0)\\n#set($noInputCount = 0)\\n|adherence-question|","dirty":false}},"step":"entry-handler"},{"nodeType":"user","templates":{"vxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<vxml version=\\"2.1\\">\\n\\n  ## Note: All over-rides below must be over-ridden in your flow, preferably your entry flow\\n\\n  ## Over-ride for a different timeout between user prompts\\n  #if (! $timeout) #set($timeout = 10) #end\\n\\n  ## Mandatorily over-ride this with the current caller''s locale based on how your application stores it\\n\\t#if (! $locale) #set($locale = \\"en\\") #end\\n\\n  ## over-ride this if you want to use a different skip character\\n  #if (! $skipChars) #set($skipChars = \\"*\\") #end\\n  \\n  #set($ext = \\".mp3\\")\\n\\n  ## Mandatorily over-ride this with the new flow name that you want to skip to if the skipChars is pressed\\n  #if ($internal.callDirection == \\"OUTGOING\\" && $skipFlow && $skipFlow != \\"\\")\\n\\t<link event=\\"SkipEvent\\">\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"skipRule\\" mode=\\"dtmf\\">\\n\\t\\t\\t<rule id=\\"skipRule\\" scope=\\"public\\">\\n\\t\\t\\t\\t<item>${skipChars}</item>\\n\\t\\t\\t</rule>\\n\\t\\t</grammar>\\n\\t</link>\\n\\n\\t<catch event=\\"SkipEvent\\">\\n\\t\\t<submit next=\\"${internal.nextURL}?jumpTo=${skipFlow}\\" />\\n\\t</catch>\\n  #end\\n\\n\\n<form>\\n\\t<var name=\\"gNoInputEventCount\\" expr=\\"0\\" />\\n\\t<var name=\\"gNoMatchEventCount\\" expr=\\"0\\" />\\n\\t<field name=\\"userInput\\" type=\\"digits\\">\\n\\t\\t<property name=\\"inputmodes\\" value=\\"dtmf\\" />\\n\\t\\t<prompt bargein=\\"true\\" timeout=\\"${timeout}s\\">in last one week How many days did you miss your medication\\nPress 1 for 0 day.\\nPress 2 for 1 days.\\nPress 3 for 2 or more days.</prompt>\\n\\t\\t<noinput count=\\"1\\">\\n\\t\\t<var name=\\"gNoInputEventCount\\" expr=\\"gNoInputEventCount+1\\" />\\n\\t\\t<submit namelist=\\"gNoInputEventCount gNoMatchEventCount\\" next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t\\t</noinput>\\n\\t\\t<nomatch count=\\"1\\">\\n\\t\\t<var name=\\"gNoMatchEventCount\\" expr=\\"gNoMatchEventCount+1\\" />\\n\\t\\t<submit namelist=\\"gNoInputEventCount gNoMatchEventCount\\" next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t\\t</nomatch>\\n\\t\\t<noinput><reprompt />\\n\\t\\t</noinput>\\n\\t\\t<nomatch><reprompt />\\n\\t\\t</nomatch>\\n\\t</field>\\n\\t<filled mode=\\"all\\">\\n\\t\\t<submit namelist=\\"userInput\\" next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t</filled>\\n</form>\\n</vxml>"},"ccxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<ccxml version=\\"1.0\\" xmlns:voxeo=\\"http://community.voxeo.com/xmlns/ccxml\\">\\n\\n\\t#set($d = \\"$\\")\\n  <var name=\\"callTimeout\\" expr=\\"''60s''\\" />\\n  <var name=\\"state\\" expr=\\"''init''\\"/>\\n\\n  <!-- OUTGOING, INCOMING -->\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"statusURL\\" expr=\\"''${internal.baseURL}/callflows/status/${internal.callId}''\\" />\\n  <var name=\\"connectionId\\" expr=\\"''outboundID''\\" />\\n  <var name=\\"callId\\" expr=\\"''${internal.callId}''\\" />\\n  <var name=\\"jumpTo\\" expr=\\"''${internal.jumpTo}''\\" />\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"callStatus\\" />\\n\\n  <log expr=\\"''startupmode = '' + session.startupmode\\"/>\\n \\n  <eventprocessor>\\n\\n    <!-- CCXML Loaded -->\\n    <transition event=\\"ccxml.loaded\\">\\n      <log expr=\\"''ccxml loaded''\\" />\\n      <if cond=\\"session.startupmode === ''external''\\">\\n        <!-- tel:xxxx, sip:xxx@h:p sip:user@127.0.0.1:5070  -->\\n        <createcall dest=\\"''tel:+'' + ''${phone}''\\" callerid=\\"''${phone}''\\" connectionid=\\"connectionId\\" timeout=\\"callTimeout\\"/>\\n      </if>\\n    </transition>\\n   \\n    <!-- Process the incoming call --> \\n    <transition event=\\"connection.alerting\\">\\n      <log expr=\\"''connection.alerting''\\" />\\n      <accept/>     \\n    </transition>\\n      \\n    <transition event=\\"connection.failed\\">\\n      <var name=\\"eventReason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>      \\n\\n    </transition>\\n\\n    <!-- Call has been answered.--> \\n    <transition event=\\"connection.connected\\">\\n      <log expr=\\"''connection.connected -> ${internal.callId}''\\" />\\n\\t\\t\\t\\t<dialogstart src=\\"''${internal.baseURL}/callflows/in/voxeo/flows/MainFlow.vxml''\\" namelist=\\"session.id application.callerId callId  #if($internal.callDirection == ''OUTGOING'') jumpTo #end\\" />\\n      <var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''connected''\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <var name=\\"externalId\\" expr=\\"session.id\\" />\\n      <var name=\\"externalType\\" expr=\\"''voxeoSessionId''\\" />\\n      <send data=\\"''callMaxTimeReached''\\" target=\\"session.id\\" delay=\\"''600s''\\" />\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason externalId externalType timestamp\\"/>      \\n    </transition>\\n    \\n    <transition event=\\"callMaxTimeReached\\">\\n      <if cond=\\"callStatus == ''IN_PROGRESS''\\">\\n        <log expr=\\"''-- Max Call Time Reached / Disconnecting Call --''\\" />\\n        <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n        <var name=\\"reason\\" expr=\\"''Max time reached''\\" />\\n        <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n        <log expr=\\"''status='' + status + ''; reason = '' + reason\\" />   \\n        <send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>  \\n        <disconnect/>  \\n      </if>\\n\\t\\t</transition>  \\n\\n    <!-- Caller hung up.  -->\\n    <transition event=\\"connection.disconnected\\">\\n      <log expr=\\"''connection.disconnected -> ${internal.callId}''\\" />\\n      <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''COMPLETED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.trigger\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n    </transition>\\n    \\n    <transition event=\\"dialog.started\\">\\n      <log expr=\\"''dialog.started -> ${internal.callId}''\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''dialog start''\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n\\n    </transition>\\n     \\n    <!-- Dialog exit -->\\n    <transition event=\\"dialog.exit\\">\\n      <log expr=\\"''dialog.exit -> ${internal.callId}''\\" />\\n      <disconnect />\\n    </transition>\\n\\n    <!-- ERROR!! -->\\n    <transition event=\\"error.*\\" >\\n      <log expr=\\"''Error[CFL]: ('' + event${d}.reason + '')''\\"/>\\n      <exit/>\\n    </transition>\\n\\n  </eventprocessor>\\n\\n</ccxml>"}},"blocks":[{"name":"Form","type":"form","elements":[{"name":"userInput","type":"field","txt":"in last one week How many days did you miss your medication\\nPress 1 for 0 day.\\nPress 2 for 1 days.\\nPress 3 for 2 or more days.","fieldType":"digits","noInput":"","noMatch":"","goodBye":"","bargeIn":true,"dtmf":true,"voice":false,"fieldMeta":"","reprompt":"1","dtmfGrammar":""}]}],"step":"adherence-question","continueNode":true},{"nodeType":"system","templates":{"velocity":{"content":"::::::::::::$params.gNoInputEventCount\\n::::::::::::$params.gNoMatchEventCount\\n#if($params.userInput)\\n\\t#set($userResponse = $params.userInput)\\n\\t#if ($params.userInput == 1)\\n    #set($response = 7)\\n    |user-response|\\n  #elseif($params.userInput == 2)\\n  \\t#set($response = 6)\\n    |user-response|\\n  #elseif($params.userInput == 3)\\n  \\t#set($response = 5)\\n  \\t|user-response|\\n  #else\\n    #set($returnNode = \\"AdherenceReportWeeklyFlow.adherence-question\\")\\n\\t\\t|OutgoingFlow.invalid-input|\\n  #end  \\n#else\\n\\t|MainFlow.no-input|\\n#end","dirty":false}},"step":"adherence-question-handler"},{"nodeType":"user","templates":{"vxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<vxml version=\\"2.1\\">\\n\\n  ## Note: All over-rides below must be over-ridden in your flow, preferably your entry flow\\n\\n  ## Over-ride for a different timeout between user prompts\\n  #if (! $timeout) #set($timeout = 10) #end\\n\\n  ## Mandatorily over-ride this with the current caller''s locale based on how your application stores it\\n\\t#if (! $locale) #set($locale = \\"en\\") #end\\n\\n  ## over-ride this if you want to use a different skip character\\n  #if (! $skipChars) #set($skipChars = \\"*\\") #end\\n  \\n  #set($ext = \\".mp3\\")\\n\\n  ## Mandatorily over-ride this with the new flow name that you want to skip to if the skipChars is pressed\\n  #if ($internal.callDirection == \\"OUTGOING\\" && $skipFlow && $skipFlow != \\"\\")\\n\\t<link event=\\"SkipEvent\\">\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"skipRule\\" mode=\\"dtmf\\">\\n\\t\\t\\t<rule id=\\"skipRule\\" scope=\\"public\\">\\n\\t\\t\\t\\t<item>${skipChars}</item>\\n\\t\\t\\t</rule>\\n\\t\\t</grammar>\\n\\t</link>\\n\\n\\t<catch event=\\"SkipEvent\\">\\n\\t\\t<submit next=\\"${internal.nextURL}?jumpTo=${skipFlow}\\" />\\n\\t</catch>\\n  #end\\n\\n\\n<form>\\n\\t<var name=\\"gNoInputEventCount\\" expr=\\"0\\" />\\n\\t<var name=\\"gNoMatchEventCount\\" expr=\\"0\\" />\\n\\t<block>\\n\\t\\t<prompt bargein=\\"true\\" bargeintype=\\"hotword\\">Thank you for your input.\\n</prompt>\\n\\t</block>\\n\\t<field name=\\"finishedHearing\\"><property name=\\"timeout\\" value=\\"0.1s\\" />\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"finishedRule\\" mode=\\"dtmf\\"><rule id=\\"finishedRule\\" scope=\\"public\\"><item>@</item></rule></grammar>\\n\\t\\t<nomatch />\\n\\t\\t<noinput count=\\"1\\"><goto nextitem=\\"submit\\" /></noinput>\\n\\t</field>\\n\\t<block name=\\"submit\\">\\n\\t\\t<goto next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t</block>\\n</form>\\n</vxml>"},"ccxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<ccxml version=\\"1.0\\" xmlns:voxeo=\\"http://community.voxeo.com/xmlns/ccxml\\">\\n\\n\\t#set($d = \\"$\\")\\n  <var name=\\"callTimeout\\" expr=\\"''60s''\\" />\\n  <var name=\\"state\\" expr=\\"''init''\\"/>\\n\\n  <!-- OUTGOING, INCOMING -->\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"statusURL\\" expr=\\"''${internal.baseURL}/callflows/status/${internal.callId}''\\" />\\n  <var name=\\"connectionId\\" expr=\\"''outboundID''\\" />\\n  <var name=\\"callId\\" expr=\\"''${internal.callId}''\\" />\\n  <var name=\\"jumpTo\\" expr=\\"''${internal.jumpTo}''\\" />\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"callStatus\\" />\\n\\n  <log expr=\\"''startupmode = '' + session.startupmode\\"/>\\n \\n  <eventprocessor>\\n\\n    <!-- CCXML Loaded -->\\n    <transition event=\\"ccxml.loaded\\">\\n      <log expr=\\"''ccxml loaded''\\" />\\n      <if cond=\\"session.startupmode === ''external''\\">\\n        <!-- tel:xxxx, sip:xxx@h:p sip:user@127.0.0.1:5070  -->\\n        <createcall dest=\\"''tel:+'' + ''${phone}''\\" callerid=\\"''${phone}''\\" connectionid=\\"connectionId\\" timeout=\\"callTimeout\\"/>\\n      </if>\\n    </transition>\\n   \\n    <!-- Process the incoming call --> \\n    <transition event=\\"connection.alerting\\">\\n      <log expr=\\"''connection.alerting''\\" />\\n      <accept/>     \\n    </transition>\\n      \\n    <transition event=\\"connection.failed\\">\\n      <var name=\\"eventReason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>      \\n\\n    </transition>\\n\\n    <!-- Call has been answered.--> \\n    <transition event=\\"connection.connected\\">\\n      <log expr=\\"''connection.connected -> ${internal.callId}''\\" />\\n\\t\\t\\t\\t<dialogstart src=\\"''${internal.baseURL}/callflows/in/voxeo/flows/MainFlow.vxml''\\" namelist=\\"session.id application.callerId callId  #if($internal.callDirection == ''OUTGOING'') jumpTo #end\\" />\\n      <var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''connected''\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <var name=\\"externalId\\" expr=\\"session.id\\" />\\n      <var name=\\"externalType\\" expr=\\"''voxeoSessionId''\\" />\\n      <send data=\\"''callMaxTimeReached''\\" target=\\"session.id\\" delay=\\"''600s''\\" />\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason externalId externalType timestamp\\"/>      \\n    </transition>\\n    \\n    <transition event=\\"callMaxTimeReached\\">\\n      <if cond=\\"callStatus == ''IN_PROGRESS''\\">\\n        <log expr=\\"''-- Max Call Time Reached / Disconnecting Call --''\\" />\\n        <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n        <var name=\\"reason\\" expr=\\"''Max time reached''\\" />\\n        <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n        <log expr=\\"''status='' + status + ''; reason = '' + reason\\" />   \\n        <send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>  \\n        <disconnect/>  \\n      </if>\\n\\t\\t</transition>  \\n\\n    <!-- Caller hung up.  -->\\n    <transition event=\\"connection.disconnected\\">\\n      <log expr=\\"''connection.disconnected -> ${internal.callId}''\\" />\\n      <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''COMPLETED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.trigger\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n    </transition>\\n    \\n    <transition event=\\"dialog.started\\">\\n      <log expr=\\"''dialog.started -> ${internal.callId}''\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''dialog start''\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n\\n    </transition>\\n     \\n    <!-- Dialog exit -->\\n    <transition event=\\"dialog.exit\\">\\n      <log expr=\\"''dialog.exit -> ${internal.callId}''\\" />\\n      <disconnect />\\n    </transition>\\n\\n    <!-- ERROR!! -->\\n    <transition event=\\"error.*\\" >\\n      <log expr=\\"''Error[CFL]: ('' + event${d}.reason + '')''\\"/>\\n      <exit/>\\n    </transition>\\n\\n  </eventprocessor>\\n\\n</ccxml>"}},"blocks":[{"name":"Form","type":"form","elements":[{"name":"Txt","type":"txt","txt":"Thank you for your input.\\n"}]}],"step":"user-response","continueNode":true},{"nodeType":"system","templates":{"velocity":{"content":"message::::::::::: $messages.get(0).messageId\\ncalId::::::::::::::: $callId\\nresponseId:::::::::: $responseId\\n#set($messageId = $messages.get(0).messageId)\\n$messagesService.registerResponseAndStatus($messageId, 165280, '''', $responseId, $userResponse.toString(), ''DELIVERED'', $DateUtil.now(), $callId)\\n$messages.remove(0)\\n|OutgoingFlow.entry-handler|","dirty":false}},"step":"user-response-handler"}],"name":"AdherenceReportWeeklyFlow"}','d3015519-5b88-46e8-9a28-d1eb54ffc204',1,1,'2020-02-25 13:18:26','2020-01-30 10:50:12',NULL,NULL,0,NULL)
,('SymptomReportingFlow',NULL,'DRAFT','{"nodes":[{"nodeType":"user","templates":{"vxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<vxml version=\\"2.1\\">\\n\\n  ## Note: All over-rides below must be over-ridden in your flow, preferably your entry flow\\n\\n  ## Over-ride for a different timeout between user prompts\\n  #if (! $timeout) #set($timeout = 10) #end\\n\\n  ## Mandatorily over-ride this with the current caller''s locale based on how your application stores it\\n\\t#if (! $locale) #set($locale = \\"en\\") #end\\n\\n  ## over-ride this if you want to use a different skip character\\n  #if (! $skipChars) #set($skipChars = \\"*\\") #end\\n  \\n  #set($ext = \\".mp3\\")\\n\\n  ## Mandatorily over-ride this with the new flow name that you want to skip to if the skipChars is pressed\\n  #if ($internal.callDirection == \\"OUTGOING\\" && $skipFlow && $skipFlow != \\"\\")\\n\\t<link event=\\"SkipEvent\\">\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"skipRule\\" mode=\\"dtmf\\">\\n\\t\\t\\t<rule id=\\"skipRule\\" scope=\\"public\\">\\n\\t\\t\\t\\t<item>${skipChars}</item>\\n\\t\\t\\t</rule>\\n\\t\\t</grammar>\\n\\t</link>\\n\\n\\t<catch event=\\"SkipEvent\\">\\n\\t\\t<submit next=\\"${internal.nextURL}?jumpTo=${skipFlow}\\" />\\n\\t</catch>\\n  #end\\n\\n\\n<form>\\n\\t<var name=\\"gNoInputEventCount\\" expr=\\"0\\" />\\n\\t<var name=\\"gNoMatchEventCount\\" expr=\\"0\\" />\\n\\t<block>\\n\\t\\t<prompt bargein=\\"true\\" bargeintype=\\"hotword\\">Please report your symptom</prompt>\\n\\t</block>\\n\\t<field name=\\"finishedHearing\\"><property name=\\"timeout\\" value=\\"0.1s\\" />\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"finishedRule\\" mode=\\"dtmf\\"><rule id=\\"finishedRule\\" scope=\\"public\\"><item>@</item></rule></grammar>\\n\\t\\t<nomatch />\\n\\t\\t<noinput count=\\"1\\"><goto nextitem=\\"submit\\" /></noinput>\\n\\t</field>\\n\\t<block name=\\"submit\\">\\n\\t\\t<goto next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t</block>\\n</form>\\n</vxml>"},"ccxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<ccxml version=\\"1.0\\" xmlns:voxeo=\\"http://community.voxeo.com/xmlns/ccxml\\">\\n\\n\\t#set($d = \\"$\\")\\n  <var name=\\"callTimeout\\" expr=\\"''60s''\\" />\\n  <var name=\\"state\\" expr=\\"''init''\\"/>\\n\\n  <!-- OUTGOING, INCOMING -->\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"statusURL\\" expr=\\"''${internal.baseURL}/callflows/status/${internal.callId}''\\" />\\n  <var name=\\"connectionId\\" expr=\\"''outboundID''\\" />\\n  <var name=\\"callId\\" expr=\\"''${internal.callId}''\\" />\\n  <var name=\\"jumpTo\\" expr=\\"''${internal.jumpTo}''\\" />\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"callStatus\\" />\\n\\n  <log expr=\\"''startupmode = '' + session.startupmode\\"/>\\n \\n  <eventprocessor>\\n\\n    <!-- CCXML Loaded -->\\n    <transition event=\\"ccxml.loaded\\">\\n      <log expr=\\"''ccxml loaded''\\" />\\n      <if cond=\\"session.startupmode === ''external''\\">\\n        <!-- tel:xxxx, sip:xxx@h:p sip:user@127.0.0.1:5070  -->\\n        <createcall dest=\\"''tel:+'' + ''${phone}''\\" callerid=\\"''${phone}''\\" connectionid=\\"connectionId\\" timeout=\\"callTimeout\\"/>\\n      </if>\\n    </transition>\\n   \\n    <!-- Process the incoming call --> \\n    <transition event=\\"connection.alerting\\">\\n      <log expr=\\"''connection.alerting''\\" />\\n      <accept/>     \\n    </transition>\\n      \\n    <transition event=\\"connection.failed\\">\\n      <var name=\\"eventReason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>      \\n\\n    </transition>\\n\\n    <!-- Call has been answered.--> \\n    <transition event=\\"connection.connected\\">\\n      <log expr=\\"''connection.connected -> ${internal.callId}''\\" />\\n\\t\\t\\t\\t<dialogstart src=\\"''${internal.baseURL}/callflows/in/voxeo/flows/MainFlow.vxml''\\" namelist=\\"session.id application.callerId callId  #if($internal.callDirection == ''OUTGOING'') jumpTo #end\\" />\\n      <var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''connected''\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <var name=\\"externalId\\" expr=\\"session.id\\" />\\n      <var name=\\"externalType\\" expr=\\"''voxeoSessionId''\\" />\\n      <send data=\\"''callMaxTimeReached''\\" target=\\"session.id\\" delay=\\"''600s''\\" />\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason externalId externalType timestamp\\"/>      \\n    </transition>\\n    \\n    <transition event=\\"callMaxTimeReached\\">\\n      <if cond=\\"callStatus == ''IN_PROGRESS''\\">\\n        <log expr=\\"''-- Max Call Time Reached / Disconnecting Call --''\\" />\\n        <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n        <var name=\\"reason\\" expr=\\"''Max time reached''\\" />\\n        <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n        <log expr=\\"''status='' + status + ''; reason = '' + reason\\" />   \\n        <send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>  \\n        <disconnect/>  \\n      </if>\\n\\t\\t</transition>  \\n\\n    <!-- Caller hung up.  -->\\n    <transition event=\\"connection.disconnected\\">\\n      <log expr=\\"''connection.disconnected -> ${internal.callId}''\\" />\\n      <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''COMPLETED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.trigger\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n    </transition>\\n    \\n    <transition event=\\"dialog.started\\">\\n      <log expr=\\"''dialog.started -> ${internal.callId}''\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''dialog start''\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n\\n    </transition>\\n     \\n    <!-- Dialog exit -->\\n    <transition event=\\"dialog.exit\\">\\n      <log expr=\\"''dialog.exit -> ${internal.callId}''\\" />\\n      <disconnect />\\n    </transition>\\n\\n    <!-- ERROR!! -->\\n    <transition event=\\"error.*\\" >\\n      <log expr=\\"''Error[CFL]: ('' + event${d}.reason + '')''\\"/>\\n      <exit/>\\n    </transition>\\n\\n  </eventprocessor>\\n\\n</ccxml>"},"New renderer":{"dirty":false,"content":"{Success}"}},"blocks":[{"name":"Form","type":"form","elements":[{"name":"Txt","type":"txt","txt":"Please report your symptom"}]}],"step":"entry","continueNode":true},{"nodeType":"system","templates":{"velocity":{"content":"#set($symptomList = [165273, 165268, 165275, 165274])\\n#set($noInputCount = 0)\\n#set($invalidCount = 0)\\n>>>>>>>>$actorId\\n    >>>>>>>>$sourceId\\n    >>>>>>>>$sourceType\\n    >>>>>>>>>$symptomList.get(0)\\n|ask-symptom|","dirty":false}},"step":"entry-handler"},{"nodeType":"user","templates":{"vxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<vxml version=\\"2.1\\">\\n\\n  ## Note: All over-rides below must be over-ridden in your flow, preferably your entry flow\\n\\n  ## Over-ride for a different timeout between user prompts\\n  #if (! $timeout) #set($timeout = 10) #end\\n\\n  ## Mandatorily over-ride this with the current caller''s locale based on how your application stores it\\n\\t#if (! $locale) #set($locale = \\"en\\") #end\\n\\n  ## over-ride this if you want to use a different skip character\\n  #if (! $skipChars) #set($skipChars = \\"*\\") #end\\n  \\n  #set($ext = \\".mp3\\")\\n\\n  ## Mandatorily over-ride this with the new flow name that you want to skip to if the skipChars is pressed\\n  #if ($internal.callDirection == \\"OUTGOING\\" && $skipFlow && $skipFlow != \\"\\")\\n\\t<link event=\\"SkipEvent\\">\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"skipRule\\" mode=\\"dtmf\\">\\n\\t\\t\\t<rule id=\\"skipRule\\" scope=\\"public\\">\\n\\t\\t\\t\\t<item>${skipChars}</item>\\n\\t\\t\\t</rule>\\n\\t\\t</grammar>\\n\\t</link>\\n\\n\\t<catch event=\\"SkipEvent\\">\\n\\t\\t<submit next=\\"${internal.nextURL}?jumpTo=${skipFlow}\\" />\\n\\t</catch>\\n  #end\\n\\n\\n<form>\\n\\t<var name=\\"gNoInputEventCount\\" expr=\\"0\\" />\\n\\t<var name=\\"gNoMatchEventCount\\" expr=\\"0\\" />\\n\\t<field name=\\"userInput\\" type=\\"digits?length=1\\">\\n\\t\\t<property name=\\"inputmodes\\" value=\\"dtmf\\" />\\n\\t\\t<prompt bargein=\\"true\\" timeout=\\"${timeout}s\\">#set($symptom = $conceptDAO.getConcept($symptomList.get(0)).getDescription().getDescription())\\n\\n$symptom\\nPress 1 for Yes, Press 3 for No</prompt>\\n\\t\\t<noinput count=\\"1\\">\\n\\t\\t<var name=\\"gNoInputEventCount\\" expr=\\"gNoInputEventCount+1\\" />\\n\\t\\t<submit namelist=\\"gNoInputEventCount gNoMatchEventCount\\" next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t\\t</noinput>\\n\\t\\t<nomatch count=\\"1\\">\\n\\t\\t<var name=\\"gNoMatchEventCount\\" expr=\\"gNoMatchEventCount+1\\" />\\n\\t\\t<submit namelist=\\"gNoInputEventCount gNoMatchEventCount\\" next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t\\t</nomatch>\\n\\t\\t<noinput><reprompt />\\n\\t\\t</noinput>\\n\\t\\t<nomatch><reprompt />\\n\\t\\t</nomatch>\\n\\t</field>\\n\\t<filled mode=\\"all\\">\\n\\t\\t<submit namelist=\\"userInput\\" next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t</filled>\\n</form>\\n</vxml>"},"ccxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<ccxml version=\\"1.0\\" xmlns:voxeo=\\"http://community.voxeo.com/xmlns/ccxml\\">\\n\\n\\t#set($d = \\"$\\")\\n  <var name=\\"callTimeout\\" expr=\\"''60s''\\" />\\n  <var name=\\"state\\" expr=\\"''init''\\"/>\\n\\n  <!-- OUTGOING, INCOMING -->\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"statusURL\\" expr=\\"''${internal.baseURL}/callflows/status/${internal.callId}''\\" />\\n  <var name=\\"connectionId\\" expr=\\"''outboundID''\\" />\\n  <var name=\\"callId\\" expr=\\"''${internal.callId}''\\" />\\n  <var name=\\"jumpTo\\" expr=\\"''${internal.jumpTo}''\\" />\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"callStatus\\" />\\n\\n  <log expr=\\"''startupmode = '' + session.startupmode\\"/>\\n \\n  <eventprocessor>\\n\\n    <!-- CCXML Loaded -->\\n    <transition event=\\"ccxml.loaded\\">\\n      <log expr=\\"''ccxml loaded''\\" />\\n      <if cond=\\"session.startupmode === ''external''\\">\\n        <!-- tel:xxxx, sip:xxx@h:p sip:user@127.0.0.1:5070  -->\\n        <createcall dest=\\"''tel:+'' + ''${phone}''\\" callerid=\\"''${phone}''\\" connectionid=\\"connectionId\\" timeout=\\"callTimeout\\"/>\\n      </if>\\n    </transition>\\n   \\n    <!-- Process the incoming call --> \\n    <transition event=\\"connection.alerting\\">\\n      <log expr=\\"''connection.alerting''\\" />\\n      <accept/>     \\n    </transition>\\n      \\n    <transition event=\\"connection.failed\\">\\n      <var name=\\"eventReason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>      \\n\\n    </transition>\\n\\n    <!-- Call has been answered.--> \\n    <transition event=\\"connection.connected\\">\\n      <log expr=\\"''connection.connected -> ${internal.callId}''\\" />\\n\\t\\t\\t\\t<dialogstart src=\\"''${internal.baseURL}/callflows/in/voxeo/flows/MainFlow.vxml''\\" namelist=\\"session.id application.callerId callId  #if($internal.callDirection == ''OUTGOING'') jumpTo #end\\" />\\n      <var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''connected''\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <var name=\\"externalId\\" expr=\\"session.id\\" />\\n      <var name=\\"externalType\\" expr=\\"''voxeoSessionId''\\" />\\n      <send data=\\"''callMaxTimeReached''\\" target=\\"session.id\\" delay=\\"''600s''\\" />\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason externalId externalType timestamp\\"/>      \\n    </transition>\\n    \\n    <transition event=\\"callMaxTimeReached\\">\\n      <if cond=\\"callStatus == ''IN_PROGRESS''\\">\\n        <log expr=\\"''-- Max Call Time Reached / Disconnecting Call --''\\" />\\n        <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n        <var name=\\"reason\\" expr=\\"''Max time reached''\\" />\\n        <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n        <log expr=\\"''status='' + status + ''; reason = '' + reason\\" />   \\n        <send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>  \\n        <disconnect/>  \\n      </if>\\n\\t\\t</transition>  \\n\\n    <!-- Caller hung up.  -->\\n    <transition event=\\"connection.disconnected\\">\\n      <log expr=\\"''connection.disconnected -> ${internal.callId}''\\" />\\n      <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''COMPLETED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.trigger\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n    </transition>\\n    \\n    <transition event=\\"dialog.started\\">\\n      <log expr=\\"''dialog.started -> ${internal.callId}''\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''dialog start''\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n\\n    </transition>\\n     \\n    <!-- Dialog exit -->\\n    <transition event=\\"dialog.exit\\">\\n      <log expr=\\"''dialog.exit -> ${internal.callId}''\\" />\\n      <disconnect />\\n    </transition>\\n\\n    <!-- ERROR!! -->\\n    <transition event=\\"error.*\\" >\\n      <log expr=\\"''Error[CFL]: ('' + event${d}.reason + '')''\\"/>\\n      <exit/>\\n    </transition>\\n\\n  </eventprocessor>\\n\\n</ccxml>"},"New renderer":{"dirty":false,"content":"{Success}"}},"blocks":[{"name":"Form","type":"form","elements":[{"name":"userInput","type":"field","txt":"#set($symptom = $conceptDAO.getConcept($symptomList.get(0)).getDescription().getDescription())\\n\\n$symptom\\nPress 1 for Yes, Press 3 for No","fieldType":"digits","noInput":"","noMatch":"","goodBye":"","bargeIn":true,"dtmf":true,"voice":false,"fieldMeta":"1","reprompt":"1"}]}],"step":"ask-symptom"},{"nodeType":"system","templates":{"velocity":{"content":"#if($params.userInput)\\n\\t#if($params.userInput == 1 || $params.userInput == 3)\\n  \\t#if($params.userInput == 1)\\n    >>>>>>>>$actorId\\n    >>>>>>>>$sourceId\\n    >>>>>>>>$sourceType\\n    >>>>>>>>>$symptomList.get(0)\\n    \\t$messagesService.registerResponse($actorId, $actorId,  $sourceId, $sourceType, $symptomList.get(0), '''', 165269, '''', $DateUtil.now())\\n    #else\\n    \\t$messagesService.registerResponse($actorId, $actorId,  $sourceId, $sourceType, $symptomList.get(0), '''', 165318, '''', $DateUtil.now())\\n    #end\\n    #set($success = $symptomList.remove(0))\\n    #set($noInputCount = 0)\\n\\t\\t#set($invalidCount = 0)\\n\\t\\t#if($symptomList.size() > 0)\\n\\t\\t\\t|ask-symptom|\\n\\t\\t#else\\n\\t\\t\\t|play-advice|\\n\\t\\t#end\\n  #else\\n  \\t#set($returnNode = \\"SymptomReportingFlow.ask-symptom\\")\\n    |MainFlow.invalid-input|\\n  #end  \\n#else\\n\\t#set($returnNode = \\"SymptomReportingFlow.ask-symptom\\")\\n  |MainFlow.no-input|\\n#end","dirty":false}},"step":"ask-symptom-handler"},{"nodeType":"user","templates":{"vxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<vxml version=\\"2.1\\">\\n\\n  ## Note: All over-rides below must be over-ridden in your flow, preferably your entry flow\\n\\n  ## Over-ride for a different timeout between user prompts\\n  #if (! $timeout) #set($timeout = 10) #end\\n\\n  ## Mandatorily over-ride this with the current caller''s locale based on how your application stores it\\n\\t#if (! $locale) #set($locale = \\"en\\") #end\\n\\n  ## over-ride this if you want to use a different skip character\\n  #if (! $skipChars) #set($skipChars = \\"*\\") #end\\n  \\n  #set($ext = \\".mp3\\")\\n\\n  ## Mandatorily over-ride this with the new flow name that you want to skip to if the skipChars is pressed\\n  #if ($internal.callDirection == \\"OUTGOING\\" && $skipFlow && $skipFlow != \\"\\")\\n\\t<link event=\\"SkipEvent\\">\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"skipRule\\" mode=\\"dtmf\\">\\n\\t\\t\\t<rule id=\\"skipRule\\" scope=\\"public\\">\\n\\t\\t\\t\\t<item>${skipChars}</item>\\n\\t\\t\\t</rule>\\n\\t\\t</grammar>\\n\\t</link>\\n\\n\\t<catch event=\\"SkipEvent\\">\\n\\t\\t<submit next=\\"${internal.nextURL}?jumpTo=${skipFlow}\\" />\\n\\t</catch>\\n  #end\\n\\n\\n<form>\\n\\t<var name=\\"gNoInputEventCount\\" expr=\\"0\\" />\\n\\t<var name=\\"gNoMatchEventCount\\" expr=\\"0\\" />\\n\\t<block>\\n\\t\\t<prompt bargein=\\"true\\" bargeintype=\\"hotword\\">Go to clinic and contact your doctor</prompt>\\n\\t</block>\\n\\t<field name=\\"finishedHearing\\"><property name=\\"timeout\\" value=\\"0.1s\\" />\\n\\t\\t<grammar xml:lang=\\"en-us\\" version=\\"1.0\\" root=\\"finishedRule\\" mode=\\"dtmf\\"><rule id=\\"finishedRule\\" scope=\\"public\\"><item>@</item></rule></grammar>\\n\\t\\t<nomatch />\\n\\t\\t<noinput count=\\"1\\"><goto nextitem=\\"submit\\" /></noinput>\\n\\t</field>\\n\\t<block name=\\"submit\\">\\n\\t\\t<goto next=\\"${internal.nextURL}?_dt=$DateUtil.now().getTime()\\" />\\n\\t</block>\\n</form>\\n</vxml>"},"ccxml":{"dirty":false,"content":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<ccxml version=\\"1.0\\" xmlns:voxeo=\\"http://community.voxeo.com/xmlns/ccxml\\">\\n\\n\\t#set($d = \\"$\\")\\n  <var name=\\"callTimeout\\" expr=\\"''60s''\\" />\\n  <var name=\\"state\\" expr=\\"''init''\\"/>\\n\\n  <!-- OUTGOING, INCOMING -->\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"statusURL\\" expr=\\"''${internal.baseURL}/callflows/status/${internal.callId}''\\" />\\n  <var name=\\"connectionId\\" expr=\\"''outboundID''\\" />\\n  <var name=\\"callId\\" expr=\\"''${internal.callId}''\\" />\\n  <var name=\\"jumpTo\\" expr=\\"''${internal.jumpTo}''\\" />\\n  <var name=\\"direction\\" expr=\\"''${internal.callDirection}''\\" />\\n  <var name=\\"callStatus\\" />\\n\\n  <log expr=\\"''startupmode = '' + session.startupmode\\"/>\\n \\n  <eventprocessor>\\n\\n    <!-- CCXML Loaded -->\\n    <transition event=\\"ccxml.loaded\\">\\n      <log expr=\\"''ccxml loaded''\\" />\\n      <if cond=\\"session.startupmode === ''external''\\">\\n        <!-- tel:xxxx, sip:xxx@h:p sip:user@127.0.0.1:5070  -->\\n        <createcall dest=\\"''tel:+'' + ''${phone}''\\" callerid=\\"''${phone}''\\" connectionid=\\"connectionId\\" timeout=\\"callTimeout\\"/>\\n      </if>\\n    </transition>\\n   \\n    <!-- Process the incoming call --> \\n    <transition event=\\"connection.alerting\\">\\n      <log expr=\\"''connection.alerting''\\" />\\n      <accept/>     \\n    </transition>\\n      \\n    <transition event=\\"connection.failed\\">\\n      <var name=\\"eventReason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"eventReason === ''timeout'' ? ''NO_ANSWER'' : eventReason === ''busy'' ? ''BUSY'' : ''FAILED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.reason\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>      \\n\\n    </transition>\\n\\n    <!-- Call has been answered.--> \\n    <transition event=\\"connection.connected\\">\\n      <log expr=\\"''connection.connected -> ${internal.callId}''\\" />\\n\\t\\t\\t\\t<dialogstart src=\\"''${internal.baseURL}/callflows/in/voxeo/flows/MainFlow.vxml''\\" namelist=\\"session.id application.callerId callId  #if($internal.callDirection == ''OUTGOING'') jumpTo #end\\" />\\n      <var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''connected''\\" />\\n\\t\\t\\t<var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <var name=\\"externalId\\" expr=\\"session.id\\" />\\n      <var name=\\"externalType\\" expr=\\"''voxeoSessionId''\\" />\\n      <send data=\\"''callMaxTimeReached''\\" target=\\"session.id\\" delay=\\"''600s''\\" />\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason externalId externalType timestamp\\"/>      \\n    </transition>\\n    \\n    <transition event=\\"callMaxTimeReached\\">\\n      <if cond=\\"callStatus == ''IN_PROGRESS''\\">\\n        <log expr=\\"''-- Max Call Time Reached / Disconnecting Call --''\\" />\\n        <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n        <var name=\\"reason\\" expr=\\"''Max time reached''\\" />\\n        <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n        <log expr=\\"''status='' + status + ''; reason = '' + reason\\" />   \\n        <send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>  \\n        <disconnect/>  \\n      </if>\\n\\t\\t</transition>  \\n\\n    <!-- Caller hung up.  -->\\n    <transition event=\\"connection.disconnected\\">\\n      <log expr=\\"''connection.disconnected -> ${internal.callId}''\\" />\\n      <var name=\\"status\\" expr=\\"''COMPLETED''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''COMPLETED''\\" />\\n      <var name=\\"reason\\" expr=\\"event${d}.trigger\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n    </transition>\\n    \\n    <transition event=\\"dialog.started\\">\\n      <log expr=\\"''dialog.started -> ${internal.callId}''\\" />\\n\\t\\t\\t<var name=\\"status\\" expr=\\"''IN_PROGRESS''\\" />\\n      <assign name=\\"callStatus\\" expr=\\"''IN_PROGRESS''\\" />\\n      <var name=\\"reason\\" expr=\\"''dialog start''\\" />\\n      <var name=\\"timestamp\\" expr=\\"(+new Date)\\"/>\\n      <log expr=\\"''status='' + status + ''; reason = '' + reason\\" /> \\n\\t\\t\\t<send target=\\"statusURL + ''''\\" targettype=\\"''basichttp''\\" name=\\"''http.get''\\" namelist=\\"status reason timestamp\\"/>\\n\\n    </transition>\\n     \\n    <!-- Dialog exit -->\\n    <transition event=\\"dialog.exit\\">\\n      <log expr=\\"''dialog.exit -> ${internal.callId}''\\" />\\n      <disconnect />\\n    </transition>\\n\\n    <!-- ERROR!! -->\\n    <transition event=\\"error.*\\" >\\n      <log expr=\\"''Error[CFL]: ('' + event${d}.reason + '')''\\"/>\\n      <exit/>\\n    </transition>\\n\\n  </eventprocessor>\\n\\n</ccxml>"},"New renderer":{"dirty":false,"content":"{Success}"}},"blocks":[{"name":"Form","type":"form","elements":[{"name":"Txt","type":"txt","txt":"Go to clinic and contact your doctor"}]}],"step":"play-advice","continueNode":true},{"nodeType":"system","templates":{"velocity":{"content":"|MainFlow.goodbye|","dirty":false}},"step":"play-advice-handler"}],"name":"SymptomReportingFlow"}','3304b760-949c-493e-aa3c-7d9e6da30597',1,1,'2020-02-24 14:37:20','2020-01-30 11:20:01',NULL,NULL,0,NULL)
;